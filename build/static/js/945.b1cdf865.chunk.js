/*! For license information please see 945.b1cdf865.chunk.js.LICENSE.txt */
(self.webpackChunkinteriit_scores_app_ibp=self.webpackChunkinteriit_scores_app_ibp||[]).push([[945],{2797:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var i=r(n(5649)),o=n(184),s=(0,i.default)((0,o.jsx)("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"}),"Assignment");t.Z=s},7939:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var i=r(n(5649)),o=n(184),s=(0,i.default)([(0,o.jsx)("path",{d:"m10.1 15.9 1.42-1.42C8.79 12.05 7 10.41 7 8.85 7 7.8 7.8 7 8.85 7c1.11 0 1.54.65 2.68 2h.93c1.12-1.31 1.53-2 2.68-2 .87 0 1.55.54 1.77 1.32.35-.04.68-.06 1-.06.36 0 .7.03 1.03.08C18.7 6.43 17.13 5 15.15 5c-.12 0-.23.03-.35.04.12-.33.2-.67.2-1.04 0-1.66-1.34-3-3-3S9 2.34 9 4c0 .37.08.71.2 1.04-.12-.01-.23-.04-.35-.04C6.69 5 5 6.69 5 8.85c0 2.42 2.04 4.31 5.1 7.05z"},"0"),(0,o.jsx)("path",{d:"M22.5 16.24c-.32-.18-.66-.29-1-.35.07-.1.15-.18.21-.28 1.08-1.87.46-4.18-1.41-5.26-2.09-1.21-4.76-.39-8.65.9l.52 1.94c3.47-1.14 5.79-1.88 7.14-1.1.91.53 1.2 1.61.68 2.53-.56.96-1.33 1-3.07 1.32l-.47.81c.58 1.62.97 2.33.39 3.32-.53.91-1.61 1.2-2.53.68-.06-.03-.11-.09-.17-.13-.3.67-.64 1.24-1.03 1.73.07.04.13.09.2.14 1.87 1.08 4.18.46 5.26-1.41.06-.1.09-.21.14-.32.22.27.48.51.8.69 1.43.83 3.27.34 4.1-1.1s.32-3.29-1.11-4.11z"},"1"),(0,o.jsx)("path",{d:"M12.32 14.01c-.74 3.58-1.27 5.95-2.62 6.73-.91.53-2 .24-2.53-.68-.56-.96-.2-1.66.39-3.32l-.46-.81c-1.7-.31-2.5-.33-3.07-1.32-.53-.91-.24-2 .68-2.53.09-.05.19-.08.29-.11-.35-.56-.64-1.17-.82-1.85-.16.07-.32.14-.48.23-1.87 1.08-2.49 3.39-1.41 5.26.06.1.14.18.21.28-.34.06-.68.17-1 .35-1.43.83-1.93 2.66-1.1 4.1s2.66 1.93 4.1 1.1c.32-.18.58-.42.8-.69.05.11.08.22.14.32 1.08 1.87 3.39 2.49 5.26 1.41 2.09-1.21 2.71-3.93 3.55-7.94l-1.93-.53z"},"2")],"Diversity2");t.Z=s},9527:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var i=r(n(5649)),o=n(184),s=(0,i.default)([(0,o.jsx)("path",{fillRule:"evenodd",d:"M16.67 13.13C18.04 14.06 19 15.32 19 17v3h4v-3c0-2.18-3.57-3.47-6.33-3.87z"},"0"),(0,o.jsx)("circle",{cx:"9",cy:"8",r:"4",fillRule:"evenodd"},"1"),(0,o.jsx)("path",{fillRule:"evenodd",d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4c-.47 0-.91.1-1.33.24C14.5 5.27 15 6.58 15 8s-.5 2.73-1.33 3.76c.42.14.86.24 1.33.24zm-6 1c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4z"},"2")],"PeopleAlt");t.Z=s},9451:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var i=r(n(5649)),o=n(184),s=(0,i.default)((0,o.jsx)("path",{d:"M17.5 13.5H16v-3h1.5v3zM20 4h-3V2h-2v2H9V2H7v2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zM9.5 11.5c0 .55-.45 1-1 1h-2v1h3V15H5v-2.5c0-.55.45-1 1-1h2v-1H5V9h3.5c.55 0 1 .45 1 1v1.5zm3.25 6.5h-1.5v-1.5h1.5V18zm0-3.5h-1.5V13h1.5v1.5zm0-3.5h-1.5V9.5h1.5V11zm0-3.5h-1.5V6h1.5v1.5zM19 14c0 .55-.45 1-1 1h-2.5c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1H18c.55 0 1 .45 1 1v4z"}),"Scoreboard");t.Z=s},9841:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var i=r(n(5649)),o=n(184),s=(0,i.default)((0,o.jsx)("path",{d:"M10 10.02h5V21h-5zM17 21h3c1.1 0 2-.9 2-2v-9h-5v11zm3-18H5c-1.1 0-2 .9-2 2v3h19V5c0-1.1-.9-2-2-2zM3 19c0 1.1.9 2 2 2h3V10H3v9z"}),"TableChart");t.Z=s},8703:function(e){e.exports=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,n){return t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(e,n)}function n(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function r(e,i,o){return r=n()?Reflect.construct:function(e,n,r){var i=[null];i.push.apply(i,n);var o=new(Function.bind.apply(e,i));return r&&t(o,r.prototype),o},r.apply(null,arguments)}function i(e){return o(e)||s(e)||a(e)||u()}function o(e){if(Array.isArray(e))return l(e)}function s(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function a(e,t){if(e){if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c=Object.hasOwnProperty,h=Object.setPrototypeOf,d=Object.isFrozen,f=Object.getPrototypeOf,g=Object.getOwnPropertyDescriptor,m=Object.freeze,v=Object.seal,p=Object.create,y="undefined"!==typeof Reflect&&Reflect,w=y.apply,C=y.construct;w||(w=function(e,t,n){return e.apply(t,n)}),m||(m=function(e){return e}),v||(v=function(e){return e}),C||(C=function(e,t){return r(e,i(t))});var b=I(Array.prototype.forEach),S=I(Array.prototype.pop),T=I(Array.prototype.push),E=I(String.prototype.toLowerCase),R=I(String.prototype.toString),k=I(String.prototype.match),_=I(String.prototype.replace),O=I(String.prototype.indexOf),M=I(String.prototype.trim),x=I(RegExp.prototype.test),N=D(TypeError);function I(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return w(e,t,r)}}function D(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return C(e,n)}}function H(e,t,n){var r;n=null!==(r=n)&&void 0!==r?r:E,h&&h(e,null);for(var i=t.length;i--;){var o=t[i];if("string"===typeof o){var s=n(o);s!==o&&(d(t)||(t[i]=s),o=s)}e[o]=!0}return e}function A(e){var t,n=p(null);for(t in e)!0===w(c,e,[t])&&(n[t]=e[t]);return n}function L(e,t){for(;null!==e;){var n=g(e,t);if(n){if(n.get)return I(n.get);if("function"===typeof n.value)return I(n.value)}e=f(e)}function r(e){return console.warn("fallback value for",e),null}return r}var P=m(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),V=m(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),W=m(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),F=m(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),B=m(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Z=m(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),j=m(["#text"]),U=m(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Y=m(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),z=m(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),G=m(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),X=v(/\{\{[\w\W]*|[\w\W]*\}\}/gm),K=v(/<%[\w\W]*|[\w\W]*%>/gm),q=v(/\${[\w\W]*}/gm),$=v(/^data-[\-\w.\u00B7-\uFFFF]/),Q=v(/^aria-[\-\w]+$/),J=v(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ee=v(/^(?:\w+script|data):/i),te=v(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ne=v(/^html$/i),re=function(){return"undefined"===typeof window?null:window},ie=function(t,n){if("object"!==e(t)||"function"!==typeof t.createPolicy)return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return t.createPolicy(o,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(s){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function oe(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re(),n=function(e){return oe(e)};if(n.version="2.4.7",n.removed=[],!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n;var r=t.document,o=t.document,s=t.DocumentFragment,a=t.HTMLTemplateElement,l=t.Node,u=t.Element,c=t.NodeFilter,h=t.NamedNodeMap,d=void 0===h?t.NamedNodeMap||t.MozNamedAttrMap:h,f=t.HTMLFormElement,g=t.DOMParser,v=t.trustedTypes,p=u.prototype,y=L(p,"cloneNode"),w=L(p,"nextSibling"),C=L(p,"childNodes"),I=L(p,"parentNode");if("function"===typeof a){var D=o.createElement("template");D.content&&D.content.ownerDocument&&(o=D.content.ownerDocument)}var se=ie(v,r),ae=se?se.createHTML(""):"",le=o,ue=le.implementation,ce=le.createNodeIterator,he=le.createDocumentFragment,de=le.getElementsByTagName,fe=r.importNode,ge={};try{ge=A(o).documentMode?o.documentMode:{}}catch(Dt){}var me={};n.isSupported="function"===typeof I&&ue&&void 0!==ue.createHTMLDocument&&9!==ge;var ve,pe,ye=X,we=K,Ce=q,be=$,Se=Q,Te=ee,Ee=te,Re=J,ke=null,_e=H({},[].concat(i(P),i(V),i(W),i(B),i(j))),Oe=null,Me=H({},[].concat(i(U),i(Y),i(z),i(G))),xe=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ne=null,Ie=null,De=!0,He=!0,Ae=!1,Le=!0,Pe=!1,Ve=!1,We=!1,Fe=!1,Be=!1,Ze=!1,je=!1,Ue=!0,Ye=!1,ze="user-content-",Ge=!0,Xe=!1,Ke={},qe=null,$e=H({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Qe=null,Je=H({},["audio","video","img","source","image","track"]),et=null,tt=H({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),nt="http://www.w3.org/1998/Math/MathML",rt="http://www.w3.org/2000/svg",it="http://www.w3.org/1999/xhtml",ot=it,st=!1,at=null,lt=H({},[nt,rt,it],R),ut=["application/xhtml+xml","text/html"],ct="text/html",ht=null,dt=o.createElement("form"),ft=function(e){return e instanceof RegExp||e instanceof Function},gt=function(t){ht&&ht===t||(t&&"object"===e(t)||(t={}),t=A(t),ve=ve=-1===ut.indexOf(t.PARSER_MEDIA_TYPE)?ct:t.PARSER_MEDIA_TYPE,pe="application/xhtml+xml"===ve?R:E,ke="ALLOWED_TAGS"in t?H({},t.ALLOWED_TAGS,pe):_e,Oe="ALLOWED_ATTR"in t?H({},t.ALLOWED_ATTR,pe):Me,at="ALLOWED_NAMESPACES"in t?H({},t.ALLOWED_NAMESPACES,R):lt,et="ADD_URI_SAFE_ATTR"in t?H(A(tt),t.ADD_URI_SAFE_ATTR,pe):tt,Qe="ADD_DATA_URI_TAGS"in t?H(A(Je),t.ADD_DATA_URI_TAGS,pe):Je,qe="FORBID_CONTENTS"in t?H({},t.FORBID_CONTENTS,pe):$e,Ne="FORBID_TAGS"in t?H({},t.FORBID_TAGS,pe):{},Ie="FORBID_ATTR"in t?H({},t.FORBID_ATTR,pe):{},Ke="USE_PROFILES"in t&&t.USE_PROFILES,De=!1!==t.ALLOW_ARIA_ATTR,He=!1!==t.ALLOW_DATA_ATTR,Ae=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Le=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,Pe=t.SAFE_FOR_TEMPLATES||!1,Ve=t.WHOLE_DOCUMENT||!1,Be=t.RETURN_DOM||!1,Ze=t.RETURN_DOM_FRAGMENT||!1,je=t.RETURN_TRUSTED_TYPE||!1,Fe=t.FORCE_BODY||!1,Ue=!1!==t.SANITIZE_DOM,Ye=t.SANITIZE_NAMED_PROPS||!1,Ge=!1!==t.KEEP_CONTENT,Xe=t.IN_PLACE||!1,Re=t.ALLOWED_URI_REGEXP||Re,ot=t.NAMESPACE||it,xe=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&ft(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(xe.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&ft(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(xe.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"===typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(xe.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Pe&&(He=!1),Ze&&(Be=!0),Ke&&(ke=H({},i(j)),Oe=[],!0===Ke.html&&(H(ke,P),H(Oe,U)),!0===Ke.svg&&(H(ke,V),H(Oe,Y),H(Oe,G)),!0===Ke.svgFilters&&(H(ke,W),H(Oe,Y),H(Oe,G)),!0===Ke.mathMl&&(H(ke,B),H(Oe,z),H(Oe,G))),t.ADD_TAGS&&(ke===_e&&(ke=A(ke)),H(ke,t.ADD_TAGS,pe)),t.ADD_ATTR&&(Oe===Me&&(Oe=A(Oe)),H(Oe,t.ADD_ATTR,pe)),t.ADD_URI_SAFE_ATTR&&H(et,t.ADD_URI_SAFE_ATTR,pe),t.FORBID_CONTENTS&&(qe===$e&&(qe=A(qe)),H(qe,t.FORBID_CONTENTS,pe)),Ge&&(ke["#text"]=!0),Ve&&H(ke,["html","head","body"]),ke.table&&(H(ke,["tbody"]),delete Ne.tbody),m&&m(t),ht=t)},mt=H({},["mi","mo","mn","ms","mtext"]),vt=H({},["foreignobject","desc","title","annotation-xml"]),pt=H({},["title","style","font","a","script"]),yt=H({},V);H(yt,W),H(yt,F);var wt=H({},B);H(wt,Z);var Ct=function(e){var t=I(e);t&&t.tagName||(t={namespaceURI:ot,tagName:"template"});var n=E(e.tagName),r=E(t.tagName);return!!at[e.namespaceURI]&&(e.namespaceURI===rt?t.namespaceURI===it?"svg"===n:t.namespaceURI===nt?"svg"===n&&("annotation-xml"===r||mt[r]):Boolean(yt[n]):e.namespaceURI===nt?t.namespaceURI===it?"math"===n:t.namespaceURI===rt?"math"===n&&vt[r]:Boolean(wt[n]):e.namespaceURI===it?!(t.namespaceURI===rt&&!vt[r])&&!(t.namespaceURI===nt&&!mt[r])&&!wt[n]&&(pt[n]||!yt[n]):!("application/xhtml+xml"!==ve||!at[e.namespaceURI]))},bt=function(e){T(n.removed,{element:e});try{e.parentNode.removeChild(e)}catch(Dt){try{e.outerHTML=ae}catch(Dt){e.remove()}}},St=function(e,t){try{T(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(Dt){T(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Oe[e])if(Be||Ze)try{bt(t)}catch(Dt){}else try{t.setAttribute(e,"")}catch(Dt){}},Tt=function(e){var t,n;if(Fe)e="<remove></remove>"+e;else{var r=k(e,/^[\r\n\t ]+/);n=r&&r[0]}"application/xhtml+xml"===ve&&ot===it&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var i=se?se.createHTML(e):e;if(ot===it)try{t=(new g).parseFromString(i,ve)}catch(Dt){}if(!t||!t.documentElement){t=ue.createDocument(ot,"template",null);try{t.documentElement.innerHTML=st?ae:i}catch(Dt){}}var s=t.body||t.documentElement;return e&&n&&s.insertBefore(o.createTextNode(n),s.childNodes[0]||null),ot===it?de.call(t,Ve?"html":"body")[0]:Ve?t.documentElement:s},Et=function(e){return ce.call(e.ownerDocument||e,e,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},Rt=function(e){return e instanceof f&&("string"!==typeof e.nodeName||"string"!==typeof e.textContent||"function"!==typeof e.removeChild||!(e.attributes instanceof d)||"function"!==typeof e.removeAttribute||"function"!==typeof e.setAttribute||"string"!==typeof e.namespaceURI||"function"!==typeof e.insertBefore||"function"!==typeof e.hasChildNodes)},kt=function(t){return"object"===e(l)?t instanceof l:t&&"object"===e(t)&&"number"===typeof t.nodeType&&"string"===typeof t.nodeName},_t=function(e,t,r){me[e]&&b(me[e],(function(e){e.call(n,t,r,ht)}))},Ot=function(e){var t;if(_t("beforeSanitizeElements",e,null),Rt(e))return bt(e),!0;if(x(/[\u0080-\uFFFF]/,e.nodeName))return bt(e),!0;var r=pe(e.nodeName);if(_t("uponSanitizeElement",e,{tagName:r,allowedTags:ke}),e.hasChildNodes()&&!kt(e.firstElementChild)&&(!kt(e.content)||!kt(e.content.firstElementChild))&&x(/<[/\w]/g,e.innerHTML)&&x(/<[/\w]/g,e.textContent))return bt(e),!0;if("select"===r&&x(/<template/i,e.innerHTML))return bt(e),!0;if(!ke[r]||Ne[r]){if(!Ne[r]&&xt(r)){if(xe.tagNameCheck instanceof RegExp&&x(xe.tagNameCheck,r))return!1;if(xe.tagNameCheck instanceof Function&&xe.tagNameCheck(r))return!1}if(Ge&&!qe[r]){var i=I(e)||e.parentNode,o=C(e)||e.childNodes;if(o&&i)for(var s=o.length-1;s>=0;--s)i.insertBefore(y(o[s],!0),w(e))}return bt(e),!0}return e instanceof u&&!Ct(e)?(bt(e),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!x(/<\/no(script|embed|frames)/i,e.innerHTML)?(Pe&&3===e.nodeType&&(t=e.textContent,t=_(t,ye," "),t=_(t,we," "),t=_(t,Ce," "),e.textContent!==t&&(T(n.removed,{element:e.cloneNode()}),e.textContent=t)),_t("afterSanitizeElements",e,null),!1):(bt(e),!0)},Mt=function(e,t,n){if(Ue&&("id"===t||"name"===t)&&(n in o||n in dt))return!1;if(He&&!Ie[t]&&x(be,t));else if(De&&x(Se,t));else if(!Oe[t]||Ie[t]){if(!(xt(e)&&(xe.tagNameCheck instanceof RegExp&&x(xe.tagNameCheck,e)||xe.tagNameCheck instanceof Function&&xe.tagNameCheck(e))&&(xe.attributeNameCheck instanceof RegExp&&x(xe.attributeNameCheck,t)||xe.attributeNameCheck instanceof Function&&xe.attributeNameCheck(t))||"is"===t&&xe.allowCustomizedBuiltInElements&&(xe.tagNameCheck instanceof RegExp&&x(xe.tagNameCheck,n)||xe.tagNameCheck instanceof Function&&xe.tagNameCheck(n))))return!1}else if(et[t]);else if(x(Re,_(n,Ee,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==O(n,"data:")||!Qe[e])if(Ae&&!x(Te,_(n,Ee,"")));else if(n)return!1;return!0},xt=function(e){return e.indexOf("-")>0},Nt=function(t){var r,i,o,s;_t("beforeSanitizeAttributes",t,null);var a=t.attributes;if(a){var l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Oe};for(s=a.length;s--;){var u=r=a[s],c=u.name,h=u.namespaceURI;if(i="value"===c?r.value:M(r.value),o=pe(c),l.attrName=o,l.attrValue=i,l.keepAttr=!0,l.forceKeepAttr=void 0,_t("uponSanitizeAttribute",t,l),i=l.attrValue,!l.forceKeepAttr&&(St(c,t),l.keepAttr))if(Le||!x(/\/>/i,i)){Pe&&(i=_(i,ye," "),i=_(i,we," "),i=_(i,Ce," "));var d=pe(t.nodeName);if(Mt(d,o,i)){if(!Ye||"id"!==o&&"name"!==o||(St(c,t),i=ze+i),se&&"object"===e(v)&&"function"===typeof v.getAttributeType)if(h);else switch(v.getAttributeType(d,o)){case"TrustedHTML":i=se.createHTML(i);break;case"TrustedScriptURL":i=se.createScriptURL(i)}try{h?t.setAttributeNS(h,c,i):t.setAttribute(c,i),S(n.removed)}catch(Dt){}}}else St(c,t)}_t("afterSanitizeAttributes",t,null)}},It=function e(t){var n,r=Et(t);for(_t("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)_t("uponSanitizeShadowNode",n,null),Ot(n)||(n.content instanceof s&&e(n.content),Nt(n));_t("afterSanitizeShadowDOM",t,null)};return n.sanitize=function(i){var o,a,u,c,h,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((st=!i)&&(i="\x3c!--\x3e"),"string"!==typeof i&&!kt(i)){if("function"!==typeof i.toString)throw N("toString is not a function");if("string"!==typeof(i=i.toString()))throw N("dirty is not a string, aborting")}if(!n.isSupported){if("object"===e(t.toStaticHTML)||"function"===typeof t.toStaticHTML){if("string"===typeof i)return t.toStaticHTML(i);if(kt(i))return t.toStaticHTML(i.outerHTML)}return i}if(We||gt(d),n.removed=[],"string"===typeof i&&(Xe=!1),Xe){if(i.nodeName){var f=pe(i.nodeName);if(!ke[f]||Ne[f])throw N("root node is forbidden and cannot be sanitized in-place")}}else if(i instanceof l)1===(a=(o=Tt("\x3c!----\x3e")).ownerDocument.importNode(i,!0)).nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?o=a:o.appendChild(a);else{if(!Be&&!Pe&&!Ve&&-1===i.indexOf("<"))return se&&je?se.createHTML(i):i;if(!(o=Tt(i)))return Be?null:je?ae:""}o&&Fe&&bt(o.firstChild);for(var g=Et(Xe?i:o);u=g.nextNode();)3===u.nodeType&&u===c||Ot(u)||(u.content instanceof s&&It(u.content),Nt(u),c=u);if(c=null,Xe)return i;if(Be){if(Ze)for(h=he.call(o.ownerDocument);o.firstChild;)h.appendChild(o.firstChild);else h=o;return(Oe.shadowroot||Oe.shadowrootmod)&&(h=fe.call(r,h,!0)),h}var m=Ve?o.outerHTML:o.innerHTML;return Ve&&ke["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&x(ne,o.ownerDocument.doctype.name)&&(m="<!DOCTYPE "+o.ownerDocument.doctype.name+">\n"+m),Pe&&(m=_(m,ye," "),m=_(m,we," "),m=_(m,Ce," ")),se&&je?se.createHTML(m):m},n.setConfig=function(e){gt(e),We=!0},n.clearConfig=function(){ht=null,We=!1},n.isValidAttribute=function(e,t,n){ht||gt({});var r=pe(e),i=pe(t);return Mt(r,i,n)},n.addHook=function(e,t){"function"===typeof t&&(me[e]=me[e]||[],T(me[e],t))},n.removeHook=function(e){if(me[e])return S(me[e])},n.removeHooks=function(e){me[e]&&(me[e]=[])},n.removeAllHooks=function(){me={}},n}return oe()}()},2426:function(e,t,n){(e=n.nmd(e)).exports=function(){"use strict";var t,n;function r(){return t.apply(null,arguments)}function i(e){t=e}function o(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function s(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function l(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(a(e,t))return!1;return!0}function u(e){return void 0===e}function c(e){return"number"===typeof e||"[object Number]"===Object.prototype.toString.call(e)}function h(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function d(e,t){var n,r=[],i=e.length;for(n=0;n<i;++n)r.push(t(e[n],n));return r}function f(e,t){for(var n in t)a(t,n)&&(e[n]=t[n]);return a(t,"toString")&&(e.toString=t.toString),a(t,"valueOf")&&(e.valueOf=t.valueOf),e}function g(e,t,n,r){return Xn(e,t,n,r,!0).utc()}function m(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function v(e){return null==e._pf&&(e._pf=m()),e._pf}function p(e){if(null==e._isValid){var t=v(e),r=n.call(t.parsedDateParts,(function(e){return null!=e})),i=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(i=i&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return i;e._isValid=i}return e._isValid}function y(e){var t=g(NaN);return null!=e?f(v(t),e):v(t).userInvalidated=!0,t}n=Array.prototype.some?Array.prototype.some:function(e){var t,n=Object(this),r=n.length>>>0;for(t=0;t<r;t++)if(t in n&&e.call(this,n[t],t,n))return!0;return!1};var w=r.momentProperties=[],C=!1;function b(e,t){var n,r,i,o=w.length;if(u(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),u(t._i)||(e._i=t._i),u(t._f)||(e._f=t._f),u(t._l)||(e._l=t._l),u(t._strict)||(e._strict=t._strict),u(t._tzm)||(e._tzm=t._tzm),u(t._isUTC)||(e._isUTC=t._isUTC),u(t._offset)||(e._offset=t._offset),u(t._pf)||(e._pf=v(t)),u(t._locale)||(e._locale=t._locale),o>0)for(n=0;n<o;n++)u(i=t[r=w[n]])||(e[r]=i);return e}function S(e){b(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===C&&(C=!0,r.updateOffset(this),C=!1)}function T(e){return e instanceof S||null!=e&&null!=e._isAMomentObject}function E(e){!1===r.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function R(e,t){var n=!0;return f((function(){if(null!=r.deprecationHandler&&r.deprecationHandler(null,e),n){var i,o,s,l=[],u=arguments.length;for(o=0;o<u;o++){if(i="","object"===typeof arguments[o]){for(s in i+="\n["+o+"] ",arguments[0])a(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];l.push(i)}E(e+"\nArguments: "+Array.prototype.slice.call(l).join("")+"\n"+(new Error).stack),n=!1}return t.apply(this,arguments)}),t)}var k,_={};function O(e,t){null!=r.deprecationHandler&&r.deprecationHandler(e,t),_[e]||(E(t),_[e]=!0)}function M(e){return"undefined"!==typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function x(e){var t,n;for(n in e)a(e,n)&&(M(t=e[n])?this[n]=t:this["_"+n]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function N(e,t){var n,r=f({},e);for(n in t)a(t,n)&&(s(e[n])&&s(t[n])?(r[n]={},f(r[n],e[n]),f(r[n],t[n])):null!=t[n]?r[n]=t[n]:delete r[n]);for(n in e)a(e,n)&&!a(t,n)&&s(e[n])&&(r[n]=f({},r[n]));return r}function I(e){null!=e&&this.set(e)}r.suppressDeprecationWarnings=!1,r.deprecationHandler=null,k=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)a(e,t)&&n.push(t);return n};var D={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function H(e,t,n){var r=this._calendar[e]||this._calendar.sameElse;return M(r)?r.call(t,n):r}function A(e,t,n){var r=""+Math.abs(e),i=t-r.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var L=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,P=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,V={},W={};function F(e,t,n,r){var i=r;"string"===typeof r&&(i=function(){return this[r]()}),e&&(W[e]=i),t&&(W[t[0]]=function(){return A(i.apply(this,arguments),t[1],t[2])}),n&&(W[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function B(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function Z(e){var t,n,r=e.match(L);for(t=0,n=r.length;t<n;t++)W[r[t]]?r[t]=W[r[t]]:r[t]=B(r[t]);return function(t){var i,o="";for(i=0;i<n;i++)o+=M(r[i])?r[i].call(t,e):r[i];return o}}function j(e,t){return e.isValid()?(t=U(t,e.localeData()),V[t]=V[t]||Z(t),V[t](e)):e.localeData().invalidDate()}function U(e,t){var n=5;function r(e){return t.longDateFormat(e)||e}for(P.lastIndex=0;n>=0&&P.test(e);)e=e.replace(P,r),P.lastIndex=0,n-=1;return e}var Y={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function z(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.match(L).map((function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e})).join(""),this._longDateFormat[e])}var G="Invalid date";function X(){return this._invalidDate}var K="%d",q=/\d{1,2}/;function $(e){return this._ordinal.replace("%d",e)}var Q={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function J(e,t,n,r){var i=this._relativeTime[n];return M(i)?i(e,t,n,r):i.replace(/%d/i,e)}function ee(e,t){var n=this._relativeTime[e>0?"future":"past"];return M(n)?n(t):n.replace(/%s/i,t)}var te={};function ne(e,t){var n=e.toLowerCase();te[n]=te[n+"s"]=te[t]=e}function re(e){return"string"===typeof e?te[e]||te[e.toLowerCase()]:void 0}function ie(e){var t,n,r={};for(n in e)a(e,n)&&(t=re(n))&&(r[t]=e[n]);return r}var oe={};function se(e,t){oe[e]=t}function ae(e){var t,n=[];for(t in e)a(e,t)&&n.push({unit:t,priority:oe[t]});return n.sort((function(e,t){return e.priority-t.priority})),n}function le(e){return e%4===0&&e%100!==0||e%400===0}function ue(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function ce(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=ue(t)),n}function he(e,t){return function(n){return null!=n?(fe(this,e,n),r.updateOffset(this,t),this):de(this,e)}}function de(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function fe(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&le(e.year())&&1===e.month()&&29===e.date()?(n=ce(n),e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),Je(n,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function ge(e){return M(this[e=re(e)])?this[e]():this}function me(e,t){if("object"===typeof e){var n,r=ae(e=ie(e)),i=r.length;for(n=0;n<i;n++)this[r[n].unit](e[r[n].unit])}else if(M(this[e=re(e)]))return this[e](t);return this}var ve,pe=/\d/,ye=/\d\d/,we=/\d{3}/,Ce=/\d{4}/,be=/[+-]?\d{6}/,Se=/\d\d?/,Te=/\d\d\d\d?/,Ee=/\d\d\d\d\d\d?/,Re=/\d{1,3}/,ke=/\d{1,4}/,_e=/[+-]?\d{1,6}/,Oe=/\d+/,Me=/[+-]?\d+/,xe=/Z|[+-]\d\d:?\d\d/gi,Ne=/Z|[+-]\d\d(?::?\d\d)?/gi,Ie=/[+-]?\d+(\.\d{1,3})?/,De=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function He(e,t,n){ve[e]=M(t)?t:function(e,r){return e&&n?n:t}}function Ae(e,t){return a(ve,e)?ve[e](t._strict,t._locale):new RegExp(Le(e))}function Le(e){return Pe(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,n,r,i){return t||n||r||i})))}function Pe(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}ve={};var Ve={};function We(e,t){var n,r,i=t;for("string"===typeof e&&(e=[e]),c(t)&&(i=function(e,n){n[t]=ce(e)}),r=e.length,n=0;n<r;n++)Ve[e[n]]=i}function Fe(e,t){We(e,(function(e,n,r,i){r._w=r._w||{},t(e,r._w,r,i)}))}function Be(e,t,n){null!=t&&a(Ve,e)&&Ve[e](t,n._a,n,e)}var Ze,je=0,Ue=1,Ye=2,ze=3,Ge=4,Xe=5,Ke=6,qe=7,$e=8;function Qe(e,t){return(e%t+t)%t}function Je(e,t){if(isNaN(e)||isNaN(t))return NaN;var n=Qe(t,12);return e+=(t-n)/12,1===n?le(e)?29:28:31-n%7%2}Ze=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},F("M",["MM",2],"Mo",(function(){return this.month()+1})),F("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),F("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),ne("month","M"),se("month",8),He("M",Se),He("MM",Se,ye),He("MMM",(function(e,t){return t.monthsShortRegex(e)})),He("MMMM",(function(e,t){return t.monthsRegex(e)})),We(["M","MM"],(function(e,t){t[Ue]=ce(e)-1})),We(["MMM","MMMM"],(function(e,t,n,r){var i=n._locale.monthsParse(e,r,n._strict);null!=i?t[Ue]=i:v(n).invalidMonth=e}));var et="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),tt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),nt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,rt=De,it=De;function ot(e,t){return e?o(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||nt).test(t)?"format":"standalone"][e.month()]:o(this._months)?this._months:this._months.standalone}function st(e,t){return e?o(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[nt.test(t)?"format":"standalone"][e.month()]:o(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function at(e,t,n){var r,i,o,s=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=g([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(i=Ze.call(this._shortMonthsParse,s))?i:null:-1!==(i=Ze.call(this._longMonthsParse,s))?i:null:"MMM"===t?-1!==(i=Ze.call(this._shortMonthsParse,s))||-1!==(i=Ze.call(this._longMonthsParse,s))?i:null:-1!==(i=Ze.call(this._longMonthsParse,s))||-1!==(i=Ze.call(this._shortMonthsParse,s))?i:null}function lt(e,t,n){var r,i,o;if(this._monthsParseExact)return at.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=g([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}}function ut(e,t){var n;if(!e.isValid())return e;if("string"===typeof t)if(/^\d+$/.test(t))t=ce(t);else if(!c(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),Je(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function ct(e){return null!=e?(ut(this,e),r.updateOffset(this,!0),this):de(this,"Month")}function ht(){return Je(this.year(),this.month())}function dt(e){return this._monthsParseExact?(a(this,"_monthsRegex")||gt.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(a(this,"_monthsShortRegex")||(this._monthsShortRegex=rt),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function ft(e){return this._monthsParseExact?(a(this,"_monthsRegex")||gt.call(this),e?this._monthsStrictRegex:this._monthsRegex):(a(this,"_monthsRegex")||(this._monthsRegex=it),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function gt(){function e(e,t){return t.length-e.length}var t,n,r=[],i=[],o=[];for(t=0;t<12;t++)n=g([2e3,t]),r.push(this.monthsShort(n,"")),i.push(this.months(n,"")),o.push(this.months(n,"")),o.push(this.monthsShort(n,""));for(r.sort(e),i.sort(e),o.sort(e),t=0;t<12;t++)r[t]=Pe(r[t]),i[t]=Pe(i[t]);for(t=0;t<24;t++)o[t]=Pe(o[t]);this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function mt(e){return le(e)?366:365}F("Y",0,0,(function(){var e=this.year();return e<=9999?A(e,4):"+"+e})),F(0,["YY",2],0,(function(){return this.year()%100})),F(0,["YYYY",4],0,"year"),F(0,["YYYYY",5],0,"year"),F(0,["YYYYYY",6,!0],0,"year"),ne("year","y"),se("year",1),He("Y",Me),He("YY",Se,ye),He("YYYY",ke,Ce),He("YYYYY",_e,be),He("YYYYYY",_e,be),We(["YYYYY","YYYYYY"],je),We("YYYY",(function(e,t){t[je]=2===e.length?r.parseTwoDigitYear(e):ce(e)})),We("YY",(function(e,t){t[je]=r.parseTwoDigitYear(e)})),We("Y",(function(e,t){t[je]=parseInt(e,10)})),r.parseTwoDigitYear=function(e){return ce(e)+(ce(e)>68?1900:2e3)};var vt=he("FullYear",!0);function pt(){return le(this.year())}function yt(e,t,n,r,i,o,s){var a;return e<100&&e>=0?(a=new Date(e+400,t,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(e)):a=new Date(e,t,n,r,i,o,s),a}function wt(e){var t,n;return e<100&&e>=0?((n=Array.prototype.slice.call(arguments))[0]=e+400,t=new Date(Date.UTC.apply(null,n)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Ct(e,t,n){var r=7+t-n;return-(7+wt(e,0,r).getUTCDay()-t)%7+r-1}function bt(e,t,n,r,i){var o,s,a=1+7*(t-1)+(7+n-r)%7+Ct(e,r,i);return a<=0?s=mt(o=e-1)+a:a>mt(e)?(o=e+1,s=a-mt(e)):(o=e,s=a),{year:o,dayOfYear:s}}function St(e,t,n){var r,i,o=Ct(e.year(),t,n),s=Math.floor((e.dayOfYear()-o-1)/7)+1;return s<1?r=s+Tt(i=e.year()-1,t,n):s>Tt(e.year(),t,n)?(r=s-Tt(e.year(),t,n),i=e.year()+1):(i=e.year(),r=s),{week:r,year:i}}function Tt(e,t,n){var r=Ct(e,t,n),i=Ct(e+1,t,n);return(mt(e)-r+i)/7}function Et(e){return St(e,this._week.dow,this._week.doy).week}F("w",["ww",2],"wo","week"),F("W",["WW",2],"Wo","isoWeek"),ne("week","w"),ne("isoWeek","W"),se("week",5),se("isoWeek",5),He("w",Se),He("ww",Se,ye),He("W",Se),He("WW",Se,ye),Fe(["w","ww","W","WW"],(function(e,t,n,r){t[r.substr(0,1)]=ce(e)}));var Rt={dow:0,doy:6};function kt(){return this._week.dow}function _t(){return this._week.doy}function Ot(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Mt(e){var t=St(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function xt(e,t){return"string"!==typeof e?e:isNaN(e)?"number"===typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}function Nt(e,t){return"string"===typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function It(e,t){return e.slice(t,7).concat(e.slice(0,t))}F("d",0,"do","day"),F("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),F("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),F("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),F("e",0,0,"weekday"),F("E",0,0,"isoWeekday"),ne("day","d"),ne("weekday","e"),ne("isoWeekday","E"),se("day",11),se("weekday",11),se("isoWeekday",11),He("d",Se),He("e",Se),He("E",Se),He("dd",(function(e,t){return t.weekdaysMinRegex(e)})),He("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),He("dddd",(function(e,t){return t.weekdaysRegex(e)})),Fe(["dd","ddd","dddd"],(function(e,t,n,r){var i=n._locale.weekdaysParse(e,r,n._strict);null!=i?t.d=i:v(n).invalidWeekday=e})),Fe(["d","e","E"],(function(e,t,n,r){t[r]=ce(e)}));var Dt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ht="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),At="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Lt=De,Pt=De,Vt=De;function Wt(e,t){var n=o(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?It(n,this._week.dow):e?n[e.day()]:n}function Ft(e){return!0===e?It(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Bt(e){return!0===e?It(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Zt(e,t,n){var r,i,o,s=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=g([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(i=Ze.call(this._weekdaysParse,s))?i:null:"ddd"===t?-1!==(i=Ze.call(this._shortWeekdaysParse,s))?i:null:-1!==(i=Ze.call(this._minWeekdaysParse,s))?i:null:"dddd"===t?-1!==(i=Ze.call(this._weekdaysParse,s))||-1!==(i=Ze.call(this._shortWeekdaysParse,s))||-1!==(i=Ze.call(this._minWeekdaysParse,s))?i:null:"ddd"===t?-1!==(i=Ze.call(this._shortWeekdaysParse,s))||-1!==(i=Ze.call(this._weekdaysParse,s))||-1!==(i=Ze.call(this._minWeekdaysParse,s))?i:null:-1!==(i=Ze.call(this._minWeekdaysParse,s))||-1!==(i=Ze.call(this._weekdaysParse,s))||-1!==(i=Ze.call(this._shortWeekdaysParse,s))?i:null}function jt(e,t,n){var r,i,o;if(this._weekdaysParseExact)return Zt.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=g([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(n&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(n&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!n&&this._weekdaysParse[r].test(e))return r}}function Ut(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=xt(e,this.localeData()),this.add(e-t,"d")):t}function Yt(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function zt(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=Nt(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function Gt(e){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||qt.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(a(this,"_weekdaysRegex")||(this._weekdaysRegex=Lt),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Xt(e){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||qt.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(a(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Pt),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Kt(e){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||qt.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(a(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Vt),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function qt(){function e(e,t){return t.length-e.length}var t,n,r,i,o,s=[],a=[],l=[],u=[];for(t=0;t<7;t++)n=g([2e3,1]).day(t),r=Pe(this.weekdaysMin(n,"")),i=Pe(this.weekdaysShort(n,"")),o=Pe(this.weekdays(n,"")),s.push(r),a.push(i),l.push(o),u.push(r),u.push(i),u.push(o);s.sort(e),a.sort(e),l.sort(e),u.sort(e),this._weekdaysRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function $t(){return this.hours()%12||12}function Qt(){return this.hours()||24}function Jt(e,t){F(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function en(e,t){return t._meridiemParse}function tn(e){return"p"===(e+"").toLowerCase().charAt(0)}F("H",["HH",2],0,"hour"),F("h",["hh",2],0,$t),F("k",["kk",2],0,Qt),F("hmm",0,0,(function(){return""+$t.apply(this)+A(this.minutes(),2)})),F("hmmss",0,0,(function(){return""+$t.apply(this)+A(this.minutes(),2)+A(this.seconds(),2)})),F("Hmm",0,0,(function(){return""+this.hours()+A(this.minutes(),2)})),F("Hmmss",0,0,(function(){return""+this.hours()+A(this.minutes(),2)+A(this.seconds(),2)})),Jt("a",!0),Jt("A",!1),ne("hour","h"),se("hour",13),He("a",en),He("A",en),He("H",Se),He("h",Se),He("k",Se),He("HH",Se,ye),He("hh",Se,ye),He("kk",Se,ye),He("hmm",Te),He("hmmss",Ee),He("Hmm",Te),He("Hmmss",Ee),We(["H","HH"],ze),We(["k","kk"],(function(e,t,n){var r=ce(e);t[ze]=24===r?0:r})),We(["a","A"],(function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e})),We(["h","hh"],(function(e,t,n){t[ze]=ce(e),v(n).bigHour=!0})),We("hmm",(function(e,t,n){var r=e.length-2;t[ze]=ce(e.substr(0,r)),t[Ge]=ce(e.substr(r)),v(n).bigHour=!0})),We("hmmss",(function(e,t,n){var r=e.length-4,i=e.length-2;t[ze]=ce(e.substr(0,r)),t[Ge]=ce(e.substr(r,2)),t[Xe]=ce(e.substr(i)),v(n).bigHour=!0})),We("Hmm",(function(e,t,n){var r=e.length-2;t[ze]=ce(e.substr(0,r)),t[Ge]=ce(e.substr(r))})),We("Hmmss",(function(e,t,n){var r=e.length-4,i=e.length-2;t[ze]=ce(e.substr(0,r)),t[Ge]=ce(e.substr(r,2)),t[Xe]=ce(e.substr(i))}));var nn=/[ap]\.?m?\.?/i,rn=he("Hours",!0);function on(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}var sn,an={calendar:D,longDateFormat:Y,invalidDate:G,ordinal:K,dayOfMonthOrdinalParse:q,relativeTime:Q,months:et,monthsShort:tt,week:Rt,weekdays:Dt,weekdaysMin:At,weekdaysShort:Ht,meridiemParse:nn},ln={},un={};function cn(e,t){var n,r=Math.min(e.length,t.length);for(n=0;n<r;n+=1)if(e[n]!==t[n])return n;return r}function hn(e){return e?e.toLowerCase().replace("_","-"):e}function dn(e){for(var t,n,r,i,o=0;o<e.length;){for(t=(i=hn(e[o]).split("-")).length,n=(n=hn(e[o+1]))?n.split("-"):null;t>0;){if(r=gn(i.slice(0,t).join("-")))return r;if(n&&n.length>=t&&cn(i,n)>=t-1)break;t--}o++}return sn}function fn(e){return null!=e.match("^[^/\\\\]*$")}function gn(t){var n=null;if(void 0===ln[t]&&e&&e.exports&&fn(t))try{n=sn._abbr,Object(function(){var e=new Error("Cannot find module 'undefined'");throw e.code="MODULE_NOT_FOUND",e}()),mn(n)}catch(r){ln[t]=null}return ln[t]}function mn(e,t){var n;return e&&((n=u(t)?yn(e):vn(e,t))?sn=n:"undefined"!==typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),sn._abbr}function vn(e,t){if(null!==t){var n,r=an;if(t.abbr=e,null!=ln[e])O("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=ln[e]._config;else if(null!=t.parentLocale)if(null!=ln[t.parentLocale])r=ln[t.parentLocale]._config;else{if(null==(n=gn(t.parentLocale)))return un[t.parentLocale]||(un[t.parentLocale]=[]),un[t.parentLocale].push({name:e,config:t}),null;r=n._config}return ln[e]=new I(N(r,t)),un[e]&&un[e].forEach((function(e){vn(e.name,e.config)})),mn(e),ln[e]}return delete ln[e],null}function pn(e,t){if(null!=t){var n,r,i=an;null!=ln[e]&&null!=ln[e].parentLocale?ln[e].set(N(ln[e]._config,t)):(null!=(r=gn(e))&&(i=r._config),t=N(i,t),null==r&&(t.abbr=e),(n=new I(t)).parentLocale=ln[e],ln[e]=n),mn(e)}else null!=ln[e]&&(null!=ln[e].parentLocale?(ln[e]=ln[e].parentLocale,e===mn()&&mn(e)):null!=ln[e]&&delete ln[e]);return ln[e]}function yn(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return sn;if(!o(e)){if(t=gn(e))return t;e=[e]}return dn(e)}function wn(){return k(ln)}function Cn(e){var t,n=e._a;return n&&-2===v(e).overflow&&(t=n[Ue]<0||n[Ue]>11?Ue:n[Ye]<1||n[Ye]>Je(n[je],n[Ue])?Ye:n[ze]<0||n[ze]>24||24===n[ze]&&(0!==n[Ge]||0!==n[Xe]||0!==n[Ke])?ze:n[Ge]<0||n[Ge]>59?Ge:n[Xe]<0||n[Xe]>59?Xe:n[Ke]<0||n[Ke]>999?Ke:-1,v(e)._overflowDayOfYear&&(t<je||t>Ye)&&(t=Ye),v(e)._overflowWeeks&&-1===t&&(t=qe),v(e)._overflowWeekday&&-1===t&&(t=$e),v(e).overflow=t),e}var bn=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Sn=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Tn=/Z|[+-]\d\d(?::?\d\d)?/,En=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Rn=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],kn=/^\/?Date\((-?\d+)/i,_n=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,On={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Mn(e){var t,n,r,i,o,s,a=e._i,l=bn.exec(a)||Sn.exec(a),u=En.length,c=Rn.length;if(l){for(v(e).iso=!0,t=0,n=u;t<n;t++)if(En[t][1].exec(l[1])){i=En[t][0],r=!1!==En[t][2];break}if(null==i)return void(e._isValid=!1);if(l[3]){for(t=0,n=c;t<n;t++)if(Rn[t][1].exec(l[3])){o=(l[2]||" ")+Rn[t][0];break}if(null==o)return void(e._isValid=!1)}if(!r&&null!=o)return void(e._isValid=!1);if(l[4]){if(!Tn.exec(l[4]))return void(e._isValid=!1);s="Z"}e._f=i+(o||"")+(s||""),Bn(e)}else e._isValid=!1}function xn(e,t,n,r,i,o){var s=[Nn(e),tt.indexOf(t),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function Nn(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function In(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Dn(e,t,n){return!e||Ht.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(v(n).weekdayMismatch=!0,n._isValid=!1,!1)}function Hn(e,t,n){if(e)return On[e];if(t)return 0;var r=parseInt(n,10),i=r%100;return(r-i)/100*60+i}function An(e){var t,n=_n.exec(In(e._i));if(n){if(t=xn(n[4],n[3],n[2],n[5],n[6],n[7]),!Dn(n[1],t,e))return;e._a=t,e._tzm=Hn(n[8],n[9],n[10]),e._d=wt.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),v(e).rfc2822=!0}else e._isValid=!1}function Ln(e){var t=kn.exec(e._i);null===t?(Mn(e),!1===e._isValid&&(delete e._isValid,An(e),!1===e._isValid&&(delete e._isValid,e._strict?e._isValid=!1:r.createFromInputFallback(e)))):e._d=new Date(+t[1])}function Pn(e,t,n){return null!=e?e:null!=t?t:n}function Vn(e){var t=new Date(r.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Wn(e){var t,n,r,i,o,s=[];if(!e._d){for(r=Vn(e),e._w&&null==e._a[Ye]&&null==e._a[Ue]&&Fn(e),null!=e._dayOfYear&&(o=Pn(e._a[je],r[je]),(e._dayOfYear>mt(o)||0===e._dayOfYear)&&(v(e)._overflowDayOfYear=!0),n=wt(o,0,e._dayOfYear),e._a[Ue]=n.getUTCMonth(),e._a[Ye]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=s[t]=r[t];for(;t<7;t++)e._a[t]=s[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[ze]&&0===e._a[Ge]&&0===e._a[Xe]&&0===e._a[Ke]&&(e._nextDay=!0,e._a[ze]=0),e._d=(e._useUTC?wt:yt).apply(null,s),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ze]=24),e._w&&"undefined"!==typeof e._w.d&&e._w.d!==i&&(v(e).weekdayMismatch=!0)}}function Fn(e){var t,n,r,i,o,s,a,l,u;null!=(t=e._w).GG||null!=t.W||null!=t.E?(o=1,s=4,n=Pn(t.GG,e._a[je],St(Kn(),1,4).year),r=Pn(t.W,1),((i=Pn(t.E,1))<1||i>7)&&(l=!0)):(o=e._locale._week.dow,s=e._locale._week.doy,u=St(Kn(),o,s),n=Pn(t.gg,e._a[je],u.year),r=Pn(t.w,u.week),null!=t.d?((i=t.d)<0||i>6)&&(l=!0):null!=t.e?(i=t.e+o,(t.e<0||t.e>6)&&(l=!0)):i=o),r<1||r>Tt(n,o,s)?v(e)._overflowWeeks=!0:null!=l?v(e)._overflowWeekday=!0:(a=bt(n,r,i,o,s),e._a[je]=a.year,e._dayOfYear=a.dayOfYear)}function Bn(e){if(e._f!==r.ISO_8601)if(e._f!==r.RFC_2822){e._a=[],v(e).empty=!0;var t,n,i,o,s,a,l,u=""+e._i,c=u.length,h=0;for(l=(i=U(e._f,e._locale).match(L)||[]).length,t=0;t<l;t++)o=i[t],(n=(u.match(Ae(o,e))||[])[0])&&((s=u.substr(0,u.indexOf(n))).length>0&&v(e).unusedInput.push(s),u=u.slice(u.indexOf(n)+n.length),h+=n.length),W[o]?(n?v(e).empty=!1:v(e).unusedTokens.push(o),Be(o,n,e)):e._strict&&!n&&v(e).unusedTokens.push(o);v(e).charsLeftOver=c-h,u.length>0&&v(e).unusedInput.push(u),e._a[ze]<=12&&!0===v(e).bigHour&&e._a[ze]>0&&(v(e).bigHour=void 0),v(e).parsedDateParts=e._a.slice(0),v(e).meridiem=e._meridiem,e._a[ze]=Zn(e._locale,e._a[ze],e._meridiem),null!==(a=v(e).era)&&(e._a[je]=e._locale.erasConvertYear(a,e._a[je])),Wn(e),Cn(e)}else An(e);else Mn(e)}function Zn(e,t,n){var r;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((r=e.isPM(n))&&t<12&&(t+=12),r||12!==t||(t=0),t):t}function jn(e){var t,n,r,i,o,s,a=!1,l=e._f.length;if(0===l)return v(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<l;i++)o=0,s=!1,t=b({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],Bn(t),p(t)&&(s=!0),o+=v(t).charsLeftOver,o+=10*v(t).unusedTokens.length,v(t).score=o,a?o<r&&(r=o,n=t):(null==r||o<r||s)&&(r=o,n=t,s&&(a=!0));f(e,n||t)}function Un(e){if(!e._d){var t=ie(e._i),n=void 0===t.day?t.date:t.day;e._a=d([t.year,t.month,n,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),Wn(e)}}function Yn(e){var t=new S(Cn(zn(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function zn(e){var t=e._i,n=e._f;return e._locale=e._locale||yn(e._l),null===t||void 0===n&&""===t?y({nullInput:!0}):("string"===typeof t&&(e._i=t=e._locale.preparse(t)),T(t)?new S(Cn(t)):(h(t)?e._d=t:o(n)?jn(e):n?Bn(e):Gn(e),p(e)||(e._d=null),e))}function Gn(e){var t=e._i;u(t)?e._d=new Date(r.now()):h(t)?e._d=new Date(t.valueOf()):"string"===typeof t?Ln(e):o(t)?(e._a=d(t.slice(0),(function(e){return parseInt(e,10)})),Wn(e)):s(t)?Un(e):c(t)?e._d=new Date(t):r.createFromInputFallback(e)}function Xn(e,t,n,r,i){var a={};return!0!==t&&!1!==t||(r=t,t=void 0),!0!==n&&!1!==n||(r=n,n=void 0),(s(e)&&l(e)||o(e)&&0===e.length)&&(e=void 0),a._isAMomentObject=!0,a._useUTC=a._isUTC=i,a._l=n,a._i=e,a._f=t,a._strict=r,Yn(a)}function Kn(e,t,n,r){return Xn(e,t,n,r,!1)}r.createFromInputFallback=R("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),r.ISO_8601=function(){},r.RFC_2822=function(){};var qn=R("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Kn.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:y()})),$n=R("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Kn.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:y()}));function Qn(e,t){var n,r;if(1===t.length&&o(t[0])&&(t=t[0]),!t.length)return Kn();for(n=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](n)||(n=t[r]);return n}function Jn(){return Qn("isBefore",[].slice.call(arguments,0))}function er(){return Qn("isAfter",[].slice.call(arguments,0))}var tr=function(){return Date.now?Date.now():+new Date},nr=["year","quarter","month","week","day","hour","minute","second","millisecond"];function rr(e){var t,n,r=!1,i=nr.length;for(t in e)if(a(e,t)&&(-1===Ze.call(nr,t)||null!=e[t]&&isNaN(e[t])))return!1;for(n=0;n<i;++n)if(e[nr[n]]){if(r)return!1;parseFloat(e[nr[n]])!==ce(e[nr[n]])&&(r=!0)}return!0}function ir(){return this._isValid}function or(){return Or(NaN)}function sr(e){var t=ie(e),n=t.year||0,r=t.quarter||0,i=t.month||0,o=t.week||t.isoWeek||0,s=t.day||0,a=t.hour||0,l=t.minute||0,u=t.second||0,c=t.millisecond||0;this._isValid=rr(t),this._milliseconds=+c+1e3*u+6e4*l+1e3*a*60*60,this._days=+s+7*o,this._months=+i+3*r+12*n,this._data={},this._locale=yn(),this._bubble()}function ar(e){return e instanceof sr}function lr(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function ur(e,t,n){var r,i=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),s=0;for(r=0;r<i;r++)(n&&e[r]!==t[r]||!n&&ce(e[r])!==ce(t[r]))&&s++;return s+o}function cr(e,t){F(e,0,0,(function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+A(~~(e/60),2)+t+A(~~e%60,2)}))}cr("Z",":"),cr("ZZ",""),He("Z",Ne),He("ZZ",Ne),We(["Z","ZZ"],(function(e,t,n){n._useUTC=!0,n._tzm=dr(Ne,e)}));var hr=/([\+\-]|\d\d)/gi;function dr(e,t){var n,r,i=(t||"").match(e);return null===i?null:0===(r=60*(n=((i[i.length-1]||[])+"").match(hr)||["-",0,0])[1]+ce(n[2]))?0:"+"===n[0]?r:-r}function fr(e,t){var n,i;return t._isUTC?(n=t.clone(),i=(T(e)||h(e)?e.valueOf():Kn(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),r.updateOffset(n,!1),n):Kn(e).local()}function gr(e){return-Math.round(e._d.getTimezoneOffset())}function mr(e,t,n){var i,o=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"===typeof e){if(null===(e=dr(Ne,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(i=gr(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),o!==e&&(!t||this._changeInProgress?Dr(this,Or(e-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,r.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?o:gr(this)}function vr(e,t){return null!=e?("string"!==typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function pr(e){return this.utcOffset(0,e)}function yr(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(gr(this),"m")),this}function wr(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"===typeof this._i){var e=dr(xe,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function Cr(e){return!!this.isValid()&&(e=e?Kn(e).utcOffset():0,(this.utcOffset()-e)%60===0)}function br(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Sr(){if(!u(this._isDSTShifted))return this._isDSTShifted;var e,t={};return b(t,this),(t=zn(t))._a?(e=t._isUTC?g(t._a):Kn(t._a),this._isDSTShifted=this.isValid()&&ur(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Tr(){return!!this.isValid()&&!this._isUTC}function Er(){return!!this.isValid()&&this._isUTC}function Rr(){return!!this.isValid()&&this._isUTC&&0===this._offset}r.updateOffset=function(){};var kr=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,_r=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Or(e,t){var n,r,i,o=e,s=null;return ar(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:c(e)||!isNaN(+e)?(o={},t?o[t]=+e:o.milliseconds=+e):(s=kr.exec(e))?(n="-"===s[1]?-1:1,o={y:0,d:ce(s[Ye])*n,h:ce(s[ze])*n,m:ce(s[Ge])*n,s:ce(s[Xe])*n,ms:ce(lr(1e3*s[Ke]))*n}):(s=_r.exec(e))?(n="-"===s[1]?-1:1,o={y:Mr(s[2],n),M:Mr(s[3],n),w:Mr(s[4],n),d:Mr(s[5],n),h:Mr(s[6],n),m:Mr(s[7],n),s:Mr(s[8],n)}):null==o?o={}:"object"===typeof o&&("from"in o||"to"in o)&&(i=Nr(Kn(o.from),Kn(o.to)),(o={}).ms=i.milliseconds,o.M=i.months),r=new sr(o),ar(e)&&a(e,"_locale")&&(r._locale=e._locale),ar(e)&&a(e,"_isValid")&&(r._isValid=e._isValid),r}function Mr(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function xr(e,t){var n={};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Nr(e,t){var n;return e.isValid()&&t.isValid()?(t=fr(t,e),e.isBefore(t)?n=xr(e,t):((n=xr(t,e)).milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function Ir(e,t){return function(n,r){var i;return null===r||isNaN(+r)||(O(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=n,n=r,r=i),Dr(this,Or(n,r),e),this}}function Dr(e,t,n,i){var o=t._milliseconds,s=lr(t._days),a=lr(t._months);e.isValid()&&(i=null==i||i,a&&ut(e,de(e,"Month")+a*n),s&&fe(e,"Date",de(e,"Date")+s*n),o&&e._d.setTime(e._d.valueOf()+o*n),i&&r.updateOffset(e,s||a))}Or.fn=sr.prototype,Or.invalid=or;var Hr=Ir(1,"add"),Ar=Ir(-1,"subtract");function Lr(e){return"string"===typeof e||e instanceof String}function Pr(e){return T(e)||h(e)||Lr(e)||c(e)||Wr(e)||Vr(e)||null===e||void 0===e}function Vr(e){var t,n,r=s(e)&&!l(e),i=!1,o=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],u=o.length;for(t=0;t<u;t+=1)n=o[t],i=i||a(e,n);return r&&i}function Wr(e){var t=o(e),n=!1;return t&&(n=0===e.filter((function(t){return!c(t)&&Lr(e)})).length),t&&n}function Fr(e){var t,n,r=s(e)&&!l(e),i=!1,o=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(t=0;t<o.length;t+=1)n=o[t],i=i||a(e,n);return r&&i}function Br(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function Zr(e,t){1===arguments.length&&(arguments[0]?Pr(arguments[0])?(e=arguments[0],t=void 0):Fr(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var n=e||Kn(),i=fr(n,this).startOf("day"),o=r.calendarFormat(this,i)||"sameElse",s=t&&(M(t[o])?t[o].call(this,n):t[o]);return this.format(s||this.localeData().calendar(o,this,Kn(n)))}function jr(){return new S(this)}function Ur(e,t){var n=T(e)?e:Kn(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=re(t)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())}function Yr(e,t){var n=T(e)?e:Kn(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=re(t)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())}function zr(e,t,n,r){var i=T(e)?e:Kn(e),o=T(t)?t:Kn(t);return!!(this.isValid()&&i.isValid()&&o.isValid())&&("("===(r=r||"()")[0]?this.isAfter(i,n):!this.isBefore(i,n))&&(")"===r[1]?this.isBefore(o,n):!this.isAfter(o,n))}function Gr(e,t){var n,r=T(e)?e:Kn(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=re(t)||"millisecond")?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))}function Xr(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Kr(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function qr(e,t,n){var r,i,o;if(!this.isValid())return NaN;if(!(r=fr(e,this)).isValid())return NaN;switch(i=6e4*(r.utcOffset()-this.utcOffset()),t=re(t)){case"year":o=$r(this,r)/12;break;case"month":o=$r(this,r);break;case"quarter":o=$r(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:ue(o)}function $r(e,t){if(e.date()<t.date())return-$r(t,e);var n=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(n,"months");return-(n+(t-r<0?(t-r)/(r-e.clone().add(n-1,"months")):(t-r)/(e.clone().add(n+1,"months")-r)))||0}function Qr(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Jr(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?j(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):M(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",j(n,"Z")):j(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function ei(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,t,n,r,i="moment",o="";return this.isLocal()||(i=0===this.utcOffset()?"moment.utc":"moment.parseZone",o="Z"),e="["+i+'("]',t=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n="-MM-DD[T]HH:mm:ss.SSS",r=o+'[")]',this.format(e+t+n+r)}function ti(e){e||(e=this.isUtc()?r.defaultFormatUtc:r.defaultFormat);var t=j(this,e);return this.localeData().postformat(t)}function ni(e,t){return this.isValid()&&(T(e)&&e.isValid()||Kn(e).isValid())?Or({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ri(e){return this.from(Kn(),e)}function ii(e,t){return this.isValid()&&(T(e)&&e.isValid()||Kn(e).isValid())?Or({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function oi(e){return this.to(Kn(),e)}function si(e){var t;return void 0===e?this._locale._abbr:(null!=(t=yn(e))&&(this._locale=t),this)}r.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",r.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var ai=R("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function li(){return this._locale}var ui=1e3,ci=60*ui,hi=60*ci,di=3506328*hi;function fi(e,t){return(e%t+t)%t}function gi(e,t,n){return e<100&&e>=0?new Date(e+400,t,n)-di:new Date(e,t,n).valueOf()}function mi(e,t,n){return e<100&&e>=0?Date.UTC(e+400,t,n)-di:Date.UTC(e,t,n)}function vi(e){var t,n;if(void 0===(e=re(e))||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?mi:gi,e){case"year":t=n(this.year(),0,1);break;case"quarter":t=n(this.year(),this.month()-this.month()%3,1);break;case"month":t=n(this.year(),this.month(),1);break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=n(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=fi(t+(this._isUTC?0:this.utcOffset()*ci),hi);break;case"minute":t=this._d.valueOf(),t-=fi(t,ci);break;case"second":t=this._d.valueOf(),t-=fi(t,ui)}return this._d.setTime(t),r.updateOffset(this,!0),this}function pi(e){var t,n;if(void 0===(e=re(e))||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?mi:gi,e){case"year":t=n(this.year()+1,0,1)-1;break;case"quarter":t=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=n(this.year(),this.month()+1,1)-1;break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=hi-fi(t+(this._isUTC?0:this.utcOffset()*ci),hi)-1;break;case"minute":t=this._d.valueOf(),t+=ci-fi(t,ci)-1;break;case"second":t=this._d.valueOf(),t+=ui-fi(t,ui)-1}return this._d.setTime(t),r.updateOffset(this,!0),this}function yi(){return this._d.valueOf()-6e4*(this._offset||0)}function wi(){return Math.floor(this.valueOf()/1e3)}function Ci(){return new Date(this.valueOf())}function bi(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Si(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Ti(){return this.isValid()?this.toISOString():null}function Ei(){return p(this)}function Ri(){return f({},v(this))}function ki(){return v(this).overflow}function _i(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Oi(e,t){var n,i,o,s=this._eras||yn("en")._eras;for(n=0,i=s.length;n<i;++n)switch("string"===typeof s[n].since&&(o=r(s[n].since).startOf("day"),s[n].since=o.valueOf()),typeof s[n].until){case"undefined":s[n].until=1/0;break;case"string":o=r(s[n].until).startOf("day").valueOf(),s[n].until=o.valueOf()}return s}function Mi(e,t,n){var r,i,o,s,a,l=this.eras();for(e=e.toUpperCase(),r=0,i=l.length;r<i;++r)if(o=l[r].name.toUpperCase(),s=l[r].abbr.toUpperCase(),a=l[r].narrow.toUpperCase(),n)switch(t){case"N":case"NN":case"NNN":if(s===e)return l[r];break;case"NNNN":if(o===e)return l[r];break;case"NNNNN":if(a===e)return l[r]}else if([o,s,a].indexOf(e)>=0)return l[r]}function xi(e,t){var n=e.since<=e.until?1:-1;return void 0===t?r(e.since).year():r(e.since).year()+(t-e.offset)*n}function Ni(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until)return r[e].name;if(r[e].until<=n&&n<=r[e].since)return r[e].name}return""}function Ii(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until)return r[e].narrow;if(r[e].until<=n&&n<=r[e].since)return r[e].narrow}return""}function Di(){var e,t,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until)return r[e].abbr;if(r[e].until<=n&&n<=r[e].since)return r[e].abbr}return""}function Hi(){var e,t,n,i,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e)if(n=o[e].since<=o[e].until?1:-1,i=this.clone().startOf("day").valueOf(),o[e].since<=i&&i<=o[e].until||o[e].until<=i&&i<=o[e].since)return(this.year()-r(o[e].since).year())*n+o[e].offset;return this.year()}function Ai(e){return a(this,"_erasNameRegex")||Zi.call(this),e?this._erasNameRegex:this._erasRegex}function Li(e){return a(this,"_erasAbbrRegex")||Zi.call(this),e?this._erasAbbrRegex:this._erasRegex}function Pi(e){return a(this,"_erasNarrowRegex")||Zi.call(this),e?this._erasNarrowRegex:this._erasRegex}function Vi(e,t){return t.erasAbbrRegex(e)}function Wi(e,t){return t.erasNameRegex(e)}function Fi(e,t){return t.erasNarrowRegex(e)}function Bi(e,t){return t._eraYearOrdinalRegex||Oe}function Zi(){var e,t,n=[],r=[],i=[],o=[],s=this.eras();for(e=0,t=s.length;e<t;++e)r.push(Pe(s[e].name)),n.push(Pe(s[e].abbr)),i.push(Pe(s[e].narrow)),o.push(Pe(s[e].name)),o.push(Pe(s[e].abbr)),o.push(Pe(s[e].narrow));this._erasRegex=new RegExp("^("+o.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+r.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+i.join("|")+")","i")}function ji(e,t){F(0,[e,e.length],0,t)}function Ui(e){return qi.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Yi(e){return qi.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function zi(){return Tt(this.year(),1,4)}function Gi(){return Tt(this.isoWeekYear(),1,4)}function Xi(){var e=this.localeData()._week;return Tt(this.year(),e.dow,e.doy)}function Ki(){var e=this.localeData()._week;return Tt(this.weekYear(),e.dow,e.doy)}function qi(e,t,n,r,i){var o;return null==e?St(this,r,i).year:(t>(o=Tt(e,r,i))&&(t=o),$i.call(this,e,t,n,r,i))}function $i(e,t,n,r,i){var o=bt(e,t,n,r,i),s=wt(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}function Qi(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}F("N",0,0,"eraAbbr"),F("NN",0,0,"eraAbbr"),F("NNN",0,0,"eraAbbr"),F("NNNN",0,0,"eraName"),F("NNNNN",0,0,"eraNarrow"),F("y",["y",1],"yo","eraYear"),F("y",["yy",2],0,"eraYear"),F("y",["yyy",3],0,"eraYear"),F("y",["yyyy",4],0,"eraYear"),He("N",Vi),He("NN",Vi),He("NNN",Vi),He("NNNN",Wi),He("NNNNN",Fi),We(["N","NN","NNN","NNNN","NNNNN"],(function(e,t,n,r){var i=n._locale.erasParse(e,r,n._strict);i?v(n).era=i:v(n).invalidEra=e})),He("y",Oe),He("yy",Oe),He("yyy",Oe),He("yyyy",Oe),He("yo",Bi),We(["y","yy","yyy","yyyy"],je),We(["yo"],(function(e,t,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=e.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?t[je]=n._locale.eraYearOrdinalParse(e,i):t[je]=parseInt(e,10)})),F(0,["gg",2],0,(function(){return this.weekYear()%100})),F(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),ji("gggg","weekYear"),ji("ggggg","weekYear"),ji("GGGG","isoWeekYear"),ji("GGGGG","isoWeekYear"),ne("weekYear","gg"),ne("isoWeekYear","GG"),se("weekYear",1),se("isoWeekYear",1),He("G",Me),He("g",Me),He("GG",Se,ye),He("gg",Se,ye),He("GGGG",ke,Ce),He("gggg",ke,Ce),He("GGGGG",_e,be),He("ggggg",_e,be),Fe(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,n,r){t[r.substr(0,2)]=ce(e)})),Fe(["gg","GG"],(function(e,t,n,i){t[i]=r.parseTwoDigitYear(e)})),F("Q",0,"Qo","quarter"),ne("quarter","Q"),se("quarter",7),He("Q",pe),We("Q",(function(e,t){t[Ue]=3*(ce(e)-1)})),F("D",["DD",2],"Do","date"),ne("date","D"),se("date",9),He("D",Se),He("DD",Se,ye),He("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),We(["D","DD"],Ye),We("Do",(function(e,t){t[Ye]=ce(e.match(Se)[0])}));var Ji=he("Date",!0);function eo(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}F("DDD",["DDDD",3],"DDDo","dayOfYear"),ne("dayOfYear","DDD"),se("dayOfYear",4),He("DDD",Re),He("DDDD",we),We(["DDD","DDDD"],(function(e,t,n){n._dayOfYear=ce(e)})),F("m",["mm",2],0,"minute"),ne("minute","m"),se("minute",14),He("m",Se),He("mm",Se,ye),We(["m","mm"],Ge);var to=he("Minutes",!1);F("s",["ss",2],0,"second"),ne("second","s"),se("second",15),He("s",Se),He("ss",Se,ye),We(["s","ss"],Xe);var no,ro,io=he("Seconds",!1);for(F("S",0,0,(function(){return~~(this.millisecond()/100)})),F(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),F(0,["SSS",3],0,"millisecond"),F(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),F(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),F(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),F(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),F(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),F(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),ne("millisecond","ms"),se("millisecond",16),He("S",Re,pe),He("SS",Re,ye),He("SSS",Re,we),no="SSSS";no.length<=9;no+="S")He(no,Oe);function oo(e,t){t[Ke]=ce(1e3*("0."+e))}for(no="S";no.length<=9;no+="S")We(no,oo);function so(){return this._isUTC?"UTC":""}function ao(){return this._isUTC?"Coordinated Universal Time":""}ro=he("Milliseconds",!1),F("z",0,0,"zoneAbbr"),F("zz",0,0,"zoneName");var lo=S.prototype;function uo(e){return Kn(1e3*e)}function co(){return Kn.apply(null,arguments).parseZone()}function ho(e){return e}lo.add=Hr,lo.calendar=Zr,lo.clone=jr,lo.diff=qr,lo.endOf=pi,lo.format=ti,lo.from=ni,lo.fromNow=ri,lo.to=ii,lo.toNow=oi,lo.get=ge,lo.invalidAt=ki,lo.isAfter=Ur,lo.isBefore=Yr,lo.isBetween=zr,lo.isSame=Gr,lo.isSameOrAfter=Xr,lo.isSameOrBefore=Kr,lo.isValid=Ei,lo.lang=ai,lo.locale=si,lo.localeData=li,lo.max=$n,lo.min=qn,lo.parsingFlags=Ri,lo.set=me,lo.startOf=vi,lo.subtract=Ar,lo.toArray=bi,lo.toObject=Si,lo.toDate=Ci,lo.toISOString=Jr,lo.inspect=ei,"undefined"!==typeof Symbol&&null!=Symbol.for&&(lo[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),lo.toJSON=Ti,lo.toString=Qr,lo.unix=wi,lo.valueOf=yi,lo.creationData=_i,lo.eraName=Ni,lo.eraNarrow=Ii,lo.eraAbbr=Di,lo.eraYear=Hi,lo.year=vt,lo.isLeapYear=pt,lo.weekYear=Ui,lo.isoWeekYear=Yi,lo.quarter=lo.quarters=Qi,lo.month=ct,lo.daysInMonth=ht,lo.week=lo.weeks=Ot,lo.isoWeek=lo.isoWeeks=Mt,lo.weeksInYear=Xi,lo.weeksInWeekYear=Ki,lo.isoWeeksInYear=zi,lo.isoWeeksInISOWeekYear=Gi,lo.date=Ji,lo.day=lo.days=Ut,lo.weekday=Yt,lo.isoWeekday=zt,lo.dayOfYear=eo,lo.hour=lo.hours=rn,lo.minute=lo.minutes=to,lo.second=lo.seconds=io,lo.millisecond=lo.milliseconds=ro,lo.utcOffset=mr,lo.utc=pr,lo.local=yr,lo.parseZone=wr,lo.hasAlignedHourOffset=Cr,lo.isDST=br,lo.isLocal=Tr,lo.isUtcOffset=Er,lo.isUtc=Rr,lo.isUTC=Rr,lo.zoneAbbr=so,lo.zoneName=ao,lo.dates=R("dates accessor is deprecated. Use date instead.",Ji),lo.months=R("months accessor is deprecated. Use month instead",ct),lo.years=R("years accessor is deprecated. Use year instead",vt),lo.zone=R("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",vr),lo.isDSTShifted=R("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Sr);var fo=I.prototype;function go(e,t,n,r){var i=yn(),o=g().set(r,t);return i[n](o,e)}function mo(e,t,n){if(c(e)&&(t=e,e=void 0),e=e||"",null!=t)return go(e,t,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=go(e,r,n,"month");return i}function vo(e,t,n,r){"boolean"===typeof e?(c(t)&&(n=t,t=void 0),t=t||""):(n=t=e,e=!1,c(t)&&(n=t,t=void 0),t=t||"");var i,o=yn(),s=e?o._week.dow:0,a=[];if(null!=n)return go(t,(n+s)%7,r,"day");for(i=0;i<7;i++)a[i]=go(t,(i+s)%7,r,"day");return a}function po(e,t){return mo(e,t,"months")}function yo(e,t){return mo(e,t,"monthsShort")}function wo(e,t,n){return vo(e,t,n,"weekdays")}function Co(e,t,n){return vo(e,t,n,"weekdaysShort")}function bo(e,t,n){return vo(e,t,n,"weekdaysMin")}fo.calendar=H,fo.longDateFormat=z,fo.invalidDate=X,fo.ordinal=$,fo.preparse=ho,fo.postformat=ho,fo.relativeTime=J,fo.pastFuture=ee,fo.set=x,fo.eras=Oi,fo.erasParse=Mi,fo.erasConvertYear=xi,fo.erasAbbrRegex=Li,fo.erasNameRegex=Ai,fo.erasNarrowRegex=Pi,fo.months=ot,fo.monthsShort=st,fo.monthsParse=lt,fo.monthsRegex=ft,fo.monthsShortRegex=dt,fo.week=Et,fo.firstDayOfYear=_t,fo.firstDayOfWeek=kt,fo.weekdays=Wt,fo.weekdaysMin=Bt,fo.weekdaysShort=Ft,fo.weekdaysParse=jt,fo.weekdaysRegex=Gt,fo.weekdaysShortRegex=Xt,fo.weekdaysMinRegex=Kt,fo.isPM=tn,fo.meridiem=on,mn("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===ce(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),r.lang=R("moment.lang is deprecated. Use moment.locale instead.",mn),r.langData=R("moment.langData is deprecated. Use moment.localeData instead.",yn);var So=Math.abs;function To(){var e=this._data;return this._milliseconds=So(this._milliseconds),this._days=So(this._days),this._months=So(this._months),e.milliseconds=So(e.milliseconds),e.seconds=So(e.seconds),e.minutes=So(e.minutes),e.hours=So(e.hours),e.months=So(e.months),e.years=So(e.years),this}function Eo(e,t,n,r){var i=Or(t,n);return e._milliseconds+=r*i._milliseconds,e._days+=r*i._days,e._months+=r*i._months,e._bubble()}function Ro(e,t){return Eo(this,e,t,1)}function ko(e,t){return Eo(this,e,t,-1)}function _o(e){return e<0?Math.floor(e):Math.ceil(e)}function Oo(){var e,t,n,r,i,o=this._milliseconds,s=this._days,a=this._months,l=this._data;return o>=0&&s>=0&&a>=0||o<=0&&s<=0&&a<=0||(o+=864e5*_o(xo(a)+s),s=0,a=0),l.milliseconds=o%1e3,e=ue(o/1e3),l.seconds=e%60,t=ue(e/60),l.minutes=t%60,n=ue(t/60),l.hours=n%24,s+=ue(n/24),a+=i=ue(Mo(s)),s-=_o(xo(i)),r=ue(a/12),a%=12,l.days=s,l.months=a,l.years=r,this}function Mo(e){return 4800*e/146097}function xo(e){return 146097*e/4800}function No(e){if(!this.isValid())return NaN;var t,n,r=this._milliseconds;if("month"===(e=re(e))||"quarter"===e||"year"===e)switch(t=this._days+r/864e5,n=this._months+Mo(t),e){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(t=this._days+Math.round(xo(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}}function Io(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*ce(this._months/12):NaN}function Do(e){return function(){return this.as(e)}}var Ho=Do("ms"),Ao=Do("s"),Lo=Do("m"),Po=Do("h"),Vo=Do("d"),Wo=Do("w"),Fo=Do("M"),Bo=Do("Q"),Zo=Do("y");function jo(){return Or(this)}function Uo(e){return e=re(e),this.isValid()?this[e+"s"]():NaN}function Yo(e){return function(){return this.isValid()?this._data[e]:NaN}}var zo=Yo("milliseconds"),Go=Yo("seconds"),Xo=Yo("minutes"),Ko=Yo("hours"),qo=Yo("days"),$o=Yo("months"),Qo=Yo("years");function Jo(){return ue(this.days()/7)}var es=Math.round,ts={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function ns(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function rs(e,t,n,r){var i=Or(e).abs(),o=es(i.as("s")),s=es(i.as("m")),a=es(i.as("h")),l=es(i.as("d")),u=es(i.as("M")),c=es(i.as("w")),h=es(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return null!=n.w&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),(d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h])[2]=t,d[3]=+e>0,d[4]=r,ns.apply(null,d)}function is(e){return void 0===e?es:"function"===typeof e&&(es=e,!0)}function os(e,t){return void 0!==ts[e]&&(void 0===t?ts[e]:(ts[e]=t,"s"===e&&(ts.ss=t-1),!0))}function ss(e,t){if(!this.isValid())return this.localeData().invalidDate();var n,r,i=!1,o=ts;return"object"===typeof e&&(t=e,e=!1),"boolean"===typeof e&&(i=e),"object"===typeof t&&(o=Object.assign({},ts,t),null!=t.s&&null==t.ss&&(o.ss=t.s-1)),r=rs(this,!i,o,n=this.localeData()),i&&(r=n.pastFuture(+this,r)),n.postformat(r)}var as=Math.abs;function ls(e){return(e>0)-(e<0)||+e}function us(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n,r,i,o,s,a,l=as(this._milliseconds)/1e3,u=as(this._days),c=as(this._months),h=this.asSeconds();return h?(e=ue(l/60),t=ue(e/60),l%=60,e%=60,n=ue(c/12),c%=12,r=l?l.toFixed(3).replace(/\.?0+$/,""):"",i=h<0?"-":"",o=ls(this._months)!==ls(h)?"-":"",s=ls(this._days)!==ls(h)?"-":"",a=ls(this._milliseconds)!==ls(h)?"-":"",i+"P"+(n?o+n+"Y":"")+(c?o+c+"M":"")+(u?s+u+"D":"")+(t||e||l?"T":"")+(t?a+t+"H":"")+(e?a+e+"M":"")+(l?a+r+"S":"")):"P0D"}var cs=sr.prototype;return cs.isValid=ir,cs.abs=To,cs.add=Ro,cs.subtract=ko,cs.as=No,cs.asMilliseconds=Ho,cs.asSeconds=Ao,cs.asMinutes=Lo,cs.asHours=Po,cs.asDays=Vo,cs.asWeeks=Wo,cs.asMonths=Fo,cs.asQuarters=Bo,cs.asYears=Zo,cs.valueOf=Io,cs._bubble=Oo,cs.clone=jo,cs.get=Uo,cs.milliseconds=zo,cs.seconds=Go,cs.minutes=Xo,cs.hours=Ko,cs.days=qo,cs.weeks=Jo,cs.months=$o,cs.years=Qo,cs.humanize=ss,cs.toISOString=us,cs.toString=us,cs.toJSON=us,cs.locale=si,cs.localeData=li,cs.toIsoString=R("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",us),cs.lang=ai,F("X",0,0,"unix"),F("x",0,0,"valueOf"),He("x",Me),He("X",Ie),We("X",(function(e,t,n){n._d=new Date(1e3*parseFloat(e))})),We("x",(function(e,t,n){n._d=new Date(ce(e))})),r.version="2.29.4",i(Kn),r.fn=lo,r.min=Jn,r.max=er,r.now=tr,r.utc=g,r.unix=uo,r.months=po,r.isDate=h,r.locale=mn,r.invalid=y,r.duration=Or,r.isMoment=T,r.weekdays=wo,r.parseZone=co,r.localeData=yn,r.isDuration=ar,r.monthsShort=yo,r.weekdaysMin=bo,r.defineLocale=vn,r.updateLocale=pn,r.locales=wn,r.weekdaysShort=Co,r.normalizeUnits=re,r.relativeTimeRounding=is,r.relativeTimeThreshold=os,r.calendarFormat=Br,r.prototype=lo,r.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},r}()},2285:function(e,t,n){!function(t,r){"use strict";var i;try{i=n(2426)}catch(o){}e.exports=function(e){var t="function"===typeof e,n=!!window.addEventListener,r=window.document,i=window.setTimeout,o=function(e,t,r,i){n?e.addEventListener(t,r,!!i):e.attachEvent("on"+t,r)},s=function(e,t,r,i){n?e.removeEventListener(t,r,!!i):e.detachEvent("on"+t,r)},a=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},l=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},u=function(e,t){l(e,t)||(e.className=""===e.className?t:e.className+" "+t)},c=function(e,t){e.className=a((" "+e.className+" ").replace(" "+t+" "," "))},h=function(e){return/Array/.test(Object.prototype.toString.call(e))},d=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},f=function(e){var t=e.getDay();return 0===t||6===t},g=function(e){return e%4===0&&e%100!==0||e%400===0},m=function(e,t){return[31,g(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},v=function(e){d(e)&&e.setHours(0,0,0,0)},p=function(e,t){return e.getTime()===t.getTime()},y=function e(t,n,r){var i,o;for(i in n)(o=void 0!==t[i])&&"object"===typeof n[i]&&null!==n[i]&&void 0===n[i].nodeName?d(n[i])?r&&(t[i]=new Date(n[i].getTime())):h(n[i])?r&&(t[i]=n[i].slice(0)):t[i]=e({},n[i],r):!r&&o||(t[i]=n[i]);return t},w=function(e,t,n){var i;r.createEvent?((i=r.createEvent("HTMLEvents")).initEvent(t,!0,!1),i=y(i,n),e.dispatchEvent(i)):r.createEventObject&&(i=r.createEventObject(),i=y(i,n),e.fireEvent("on"+t,i))},C=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},b={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},S=function(e,t,n){for(t+=e.firstDay;t>=7;)t-=7;return n?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},T=function(e){var t=[],n="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),n="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},E=function(e,t){e.setHours(0,0,0,0);var n=e.getDate(),r=e.getDay(),i=t,o=i-1,s=7,a=function(e){return(e+s-1)%s};e.setDate(n+o-a(r));var l=new Date(e.getFullYear(),0,i),u=864e5,c=(e.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},R=function(n,r,i,o){var s=new Date(i,r,n);return'<td class="pika-week">'+(t?e(s).isoWeek():E(s,o))+"</td>"},k=function(e,t,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(t?e.reverse():e).join("")+"</tr>"},_=function(e){return"<tbody>"+e.join("")+"</tbody>"},O=function(e){var t,n=[];for(e.showWeekNumber&&n.push("<th></th>"),t=0;t<7;t++)n.push('<th scope="col"><abbr title="'+S(e,t)+'">'+S(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?n.reverse():n).join("")+"</tr></thead>"},M=function(e,t,n,r,i,o){var s,a,l,u,c,d=e._o,f=n===d.minYear,g=n===d.maxYear,m='<div id="'+o+'" class="pika-title" role="heading" aria-live="assertive">',v=!0,p=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-t:12+s-t)+'"'+(s===r?' selected="selected"':"")+(f&&s<d.minMonth||g&&s>d.maxMonth?' disabled="disabled"':"")+">"+d.i18n.months[s]+"</option>");for(u='<div class="pika-label">'+d.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",h(d.yearRange)?(s=d.yearRange[0],a=d.yearRange[1]+1):(s=n-d.yearRange,a=1+n+d.yearRange),l=[];s<a&&s<=d.maxYear;s++)s>=d.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return c='<div class="pika-label">'+n+d.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",d.showMonthAfterYear?m+=c+u:m+=u+c,f&&(0===r||d.minMonth>=r)&&(v=!1),g&&(11===r||d.maxMonth<=r)&&(p=!1),0===t&&(m+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+d.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(m+='<button class="pika-next'+(p?"":" is-disabled")+'" type="button">'+d.i18n.nextMonth+"</button>"),m+"</div>"},x=function(e,t,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+O(e)+_(t)+"</table>"},N=function(s){var a=this,u=a.config(s);a._onMouseDown=function(e){if(a._v){var t=(e=e||window.event).target||e.srcElement;if(t)if(l(t,"is-disabled")||(!l(t,"pika-button")||l(t,"is-empty")||l(t.parentNode,"is-disabled")?l(t,"pika-prev")?a.prevMonth():l(t,"pika-next")&&a.nextMonth():(a.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),u.bound&&i((function(){a.hide(),u.blurFieldOnSelect&&u.field&&u.field.blur()}),100))),l(t,"pika-select"))a._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}}},a._onChange=function(e){var t=(e=e||window.event).target||e.srcElement;t&&(l(t,"pika-select-month")?a.gotoMonth(t.value):l(t,"pika-select-year")&&a.gotoYear(t.value))},a._onKeyChange=function(e){if(e=e||window.event,a.isVisible())switch(e.keyCode){case 13:case 27:u.field&&u.field.blur();break;case 37:a.adjustDate("subtract",1);break;case 38:a.adjustDate("subtract",7);break;case 39:a.adjustDate("add",1);break;case 40:a.adjustDate("add",7);break;case 8:case 46:a.setDate(null)}},a._parseFieldValue=function(){if(u.parse)return u.parse(u.field.value,u.format);if(t){var n=e(u.field.value,u.format,u.formatStrict);return n&&n.isValid()?n.toDate():null}return new Date(Date.parse(u.field.value))},a._onInputChange=function(e){var t;e.firedBy!==a&&(t=a._parseFieldValue(),d(t)&&a.setDate(t),a._v||a.show())},a._onInputFocus=function(){a.show()},a._onInputClick=function(){a.show()},a._onInputBlur=function(){var e=r.activeElement;do{if(l(e,"pika-single"))return}while(e=e.parentNode);a._c||(a._b=i((function(){a.hide()}),50)),a._c=!1},a._onClick=function(e){var t=(e=e||window.event).target||e.srcElement,r=t;if(t){!n&&l(t,"pika-select")&&(t.onchange||(t.setAttribute("onchange","return;"),o(t,"change",a._onChange)));do{if(l(r,"pika-single")||r===u.trigger)return}while(r=r.parentNode);a._v&&t!==u.trigger&&r!==u.trigger&&a.hide()}},a.el=r.createElement("div"),a.el.className="pika-single"+(u.isRTL?" is-rtl":"")+(u.theme?" "+u.theme:""),o(a.el,"mousedown",a._onMouseDown,!0),o(a.el,"touchend",a._onMouseDown,!0),o(a.el,"change",a._onChange),u.keyboardInput&&o(r,"keydown",a._onKeyChange),u.field&&(u.container?u.container.appendChild(a.el):u.bound?r.body.appendChild(a.el):u.field.parentNode.insertBefore(a.el,u.field.nextSibling),o(u.field,"change",a._onInputChange),u.defaultDate||(u.defaultDate=a._parseFieldValue(),u.setDefaultDate=!0));var c=u.defaultDate;d(c)?u.setDefaultDate?a.setDate(c,!0):a.gotoDate(c):a.gotoDate(new Date),u.bound?(this.hide(),a.el.className+=" is-bound",o(u.trigger,"click",a._onInputClick),o(u.trigger,"focus",a._onInputFocus),o(u.trigger,"blur",a._onInputBlur)):this.show()};return N.prototype={config:function(e){this._o||(this._o=y({},b,!0));var t=y(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme="string"===typeof t.theme&&t.theme?t.theme:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"===typeof t.disableDayFn?t.disableDayFn:null;var n=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=n>4?4:n,d(t.minDate)||(t.minDate=!1),d(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),h(t.yearRange)){var r=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||r,t.yearRange[1]=parseInt(t.yearRange[1],10)||r}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||b.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(n){return n=n||this._o.format,d(this._d)?this._o.toString?this._o.toString(this._d,n):t?e(this._d).format(n):this._d.toDateString():""},getMoment:function(){return t?e(this._d):null},setMoment:function(n,r){t&&e.isMoment(n)&&this.setDate(n.toDate(),r)},getDate:function(){return d(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",w(this._o.field,"change",{firedBy:this})),this.draw();if("string"===typeof e&&(e=new Date(Date.parse(e))),d(e)){var n=this._o.minDate,r=this._o.maxDate;d(n)&&e<n?e=n:d(r)&&e>r&&(e=r),this._d=new Date(e.getTime()),v(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),w(this._o.field,"change",{firedBy:this})),t||"function"!==typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(e){var t=!0;if(d(e)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=e.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),t=i<n.getTime()||r.getTime()<i}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(e,t){var n,r=this.getDate()||new Date,i=24*parseInt(t)*60*60*1e3;"add"===e?n=new Date(r.valueOf()+i):"subtract"===e&&(n=new Date(r.valueOf()-i)),this.setDate(n)},adjustCalendars:function(){this.calendars[0]=C(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=C({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(v(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=b.minDate,this._o.minYear=b.minYear,this._o.minMonth=b.minMonth,this._o.startRange=b.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(v(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=b.maxDate,this._o.maxYear=b.maxYear,this._o.maxMonth=b.maxMonth,this._o.endRange=b.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(this._v||e){var t,n=this._o,r=n.minYear,o=n.maxYear,s=n.minMonth,a=n.maxMonth,l="";this._y<=r&&(this._y=r,!isNaN(s)&&this._m<s&&(this._m=s)),this._y>=o&&(this._y=o,!isNaN(a)&&this._m>a&&(this._m=a));for(var u=0;u<n.numberOfMonths;u++)t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),l+='<div class="pika-lendar">'+M(this,u,this.calendars[u].year,this.calendars[u].month,this.calendars[0].year,t)+this.render(this.calendars[u].year,this.calendars[u].month,t)+"</div>";this.el.innerHTML=l,n.bound&&"hidden"!==n.field.type&&i((function(){n.trigger.focus()}),1),"function"===typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label",n.ariaLabel)}},adjustPosition:function(){var e,t,n,i,o,s,a,l,h,d,f,g;if(!this._o.container){if(this.el.style.position="absolute",t=e=this._o.trigger,n=this.el.offsetWidth,i=this.el.offsetHeight,o=window.innerWidth||r.documentElement.clientWidth,s=window.innerHeight||r.documentElement.clientHeight,a=window.pageYOffset||r.body.scrollTop||r.documentElement.scrollTop,f=!0,g=!0,"function"===typeof e.getBoundingClientRect)l=(d=e.getBoundingClientRect()).left+window.pageXOffset,h=d.bottom+window.pageYOffset;else for(l=t.offsetLeft,h=t.offsetTop+t.offsetHeight;t=t.offsetParent;)l+=t.offsetLeft,h+=t.offsetTop;(this._o.reposition&&l+n>o||this._o.position.indexOf("right")>-1&&l-n+e.offsetWidth>0)&&(l=l-n+e.offsetWidth,f=!1),(this._o.reposition&&h+i>s+a||this._o.position.indexOf("top")>-1&&h-i-e.offsetHeight>0)&&(h=h-i-e.offsetHeight,g=!1),this.el.style.left=l+"px",this.el.style.top=h+"px",u(this.el,f?"left-aligned":"right-aligned"),u(this.el,g?"bottom-aligned":"top-aligned"),c(this.el,f?"right-aligned":"left-aligned"),c(this.el,g?"top-aligned":"bottom-aligned")}},render:function(e,t,n){var r=this._o,i=new Date,o=m(e,t),s=new Date(e,t,1).getDay(),a=[],l=[];v(i),r.firstDay>0&&(s-=r.firstDay)<0&&(s+=7);for(var u=0===t?11:t-1,c=11===t?0:t+1,h=0===t?e-1:e,g=11===t?e+1:e,y=m(h,u),w=o+s,C=w;C>7;)C-=7;w+=7-C;for(var b=!1,S=0,E=0;S<w;S++){var _=new Date(e,t,S-s+1),O=!!d(this._d)&&p(_,this._d),M=p(_,i),N=-1!==r.events.indexOf(_.toDateString()),I=S<s||S>=o+s,D=S-s+1,H=t,A=e,L=r.startRange&&p(r.startRange,_),P=r.endRange&&p(r.endRange,_),V=r.startRange&&r.endRange&&r.startRange<_&&_<r.endRange;I&&(S<s?(D=y+D,H=u,A=h):(D-=o,H=c,A=g));var W={day:D,month:H,year:A,hasEvent:N,isSelected:O,isToday:M,isDisabled:r.minDate&&_<r.minDate||r.maxDate&&_>r.maxDate||r.disableWeekends&&f(_)||r.disableDayFn&&r.disableDayFn(_),isEmpty:I,isStartRange:L,isEndRange:P,isInRange:V,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&O&&(b=!0),l.push(T(W)),7===++E&&(r.showWeekNumber&&l.unshift(R(S-s,t,e,r.firstWeekOfYearMinDays)),a.push(k(l,r.isRTL,r.pickWholeWeek,b)),l=[],E=0,b=!1)}return x(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),c(this.el,"is-hidden"),this._o.bound&&(o(r,"click",this._onClick),this.adjustPosition()),"function"===typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e=this._v;!1!==e&&(this._o.bound&&s(r,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),u(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"===typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){var e=this._o;this.hide(),s(this.el,"mousedown",this._onMouseDown,!0),s(this.el,"touchend",this._onMouseDown,!0),s(this.el,"change",this._onChange),e.keyboardInput&&s(r,"keydown",this._onKeyChange),e.field&&(s(e.field,"change",this._onInputChange),e.bound&&(s(e.trigger,"click",this._onInputClick),s(e.trigger,"focus",this._onInputFocus),s(e.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},N}(i)}()},7809:function(){},5230:function(e,t,n){"use strict";var r=n(7176),i=n(7798),o=TypeError;e.exports=function(e){if(r(e))return e;throw new o(i(e)+" is not a function")}},2786:function(e,t,n){"use strict";var r=n(903),i=String,o=TypeError;e.exports=function(e){if(r(e))return e;throw new o(i(e)+" is not an object")}},2265:function(e,t,n){"use strict";var r=n(4958),i=n(3742),o=n(1214),s=function(e){return function(t,n,s){var a,l=r(t),u=o(l),c=i(s,u);if(e&&n!==n){for(;u>c;)if((a=l[c++])!==a)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===n)return e||c||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},8009:function(e,t,n){"use strict";var r=n(3322);e.exports=r([].slice)},3318:function(e,t,n){"use strict";var r=n(3322),i=r({}.toString),o=r("".slice);e.exports=function(e){return o(i(e),8,-1)}},3678:function(e,t,n){"use strict";var r=n(6225),i=n(2876),o=n(3718),s=n(1369);e.exports=function(e,t,n){for(var a=i(t),l=s.f,u=o.f,c=0;c<a.length;c++){var h=a[c];r(e,h)||n&&r(n,h)||l(e,h,u(t,h))}}},6958:function(e,t,n){"use strict";var r=n(8307),i=n(1369),o=n(837);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},837:function(e){"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},8825:function(e,t,n){"use strict";var r=n(7176),i=n(1369),o=n(1899),s=n(6478);e.exports=function(e,t,n,a){a||(a={});var l=a.enumerable,u=void 0!==a.name?a.name:t;if(r(n)&&o(n,u,a),a.global)l?e[t]=n:s(t,n);else{try{a.unsafe?e[t]&&(l=!0):delete e[t]}catch(c){}l?e[t]=n:i.f(e,t,{value:n,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return e}},6478:function(e,t,n){"use strict";var r=n(5187),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},8307:function(e,t,n){"use strict";var r=n(2542);e.exports=!r((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},7130:function(e){"use strict";var t="object"==typeof document&&document.all,n="undefined"==typeof t&&void 0!==t;e.exports={all:t,IS_HTMLDDA:n}},6197:function(e,t,n){"use strict";var r=n(5187),i=n(903),o=r.document,s=i(o)&&i(o.createElement);e.exports=function(e){return s?o.createElement(e):{}}},1238:function(e){"use strict";e.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},9328:function(e,t,n){"use strict";var r=n(3727);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},7394:function(e,t,n){"use strict";var r=n(5187),i=n(3318);e.exports="process"===i(r.process)},3727:function(e){"use strict";e.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},1991:function(e,t,n){"use strict";var r,i,o=n(5187),s=n(3727),a=o.process,l=o.Deno,u=a&&a.versions||l&&l.version,c=u&&u.v8;c&&(i=(r=c.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},8587:function(e){"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},5369:function(e,t,n){"use strict";var r=n(5187),i=n(3718).f,o=n(6958),s=n(8825),a=n(6478),l=n(3678),u=n(1103);e.exports=function(e,t){var n,c,h,d,f,g=e.target,m=e.global,v=e.stat;if(n=m?r:v?r[g]||a(g,{}):(r[g]||{}).prototype)for(c in t){if(d=t[c],h=e.dontCallGetSet?(f=i(n,c))&&f.value:n[c],!u(m?c:g+(v?".":"#")+c,e.forced)&&void 0!==h){if(typeof d==typeof h)continue;l(d,h)}(e.sham||h&&h.sham)&&o(d,"sham",!0),s(n,c,d,e)}}},2542:function(e){"use strict";e.exports=function(e){try{return!!e()}catch(t){return!0}}},5042:function(e,t,n){"use strict";var r=n(2085),i=Function.prototype,o=i.apply,s=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?s.bind(o):function(){return s.apply(o,arguments)})},1791:function(e,t,n){"use strict";var r=n(5705),i=n(5230),o=n(2085),s=r(r.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?s(e,t):function(){return e.apply(t,arguments)}}},2085:function(e,t,n){"use strict";var r=n(2542);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},3011:function(e,t,n){"use strict";var r=n(2085),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},6408:function(e,t,n){"use strict";var r=n(8307),i=n(6225),o=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,a=i(o,"name"),l=a&&"something"===function(){}.name,u=a&&(!r||r&&s(o,"name").configurable);e.exports={EXISTS:a,PROPER:l,CONFIGURABLE:u}},5705:function(e,t,n){"use strict";var r=n(3318),i=n(3322);e.exports=function(e){if("Function"===r(e))return i(e)}},3322:function(e,t,n){"use strict";var r=n(2085),i=Function.prototype,o=i.call,s=r&&i.bind.bind(o,o);e.exports=r?s:function(e){return function(){return o.apply(e,arguments)}}},7808:function(e,t,n){"use strict";var r=n(5187),i=n(7176);e.exports=function(e,t){return arguments.length<2?(n=r[e],i(n)?n:void 0):r[e]&&r[e][t];var n}},5377:function(e,t,n){"use strict";var r=n(5230),i=n(4135);e.exports=function(e,t){var n=e[t];return i(n)?void 0:r(n)}},5187:function(e,t,n){"use strict";var r=function(e){return e&&e.Math===Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||this||Function("return this")()},6225:function(e,t,n){"use strict";var r=n(3322),i=n(4656),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},6690:function(e){"use strict";e.exports={}},5767:function(e,t,n){"use strict";var r=n(7808);e.exports=r("document","documentElement")},4570:function(e,t,n){"use strict";var r=n(8307),i=n(2542),o=n(6197);e.exports=!r&&!i((function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},5564:function(e,t,n){"use strict";var r=n(3322),i=n(2542),o=n(3318),s=Object,a=r("".split);e.exports=i((function(){return!s("z").propertyIsEnumerable(0)}))?function(e){return"String"===o(e)?a(e,""):s(e)}:s},6530:function(e,t,n){"use strict";var r=n(3322),i=n(7176),o=n(2879),s=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return s(e)}),e.exports=o.inspectSource},6589:function(e,t,n){"use strict";var r,i,o,s=n(6519),a=n(5187),l=n(903),u=n(6958),c=n(6225),h=n(2879),d=n(1868),f=n(6690),g="Object already initialized",m=a.TypeError,v=a.WeakMap;if(s||h.state){var p=h.state||(h.state=new v);p.get=p.get,p.has=p.has,p.set=p.set,r=function(e,t){if(p.has(e))throw new m(g);return t.facade=e,p.set(e,t),t},i=function(e){return p.get(e)||{}},o=function(e){return p.has(e)}}else{var y=d("state");f[y]=!0,r=function(e,t){if(c(e,y))throw new m(g);return t.facade=e,u(e,y,t),t},i=function(e){return c(e,y)?e[y]:{}},o=function(e){return c(e,y)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!l(t)||(n=i(t)).type!==e)throw new m("Incompatible receiver, "+e+" required");return n}}}},7176:function(e,t,n){"use strict";var r=n(7130),i=r.all;e.exports=r.IS_HTMLDDA?function(e){return"function"==typeof e||e===i}:function(e){return"function"==typeof e}},1103:function(e,t,n){"use strict";var r=n(2542),i=n(7176),o=/#|\.prototype\./,s=function(e,t){var n=l[a(e)];return n===c||n!==u&&(i(t)?r(t):!!t)},a=s.normalize=function(e){return String(e).replace(o,".").toLowerCase()},l=s.data={},u=s.NATIVE="N",c=s.POLYFILL="P";e.exports=s},4135:function(e){"use strict";e.exports=function(e){return null===e||void 0===e}},903:function(e,t,n){"use strict";var r=n(7176),i=n(7130),o=i.all;e.exports=i.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:r(e)||e===o}:function(e){return"object"==typeof e?null!==e:r(e)}},1602:function(e){"use strict";e.exports=!1},7523:function(e,t,n){"use strict";var r=n(7808),i=n(7176),o=n(5119),s=n(7836),a=Object;e.exports=s?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return i(t)&&o(t.prototype,a(e))}},1214:function(e,t,n){"use strict";var r=n(1193);e.exports=function(e){return r(e.length)}},1899:function(e,t,n){"use strict";var r=n(3322),i=n(2542),o=n(7176),s=n(6225),a=n(8307),l=n(6408).CONFIGURABLE,u=n(6530),c=n(6589),h=c.enforce,d=c.get,f=String,g=Object.defineProperty,m=r("".slice),v=r("".replace),p=r([].join),y=a&&!i((function(){return 8!==g((function(){}),"length",{value:8}).length})),w=String(String).split("String"),C=e.exports=function(e,t,n){"Symbol("===m(f(t),0,7)&&(t="["+v(f(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!s(e,"name")||l&&e.name!==t)&&(a?g(e,"name",{value:t,configurable:!0}):e.name=t),y&&n&&s(n,"arity")&&e.length!==n.arity&&g(e,"length",{value:n.arity});try{n&&s(n,"constructor")&&n.constructor?a&&g(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(i){}var r=h(e);return s(r,"source")||(r.source=p(w,"string"==typeof t?t:"")),e};Function.prototype.toString=C((function(){return o(this)&&d(this).source||u(this)}),"toString")},6596:function(e){"use strict";var t=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?n:t)(r)}},1369:function(e,t,n){"use strict";var r=n(8307),i=n(4570),o=n(5915),s=n(2786),a=n(1665),l=TypeError,u=Object.defineProperty,c=Object.getOwnPropertyDescriptor,h="enumerable",d="configurable",f="writable";t.f=r?o?function(e,t,n){if(s(e),t=a(t),s(n),"function"===typeof e&&"prototype"===t&&"value"in n&&f in n&&!n[f]){var r=c(e,t);r&&r[f]&&(e[t]=n.value,n={configurable:d in n?n[d]:r[d],enumerable:h in n?n[h]:r[h],writable:!1})}return u(e,t,n)}:u:function(e,t,n){if(s(e),t=a(t),s(n),i)try{return u(e,t,n)}catch(r){}if("get"in n||"set"in n)throw new l("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},3718:function(e,t,n){"use strict";var r=n(8307),i=n(3011),o=n(3698),s=n(837),a=n(4958),l=n(1665),u=n(6225),c=n(4570),h=Object.getOwnPropertyDescriptor;t.f=r?h:function(e,t){if(e=a(e),t=l(t),c)try{return h(e,t)}catch(n){}if(u(e,t))return s(!i(o.f,e,t),e[t])}},248:function(e,t,n){"use strict";var r=n(7806),i=n(8587).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},2703:function(e,t){"use strict";t.f=Object.getOwnPropertySymbols},5119:function(e,t,n){"use strict";var r=n(3322);e.exports=r({}.isPrototypeOf)},7806:function(e,t,n){"use strict";var r=n(3322),i=n(6225),o=n(4958),s=n(2265).indexOf,a=n(6690),l=r([].push);e.exports=function(e,t){var n,r=o(e),u=0,c=[];for(n in r)!i(a,n)&&i(r,n)&&l(c,n);for(;t.length>u;)i(r,n=t[u++])&&(~s(c,n)||l(c,n));return c}},3698:function(e,t){"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},3737:function(e,t,n){"use strict";var r=n(3011),i=n(7176),o=n(903),s=TypeError;e.exports=function(e,t){var n,a;if("string"===t&&i(n=e.toString)&&!o(a=r(n,e)))return a;if(i(n=e.valueOf)&&!o(a=r(n,e)))return a;if("string"!==t&&i(n=e.toString)&&!o(a=r(n,e)))return a;throw new s("Can't convert object to primitive value")}},2876:function(e,t,n){"use strict";var r=n(7808),i=n(3322),o=n(248),s=n(2703),a=n(2786),l=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(a(e)),n=s.f;return n?l(t,n(e)):t}},3060:function(e,t,n){"use strict";var r=n(4135),i=TypeError;e.exports=function(e){if(r(e))throw new i("Can't call method on "+e);return e}},6321:function(e,t,n){"use strict";var r=n(5187),i=n(5042),o=n(7176),s=n(1238),a=n(3727),l=n(8009),u=n(6268),c=r.Function,h=/MSIE .\./.test(a)||s&&function(){var e=r.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2])}();e.exports=function(e,t){var n=t?2:1;return h?function(r,s){var a=u(arguments.length,1)>n,h=o(r)?r:c(r),d=a?l(arguments,n):[],f=a?function(){i(h,this,d)}:h;return t?e(f,s):e(f)}:e}},1868:function(e,t,n){"use strict";var r=n(2217),i=n(9892),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},2879:function(e,t,n){"use strict";var r=n(5187),i=n(6478),o="__core-js_shared__",s=r[o]||i(o,{});e.exports=s},2217:function(e,t,n){"use strict";var r=n(1602),i=n(2879);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.33.1",mode:r?"pure":"global",copyright:"\xa9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.1/LICENSE",source:"https://github.com/zloirock/core-js"})},6180:function(e,t,n){"use strict";var r=n(1991),i=n(2542),o=n(5187).String;e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol("symbol detection");return!o(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},9489:function(e,t,n){"use strict";var r,i,o,s,a=n(5187),l=n(5042),u=n(1791),c=n(7176),h=n(6225),d=n(2542),f=n(5767),g=n(8009),m=n(6197),v=n(6268),p=n(9328),y=n(7394),w=a.setImmediate,C=a.clearImmediate,b=a.process,S=a.Dispatch,T=a.Function,E=a.MessageChannel,R=a.String,k=0,_={},O="onreadystatechange";d((function(){r=a.location}));var M=function(e){if(h(_,e)){var t=_[e];delete _[e],t()}},x=function(e){return function(){M(e)}},N=function(e){M(e.data)},I=function(e){a.postMessage(R(e),r.protocol+"//"+r.host)};w&&C||(w=function(e){v(arguments.length,1);var t=c(e)?e:T(e),n=g(arguments,1);return _[++k]=function(){l(t,void 0,n)},i(k),k},C=function(e){delete _[e]},y?i=function(e){b.nextTick(x(e))}:S&&S.now?i=function(e){S.now(x(e))}:E&&!p?(s=(o=new E).port2,o.port1.onmessage=N,i=u(s.postMessage,s)):a.addEventListener&&c(a.postMessage)&&!a.importScripts&&r&&"file:"!==r.protocol&&!d(I)?(i=I,a.addEventListener("message",N,!1)):i=O in m("script")?function(e){f.appendChild(m("script"))[O]=function(){f.removeChild(this),M(e)}}:function(e){setTimeout(x(e),0)}),e.exports={set:w,clear:C}},3742:function(e,t,n){"use strict";var r=n(1305),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},4958:function(e,t,n){"use strict";var r=n(5564),i=n(3060);e.exports=function(e){return r(i(e))}},1305:function(e,t,n){"use strict";var r=n(6596);e.exports=function(e){var t=+e;return t!==t||0===t?0:r(t)}},1193:function(e,t,n){"use strict";var r=n(1305),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},4656:function(e,t,n){"use strict";var r=n(3060),i=Object;e.exports=function(e){return i(r(e))}},4993:function(e,t,n){"use strict";var r=n(3011),i=n(903),o=n(7523),s=n(5377),a=n(3737),l=n(2899),u=TypeError,c=l("toPrimitive");e.exports=function(e,t){if(!i(e)||o(e))return e;var n,l=s(e,c);if(l){if(void 0===t&&(t="default"),n=r(l,e,t),!i(n)||o(n))return n;throw new u("Can't convert object to primitive value")}return void 0===t&&(t="number"),a(e,t)}},1665:function(e,t,n){"use strict";var r=n(4993),i=n(7523);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},7798:function(e){"use strict";var t=String;e.exports=function(e){try{return t(e)}catch(n){return"Object"}}},9892:function(e,t,n){"use strict";var r=n(3322),i=0,o=Math.random(),s=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+s(++i+o,36)}},7836:function(e,t,n){"use strict";var r=n(6180);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},5915:function(e,t,n){"use strict";var r=n(8307),i=n(2542);e.exports=r&&i((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},6268:function(e){"use strict";var t=TypeError;e.exports=function(e,n){if(e<n)throw new t("Not enough arguments");return e}},6519:function(e,t,n){"use strict";var r=n(5187),i=n(7176),o=r.WeakMap;e.exports=i(o)&&/native code/.test(String(o))},2899:function(e,t,n){"use strict";var r=n(5187),i=n(2217),o=n(6225),s=n(9892),a=n(6180),l=n(7836),u=r.Symbol,c=i("wks"),h=l?u.for||u:u&&u.withoutSetter||s;e.exports=function(e){return o(c,e)||(c[e]=a&&o(u,e)?u[e]:h("Symbol."+e)),c[e]}},3725:function(e,t,n){"use strict";var r=n(5369),i=n(5187),o=n(9489).clear;r({global:!0,bind:!0,enumerable:!0,forced:i.clearImmediate!==o},{clearImmediate:o})},1195:function(e,t,n){"use strict";n(3725),n(3690)},3690:function(e,t,n){"use strict";var r=n(5369),i=n(5187),o=n(9489).set,s=n(6321),a=i.setImmediate?s(o,!1):o;r({global:!0,bind:!0,enumerable:!0,forced:i.setImmediate!==a},{setImmediate:a})},168:function(e,t,n){"use strict";function r(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}n.d(t,{Z:function(){return r}})},6154:function(e,t,n){"use strict";n.d(t,{sZ:function(){return Po}});var r=n(2791),i=n(4164),o=n(9439),s=n(3433),a=(n(1195),n(8492)),l=n(7993),u=n(7117),c=n(2486),h=n(1643),d=n(3713),f=n(4170),g=n(2063),m=n(6660),v=n(3914),p=n(7872),y=n(4699),w=n(9115),C=n(4638),b=n(9373),S=n(5671),T=n(3144),E=n(1528),R=n(7326),k=n(136),_=n(7277);var O,M=new WeakMap,x=function(){function e(t,n,r,i,o,s){(0,S.Z)(this,e);var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.wtSettings=r,this.domBindings=n,this.wtTable=o,this.selections=s,this.parent=a,this.eventManager=i,this.facadeGetter=t,M.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}return(0,T.Z)(e,[{key:"registerEvents",value:function(){var e=this;this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",(function(t){return e.onContextMenu(t)})),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",(function(t){return e.onMouseOver(t)})),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",(function(t){return e.onMouseOut(t)}));var t=function(){e.eventManager.addEventListener(e.wtTable.holder,"touchstart",(function(t){return e.onTouchStart(t)})),e.eventManager.addEventListener(e.wtTable.holder,"touchend",(function(t){return e.onTouchEnd(t)})),e.momentumScrolling||(e.momentumScrolling={}),e.eventManager.addEventListener(e.wtTable.holder,"scroll",(function(){clearTimeout(e.momentumScrolling._timeout),e.momentumScrolling.ongoing||e.wtSettings.getSetting("onBeforeTouchScroll"),e.momentumScrolling.ongoing=!0,e.momentumScrolling._timeout=setTimeout((function(){e.touchApplied||(e.momentumScrolling.ongoing=!1,e.wtSettings.getSetting("onAfterMomentumScroll"))}),200)}))};(0,c.K1)()?t():("ontouchstart"in window&&t(),e.eventManager.addEventListener(e.wtTable.holder,"mouseup",(function(t){return e.onMouseUp(t)})),e.eventManager.addEventListener(e.wtTable.holder,"mousedown",(function(t){return e.onMouseDown(t)})))}},{key:"selectedCellWasTouched",value:function(e){var t=M.get(this),n=this.parentCell(e).coords;if(t.selectedCellBeforeTouchEnd&&n){var r=[n.row,t.selectedCellBeforeTouchEnd.from.row],i=r[0],o=r[1],s=[n.col,t.selectedCellBeforeTouchEnd.from.col];return i===o&&s[0]===s[1]}return!1}},{key:"parentCell",value:function(e){var t={},n=this.wtTable.TABLE,r=(0,a.W6)(e,["TD","TH"],n);return r?(t.coords=this.wtTable.getCoords(r),t.TD=r):(0,a.pv)(e,"wtBorder")&&(0,a.pv)(e,"current")?(t.coords=this.selections.getCell().cellRange.highlight,t.TD=this.wtTable.getCell(t.coords)):(0,a.pv)(e,"wtBorder")&&(0,a.pv)(e,"area")&&this.selections.createOrGetArea().cellRange&&(t.coords=this.selections.createOrGetArea().cellRange.to,t.TD=this.wtTable.getCell(t.coords)),t}},{key:"onMouseDown",value:function(e){var t=M.get(this),n=this.domBindings.rootDocument.activeElement,r=(0,l.r$)(a.G_,e.target),i=e.target;if(i!==n&&r(0)!==n&&r(1)!==n){var o=this.parentCell(i);(0,a.pv)(i,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",e,i):o.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(0===e.button||this.touchApplied)&&o.TD&&(t.dblClickOrigin[0]=o.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout((function(){t.dblClickOrigin[0]=null}),1e3))}}},{key:"onContextMenu",value:function(e){if(this.wtSettings.has("onCellContextMenu")){var t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}},{key:"onMouseOver",value:function(e){if(this.wtSettings.has("onCellMouseOver")){var t=this.wtTable.TABLE,n=(0,a.W6)(e.target,["TD","TH"],t),r=this.parent||this;n&&n!==r.lastMouseOver&&(0,a.MO)(n,t)&&(r.lastMouseOver=n,this.callListener("onCellMouseOver",e,this.wtTable.getCoords(n),n))}}},{key:"onMouseOut",value:function(e){if(this.wtSettings.has("onCellMouseOut")){var t=this.wtTable.TABLE,n=(0,a.W6)(e.target,["TD","TH"],t),r=(0,a.W6)(e.relatedTarget,["TD","TH"],t),i=this.parent||this;n&&n!==r&&(0,a.MO)(n,t)&&(this.callListener("onCellMouseOut",e,this.wtTable.getCoords(n),n),null===r&&(i.lastMouseOver=null))}}},{key:"onMouseUp",value:function(e){var t=M.get(this),n=this.parentCell(e.target);n.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),(0===e.button||this.touchApplied)&&(n.TD===t.dblClickOrigin[0]&&n.TD===t.dblClickOrigin[1]?((0,a.pv)(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),t.dblClickOrigin[0]=null,t.dblClickOrigin[1]=null):n.TD===t.dblClickOrigin[0]&&(t.dblClickOrigin[1]=n.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout((function(){t.dblClickOrigin[1]=null}),500)))}},{key:"onTouchStart",value:function(e){M.get(this).selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(e)}},{key:"onTouchEnd",value:function(e){var t,n=e.target,r=null===(t=this.parentCell(n))||void 0===t?void 0:t.coords,i=(0,u.$K)(r)&&r.row>=0&&r.col>=0;if(e.cancelable&&i&&this.wtSettings.getSetting("isDataViewInstance")){(0,c.gn)()&&((0,c.E6)()||(0,c.iF)())&&this.selectedCellWasTouched(n)&&!["A","BUTTON","INPUT"].includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}},{key:"callListener",value:function(e,t,n,r){var i=this.wtSettings.getSettingPure(e);i&&i(t,n,r,this.facadeGetter())}},{key:"destroy",value:function(){var e=M.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}}]),e}(),N=x,I=n(5647),D=n(5941),H=function(){function e(t,n,r){(0,S.Z)(this,e),this.offset=t,this.total=n,this.countTH=r}return(0,T.Z)(e,[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}]),e}(),A=function(){function e(t,n,r){(0,S.Z)(this,e),this.offset=t,this.total=n,this.countTH=r}return(0,T.Z)(e,[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceRowToVisibleColHeadedRow",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}]),e}(),L=function(){function e(){(0,S.Z)(this,e),this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}return(0,T.Z)(e,[{key:"setSize",value:function(e){this.currentSize=this.nextSize,this.nextSize=e}},{key:"setOffset",value:function(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}]),e}(),P=function(){function e(){(0,S.Z)(this,e),this.size=new L,this.workingSpace=0,this.sharedSize=null}return(0,T.Z)(e,[{key:"setSize",value:function(e){this.size.setSize(e)}},{key:"setOffset",value:function(e){this.size.setOffset(e)}},{key:"getViewSize",value:function(){return this.size}},{key:"isShared",value:function(){return this.sharedSize instanceof L}},{key:"isPlaceOn",value:function(e){return this.workingSpace===e}},{key:"append",value:function(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}},{key:"prepend",value:function(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}]),e}(),V=function(){function e(t,n,r){(0,S.Z)(this,e),this.rootNode=t,this.nodesPool=n,this.sizeSet=new P,this.childNodeType=r.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}return(0,T.Z)(e,[{key:"setSize",value:function(e){return this.sizeSet.setSize(e),this}},{key:"setOffset",value:function(e){return this.sizeSet.setOffset(e),this}},{key:"isSharedViewSet",value:function(){return this.sizeSet.isShared()}},{key:"getNode",value:function(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}},{key:"getCurrentNode",value:function(){var e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}},{key:"getRenderedChildCount",value:function(){var e=this.rootNode,t=this.sizeSet,n=0;if(this.isSharedViewSet())for(var r=e.firstElementChild;r;){if(r.tagName===this.childNodeType)n+=1;else if(t.isPlaceOn(1))break;r=r.nextElementSibling}else n=e.childElementCount;return n}},{key:"start",value:function(){this.collectedNodes.length=0,this.visualIndex=0;for(var e=this.rootNode,t=this.sizeSet,n=this.isSharedViewSet(),r=t.getViewSize().nextSize,i=this.getRenderedChildCount();i<r;){var o=this.nodesPool();!n||n&&t.isPlaceOn(2)?e.appendChild(o):e.insertBefore(o,e.firstChild),i+=1}for(var s=n&&t.isPlaceOn(1);i>r;)e.removeChild(s?e.firstChild:e.lastChild),i-=1}},{key:"render",value:function(){var e=this.rootNode,t=this.sizeSet,n=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(2)&&(n+=t.sharedSize.nextSize);var r=e.childNodes[n];if(r.tagName!==this.childNodeType){var i=this.nodesPool();e.replaceChild(i,r),r=i}this.collectedNodes.push(r),this.visualIndex+=1}},{key:"end",value:function(){}}]),e}(),W=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(){return(0,S.Z)(this,n),t.apply(this,arguments)}return(0,T.Z)(n,[{key:"prependView",value:function(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}},{key:"appendView",value:function(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}]),n}(V),F=function(){function e(t){(0,S.Z)(this,e),this.nodeType=t.toUpperCase()}return(0,T.Z)(e,[{key:"setRootDocument",value:function(e){this.rootDocument=e}},{key:"obtain",value:function(){return this.rootDocument.createElement(this.nodeType)}}]),e}(),B=function(){function e(t,n){(0,S.Z)(this,e),this.nodesPool="string"===typeof t?new F(t):null,this.nodeType=t,this.rootNode=n,this.table=null,this.renderedNodes=0}return(0,T.Z)(e,[{key:"setTable",value:function(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}},{key:"adjust",value:function(){}},{key:"render",value:function(){}}]),e}(),Z=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(){var e;return(0,S.Z)(this,n),(e=t.call(this,"TH")).orderViews=new WeakMap,e.sourceRowIndex=0,e}return(0,T.Z)(n,[{key:"obtainOrderView",value:function(e){var t,n=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new W(e,(function(e){return n.nodesPool.obtain(n.sourceRowIndex,e)}),this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,n=e.rowHeaderFunctions,r=e.rowHeadersCount,i=e.rows,o=e.cells,s=0;s<t;s++){var a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;var u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(var h=0;h<r;h++){u.render();var d=u.getCurrentNode();d.className="",d.removeAttribute("style"),n[h](a,d,h)}u.end()}}}]),n}(B),j=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(e){return(0,S.Z)(this,n),t.call(this,null,e)}return(0,T.Z)(n,[{key:"adjust",value:function(){var e=this.table,t=e.columnHeadersCount,n=e.rowHeadersCount,r=this.rootNode.firstChild;if(t){for(var i=this.table.columnsToRender+n,o=0,s=t;o<s;o++){for((r=this.rootNode.childNodes[o])||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<i;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)r.removeChild(r.lastChild),this.renderedNodes-=1}var l=this.rootNode.childNodes.length;if(l>t)for(var u=t;u<l;u++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&(0,a.cS)(r)}},{key:"render",value:function(){for(var e=this.table.columnHeadersCount,t=0;t<e;t+=1)for(var n=this.table,r=n.columnHeaderFunctions,i=n.columnsToRender,o=n.rowHeadersCount,s=this.rootNode.childNodes[t],a=-1*o;a<i;a+=1){var l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),r[t](l,u,t)}}}]),n}(B),U=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(e){return(0,S.Z)(this,n),t.call(this,null,e)}return(0,T.Z)(n,[{key:"adjust",value:function(){for(var e=this.table,t=e.columnsToRender+e.rowHeadersCount;this.renderedNodes<t;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>t;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}},{key:"render",value:function(){this.adjust();for(var e=this.table,t=e.columnsToRender,n=e.rowHeadersCount,r=0;r<n;r++){var i=this.table.renderedColumnToSource(r),o=this.table.columnUtils.getHeaderWidth(i);this.rootNode.childNodes[r].style.width="".concat(o,"px")}for(var s=0;s<t;s++){var l=this.table.renderedColumnToSource(s),u=this.table.columnUtils.getStretchedColumnWidth(l);this.rootNode.childNodes[s+n].style.width="".concat(u,"px")}var c=this.rootNode.firstChild;c&&(0,a.cn)(c,"rowHeader")}}]),n}(B),Y=n(168),z=n(1734),G=n(2933),X=!1,K=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(e){var r;return(0,S.Z)(this,n),(r=t.call(this,"TR",e)).orderView=new V(e,(function(e){return r.nodesPool.obtain(e)}),r.nodeType),r}return(0,T.Z)(n,[{key:"getRenderedNode",value:function(e){return this.orderView.getNode(e)}},{key:"render",value:function(){var e=this.table.rowsToRender;!X&&e>1e3&&(X=!0,(0,z.ZK)((0,G.e)(O||(O=(0,Y.Z)(['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting \n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.'],['Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\\x20\n        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.']))))),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(var t=0;t<e;t++)this.orderView.render();this.orderView.end()}}]),n}(B),q=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(){var e;return(0,S.Z)(this,n),(e=t.call(this,"TD")).orderViews=new WeakMap,e.sourceRowIndex=0,e}return(0,T.Z)(n,[{key:"obtainOrderView",value:function(e){var t,n=this;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new W(e,(function(e){return n.nodesPool.obtain(n.sourceRowIndex,e)}),this.nodeType),this.orderViews.set(e,t)),t}},{key:"render",value:function(){for(var e=this.table,t=e.rowsToRender,n=e.columnsToRender,r=e.rows,i=e.rowHeaders,o=0;o<t;o++){var s=this.table.renderedRowToSource(o),l=r.getRenderedNode(o);this.sourceRowIndex=s;var u=this.obtainOrderView(l),c=i.obtainOrderView(l);u.prependView(c).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(var h=0;h<n;h++){u.render();var d=u.getCurrentNode(),f=this.table.renderedColumnToSource(h);(0,a.pv)(d,"hide")||(d.className=""),d.removeAttribute("style"),d.removeAttribute("dir"),this.table.cellRenderer(s,f,d)}u.end()}}}]),n}(B),$=function(){function e(t){(0,S.Z)(this,e);var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).cellRenderer;this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=n}return(0,T.Z)(e,[{key:"setAxisUtils",value:function(e,t){this.rowUtils=e,this.columnUtils=t}},{key:"setViewportSize",value:function(e,t){this.rowsToRender=e,this.columnsToRender=t}},{key:"setFilters",value:function(e,t){this.rowFilter=e,this.columnFilter=t}},{key:"setHeaderContentRenderers",value:function(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}},{key:"setRenderers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.rowHeaders,n=e.columnHeaders,r=e.colGroup,i=e.rows,o=e.cells;t.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=t,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}},{key:"renderedRowToSource",value:function(e){return this.rowFilter.renderedToSource(e)}},{key:"renderedColumnToSource",value:function(e){return this.columnFilter.renderedToSource(e)}},{key:"render",value:function(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();for(var e=this.rowsToRender,t=this.rows,n=0;n<e;n++){var r=t.getRenderedNode(n);if(r.firstChild){var i=this.renderedRowToSource(n),o=this.rowUtils.getHeight(i);r.firstChild.style.height=o?"".concat(o-1,"px"):""}}}}]),e}(),Q=function(){function e(){(0,S.Z)(this,e);var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.TABLE,r=t.THEAD,i=t.COLGROUP,o=t.TBODY,s=t.rowUtils,a=t.columnUtils,l=t.cellRenderer;this.renderer=new $(n,{cellRenderer:l}),this.renderer.setRenderers({rowHeaders:new Z,columnHeaders:new j(r),colGroup:new U(i),rows:new K(o),cells:new q}),this.renderer.setAxisUtils(s,a)}return(0,T.Z)(e,[{key:"setFilters",value:function(e,t){return this.renderer.setFilters(e,t),this}},{key:"setViewportSize",value:function(e,t){return this.renderer.setViewportSize(e,t),this}},{key:"setHeaderContentRenderers",value:function(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}},{key:"adjust",value:function(){this.renderer.adjust()}},{key:"render",value:function(){this.renderer.render()}}]),e}(),J=function(){function e(t,n){(0,S.Z)(this,e),this.dataAccessObject=t,this.wtSettings=n,this.headerWidths=new Map}return(0,T.Z)(e,[{key:"getWidth",value:function(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}},{key:"getStretchedColumnWidth",value:function(e){var t=this.dataAccessObject.wtViewport.columnsRenderCalculator,n=this.getWidth(e);if(t){var r=t.getStretchedColumnWidth(e,n);r&&(n=r)}return n}},{key:"getHeaderHeight",value:function(e){var t=this.wtSettings.getSetting("defaultRowHeight"),n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t}},{key:"getHeaderWidth",value:function(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}},{key:"calculateWidths",value:function(){var e=this.wtSettings,t=this.dataAccessObject,n=t.wtTable,r=t.wtViewport,i=t.cloneSource,o=i?i.wtTable.holder:n.holder,s=o.offsetHeight<o.scrollHeight?(0,a.np)():0,l=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-s),null!==(l=e.getSetting("onModifyRowHeaderWidth",l))&&void 0!==l)for(var u=e.getSetting("rowHeaders").length,c=e.getSetting("defaultColumnWidth"),h=0;h<u;h++){var d=Array.isArray(l)?l[h]:l;d=null===d||void 0===d?c:d,this.headerWidths.set(h,d)}}}]),e}(),ee=function(){function e(t,n){(0,S.Z)(this,e),this.dataAccessObject=t,this.wtSettings=n}return(0,T.Z)(e,[{key:"getHeight",value:function(e){var t=this.wtSettings.getSetting("rowHeight",e),n=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==n&&(t=void 0===t?n:Math.max(t,n)),t}}]),e}(),te="top",ne="bottom",re="inline_start",ie="top_inline_start_corner",oe="bottom_inline_start_corner",se=[te,ne,re,ie,oe],ae=new Map([[te,"ht_clone_".concat(te)],[ne,"ht_clone_".concat(ne)],[re,"ht_clone_".concat(re," ht_clone_left")],[ie,"ht_clone_".concat(ie," ht_clone_top_left_corner")],[oe,"ht_clone_".concat(oe," ht_clone_bottom_left_corner")]]);function le(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ue=function(){function e(t,n,r,i,o){var s=this;(0,S.Z)(this,e),le(this,"wtSettings",null),le(this,"domBindings",void 0),le(this,"TBODY",null),le(this,"THEAD",null),le(this,"COLGROUP",null),le(this,"hasTableHeight",!0),le(this,"hasTableWidth",!0),le(this,"isTableVisible",!1),le(this,"tableOffset",0),le(this,"holderOffset",0),this.domBindings=r,this.isMaster="master"===o,this.name=o,this.dataAccessObject=t,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,(0,a.Wu)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var l=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(function(){return s._modifyRowHeaderWidth(l)})),this.rowUtils=new ee(this.dataAccessObject,this.wtSettings),this.columnUtils=new J(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Q({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}return(0,T.Z)(e,[{key:"is",value:function(e){return this.name===e}},{key:"fixTableDomTree",value:function(){var e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}},{key:"createSpreader",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&(0,a.pv)(n,"wtHolder")||((t=this.domBindings.rootDocument.createElement("div")).className="wtSpreader",n&&n.insertBefore(t,e),t.appendChild(e)),t.style.position="relative",t}},{key:"createHider",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&(0,a.pv)(n,"wtHolder")||((t=this.domBindings.rootDocument.createElement("div")).className="wtHider",n&&n.insertBefore(t,e),t.appendChild(e)),t}},{key:"createHolder",value:function(e){var t,n=e.parentNode;return n&&n.nodeType===Node.ELEMENT_NODE&&(0,a.pv)(n,"wtHolder")||((t=this.domBindings.rootDocument.createElement("div")).style.position="relative",t.className="wtHolder",n&&n.insertBefore(t,e),this.isMaster&&(t.parentNode.className+="ht_master handsontable",t.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),t.appendChild(e)),t}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wtSettings,n=this.dataAccessObject,r=n.wtOverlays,i=n.wtViewport,o=t.getSetting("totalRows"),s=t.getSetting("totalColumns"),l=t.getSetting("rowHeaders"),u=l.length,c=t.getSetting("columnHeaders"),h=c.length,d=!1,f=e;if(this.isMaster&&(this.holderOffset=(0,a.cv)(this.holder),f=i.createRenderCalculators(f),u&&!t.getSetting("fixedColumnsStart"))){var g=r.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=0!==g,m!==this.correctHeaderWidth&&(f=!1)}if(this.isMaster&&(d=r.updateStateOfRendering()),f)this.isMaster&&i.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=(0,a.cv)(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;var v=o>0?this.getFirstRenderedRow():0,p=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new A(v,o,h),this.columnFilter=new H(p,s,u);var y,w=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();var C={};this.wtSettings.getSetting("beforeDraw",!0,C),w=!0!==C.skipRender}if(w)if(this.tableRenderer.setHeaderContentRenderers(l,c),(this.is(ne)||this.is(oe))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(y=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(ne))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();var b=(0,a.iO)(this.hider),S=(0,a.iO)(this.TABLE);0!==b&&S!==b&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),y!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(ne)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}var T=!1;return this.isMaster&&(T=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(T=r.bottomOverlay.resetFixedPosition()||T),T=r.inlineStartOverlay.resetFixedPosition()||T,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),T?(r.refreshAll(),r.adjustElementsSize()):this.refreshSelections(f),d&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}},{key:"markIfOversizedColumnHeader",value:function(e){for(var t,n,r,i=this.columnFilter.renderedToSource(e),o=this.wtSettings.getSetting("columnHeaders").length,s=this.wtSettings.getSetting("defaultRowHeight"),l=this.wtSettings.getSetting("columnHeaderHeight")||[];o;)o-=1,t=this.getColumnHeaderHeight(o),(n=this.getColumnHeader(i,o))&&(r=(0,a.WS)(n),(!t&&s<r||t<r)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=r),Array.isArray(l)?null!==l[o]&&void 0!==l[o]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l[o]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]<(l[o]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[o]=l[o]||l))}},{key:"adjustColumnHeaderHeights",value:function(){for(var e=this.wtSettings,t=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=0,i=e.getSetting("columnHeaders").length;r<i;r++)if(n[r]){if(!t[r]||0===t[r].childNodes.length)return;t[r].childNodes[0].style.height="".concat(n[r],"px")}}},{key:"resetOversizedRows",value:function(){var e=this.wtSettings,t=this.dataAccessObject.wtViewport;if((this.isMaster||this.is(ne))&&!e.getSetting("externalRowCalculator"))for(var n=this.getRenderedRowsCount(),r=0;r<n;r++){var i=this.rowFilter.renderedToSource(r);t.oversizedRows&&t.oversizedRows[i]&&(t.oversizedRows[i]=void 0)}}},{key:"removeClassFromCells",value:function(e){for(var t=this.TABLE.querySelectorAll(".".concat(e)),n=0,r=t.length;n<r;n++)(0,a.IV)(t[n],e)}},{key:"refreshSelections",value:function(e){var t=this.wtSettings,n=this.dataAccessObject.selections;if(n){var r=Array.from(n),i=r.length;if(e){for(var o=[],s=0;s<i;s++){for(var a=r[s].settings,l=a.highlightHeaderClassName,u=a.highlightRowClassName,c=a.highlightColumnClassName,h=r[s].classNames,d=h.length,f=0;f<d;f++)o.includes(h[f])||o.push(h[f]);l&&!o.includes(l)&&o.push(l),u&&!o.includes(u)&&o.push(u),c&&!o.includes(c)&&o.push(c)}var g=t.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(g))for(var m=0;m<g.length;m++)o.push(g[m]);for(var v=o.length,p=0;p<v;p++)this.removeClassFromCells(o[p])}for(var y=0;y<i;y++)r[y].draw(this.facadeGetter(),e)}}},{key:"getCell",value:function(e){var t=e.row,n=e.col,r=this.wtSettings.getSetting("onModifyGetCellCoords",t,n);if(r&&Array.isArray(r)){var i=(0,o.Z)(r,2);t=i[0],n=i[1]}if(this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;var s=this.getRow(t);if(!s&&t>=0)throw new Error("TR was expected to be rendered but is not");var a=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!a&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return a}},{key:"getRow",value:function(e){var t,n,r=null,i=null;e<0?(r=null===(t=this.rowFilter)||void 0===t?void 0:t.sourceRowToVisibleColHeadedRow(e),i=this.THEAD):(r=null===(n=this.rowFilter)||void 0===n?void 0:n.sourceToRendered(e),i=this.TBODY);return void 0!==r&&void 0!==i&&(!(i.childNodes.length<r+1)&&i.childNodes[r])}},{key:"getColumnHeader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.THEAD.childNodes[t];return null===n||void 0===n?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}},{key:"getColumnHeaders",value:function(e){var t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach((function(e){var r=e.childNodes[n];r&&t.push(r)})),t}},{key:"getRowHeader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0!==this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)&&!(t>=this.wtSettings.getSetting("rowHeaders").length)){var n=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return null===n||void 0===n?void 0:n.childNodes[t]}}},{key:"getRowHeaders",value:function(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return[];for(var t=[],n=this.wtSettings.getSetting("rowHeaders").length,r=0;r<n;r++){var i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=null===i||void 0===i?void 0:i.childNodes[r];o&&t.push(o)}return t}},{key:"getCoords",value:function(e){var t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=(0,a.oq)(t,["TD","TH"])),null===t)return null;var n=t.parentNode,r=n.parentNode,i=(0,a.Kz)(n),o=t.cellIndex;if((0,a.mK)(ie,t,this.wtRootElement)||(0,a.mK)(te,t,this.wtRootElement))"THEAD"===r.nodeName&&(i-=r.childNodes.length);else if((0,a.mK)(oe,t,this.wtRootElement)||(0,a.mK)(ne,t,this.wtRootElement)){i=this.wtSettings.getSetting("totalRows")-r.childNodes.length+i}else i=r===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter.renderedToSource(i);return o=(0,a.mK)(ie,t,this.wtRootElement)||(0,a.mK)(re,t,this.wtRootElement)||(0,a.mK)(oe,t,this.wtRootElement)?this.columnFilter.offsettedTH(o):this.columnFilter.visibleRowHeadedColumnToSourceColumn(o),this.wot.createCellCoords(i,o)}},{key:"markOversizedRows",value:function(){if(!this.wtSettings.getSetting("externalRowCalculator")){var e,t,n,r,i,o=this.TBODY.childNodes.length;if(o*this.wtSettings.getSetting("defaultRowHeight")!==(0,a.WS)(this.TBODY)-1||this.wtSettings.getSetting("fixedRowsBottom"))for(;o;)o-=1,n=this.rowFilter.renderedToSource(o),e=this.getRowHeight(n),t=(i=(r=this.getTrForRow(n)).querySelector("th"))?(0,a.WS)(i):(0,a.WS)(r)-1,(!e&&this.wtSettings.getSetting("defaultRowHeight")<t||e<t)&&(t+=1,this.dataAccessObject.wtViewport.oversizedRows[n]=t)}}},{key:"getTrForRow",value:function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}},{key:"isColumnHeaderRendered",value:function(e){if(e>=0)return!1;var t=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=t}},{key:"isRowHeaderRendered",value:function(e){if(e>=0)return!1;var t=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=t}},{key:"isRowBeforeRenderedRows",value:function(e){var t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}},{key:"isRowAfterRenderedRows",value:function(e){return e>this.getLastRenderedRow()}},{key:"isColumnBeforeRenderedColumns",value:function(e){var t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}},{key:"isColumnAfterRenderedColumns",value:function(e){return this.columnFilter&&e>this.getLastRenderedColumn()}},{key:"isColumnAfterViewport",value:function(e){return this.columnFilter&&e>this.getLastVisibleColumn()}},{key:"isRowAfterViewport",value:function(e){return this.rowFilter&&e>this.getLastVisibleRow()}},{key:"isColumnBeforeViewport",value:function(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"allRowsInViewport",value:function(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}},{key:"allColumnsInViewport",value:function(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}},{key:"getRowHeight",value:function(e){return this.rowUtils.getHeight(e)}},{key:"getColumnHeaderHeight",value:function(e){return this.columnUtils.getHeaderHeight(e)}},{key:"getColumnWidth",value:function(e){return this.columnUtils.getWidth(e)}},{key:"getStretchedColumnWidth",value:function(e){return this.columnUtils.getStretchedColumnWidth(e)}},{key:"hasDefinedSize",value:function(){return this.hasTableHeight&&this.hasTableWidth}},{key:"getWidth",value:function(){return(0,a.iO)(this.TABLE)}},{key:"getHeight",value:function(){return(0,a.Pb)(this.TABLE)}},{key:"getTotalWidth",value:function(){var e=(0,a.iO)(this.hider);return 0!==e?e:this.getWidth()}},{key:"getTotalHeight",value:function(){var e=(0,a.Pb)(this.hider);return 0!==e?e:this.getHeight()}},{key:"isVisible",value:function(){return(0,a.pn)(this.TABLE)}},{key:"_modifyRowHeaderWidth",value:function(e){var t=(0,l.mf)(e)?e():null;return Array.isArray(t)?(t=(0,s.Z)(t))[t.length-1]=this._correctRowHeaderWidth(t[t.length-1]):t=this._correctRowHeaderWidth(t),t}},{key:"_correctRowHeaderWidth",value:function(e){var t=e;return"number"!==typeof e&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}]),e}(),ce=ue,he={getFirstRenderedRow:function(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.getRenderedRowsCount()-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};(0,f.jW)(he,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});var de=he,fe={getFirstRenderedColumn:function(){var e=this.dataAccessObject.startColumnRendered;return null===e?-1:e},getFirstVisibleColumn:function(){var e=this.dataAccessObject.startColumnVisible;return null===e?-1:e},getLastRenderedColumn:function(){var e=this.dataAccessObject.endColumnRendered;return null===e?-1:e},getLastVisibleColumn:function(){var e=this.dataAccessObject.endColumnVisible;return null===e?-1:e},getRenderedColumnsCount:function(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount:function(){return this.dataAccessObject.countColumnsVisible}};(0,f.jW)(fe,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});var ge=fe,me=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(e,r,i,o){return(0,S.Z)(this,n),t.call(this,e,r,i,o,te)}return(0,T.Z)(n)}(ce);(0,f.jB)(me,de),(0,f.jB)(me,ge);var ve=me;function pe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ye=function(){function e(t){(0,S.Z)(this,e),pe(this,"dataAccessObject",void 0),pe(this,"lastScrolledColumnPos",-1),pe(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}return(0,T.Z)(e,[{key:"scrollViewport",value:function(e,t,n,r,i){var o=this.scrollViewportHorizontally(e.col,n,i),s=this.scrollViewportVertically(e.row,t,r);return o||s}},{key:"scrollViewportHorizontally",value:function(e,t,n){var r=this.dataAccessObject,i=r.drawn,o=r.totalColumns;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;var s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=void 0===t&&void 0===n,u=this.dataAccessObject,c=u.fixedColumnsStart,h=u.inlineStartOverlay;if(l&&e<c)return!1;var d=!1;return-1===s?d=h.scrollTo(e,l?e>this.lastScrolledColumnPos:t):(l&&(e<s||e>a)||!l)&&(d=h.scrollTo(e,l?e>a:t)),d&&(this.lastScrolledColumnPos=e),d}},{key:"scrollViewportVertically",value:function(e,t,n){var r=this.dataAccessObject,i=r.drawn,o=r.totalRows;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;var s=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=void 0===t&&void 0===n,u=this.dataAccessObject,c=u.fixedRowsBottom,h=u.fixedRowsTop,d=u.topOverlay;if(l&&(e<h||e>o-c-1))return!1;var f=!1;return-1===s?f=d.scrollTo(e,l?e>this.lastScrolledRowPos:n):(l&&(e<s||e>a)||!l)&&(f=d.scrollTo(e,l?e>a:n)),f&&(this.lastScrolledRowPos=e),f}},{key:"getFirstVisibleRow",value:function(){var e=this.dataAccessObject,t=e.topOverlay,n=e.wtTable,r=e.wtViewport,i=e.totalRows,o=e.fixedRowsTop,s=e.rootWindow,l=n.getFirstVisibleRow();if(t.mainTableScrollableElement===s){var u=(0,a.cv)(n.wtRootElement),c=(0,a.WS)(n.hider),h=(0,a.WS)(s),d=(0,a.cx)(s,s);if(u.top+c-h<=d){var f=r.getColumnHeaderHeight();f+=t.sumCellSizes(0,o);for(var g=i;g>0;g--)if(f+=t.sumCellSizes(g-1,g),u.top+c-f<=d){l=g;break}}}return l}},{key:"getLastVisibleRow",value:function(){var e=this.dataAccessObject,t=e.topOverlay,n=e.wtTable,r=e.wtViewport,i=e.totalRows,o=e.rootWindow,s=n.getLastVisibleRow();if(t.mainTableScrollableElement===o){var l=(0,a.cv)(n.wtRootElement),u=(0,a.cx)(o,o);if(l.top>u)for(var c=(0,a.WS)(o),h=r.getColumnHeaderHeight(),d=1;d<=i;d++)if(h+=t.sumCellSizes(d-1,d),l.top+h-u>=c){s=d-2;break}}return s}},{key:"getFirstVisibleColumn",value:function(){var e=this.dataAccessObject,t=e.inlineStartOverlay,n=e.wtTable,r=e.wtViewport,i=e.totalColumns,o=e.rootWindow,s=n.getFirstVisibleColumn();if(t.mainTableScrollableElement===o){var l=(0,a.cv)(n.wtRootElement),u=(0,a.x9)(n.hider),c=(0,a.x9)(o),h=Math.abs((0,a.vj)(o,o));if(l.left+u-c<=h)for(var d=r.getRowHeaderWidth(),f=i;f>0;f--)if(d+=t.sumCellSizes(f-1,f),l.left+u-d<=h){s=f;break}}return s}},{key:"getLastVisibleColumn",value:function(){var e=this.dataAccessObject,t=e.wtSettings,n=e.inlineStartOverlay,r=e.wtTable,i=e.wtViewport,o=e.totalColumns,s=e.rootWindow,l=r.getLastVisibleColumn();if(n.mainTableScrollableElement===s){var u=null;if(t.getSetting("rtlMode")){var c=r.TABLE.getBoundingClientRect(),h=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(c.right-h)}else{u=(0,a.cv)(r.wtRootElement).left}var d=Math.abs((0,a.vj)(s,s));if(u>d)for(var f=(0,a.x9)(s),g=i.getRowHeaderWidth(),m=1;m<=o;m++)if(u+(g+=n.sumCellSizes(m-1,m))-d>=f){l=m-2;break}}return l}}]),e}(),we=ye;function Ce(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function be(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Se(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,Ee(e,t,"get"))}function Te(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Ee(e,t,"set"),n),n}function Ee(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Re=new WeakMap,ke=function(){function e(t,n){(0,S.Z)(this,e);var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];be(this,"row",null),be(this,"col",null),Ce(this,Re,{writable:!0,value:!1}),Te(this,Re,r),"undefined"!==typeof t&&"undefined"!==typeof n&&(this.row=t,this.col=n)}return(0,T.Z)(e,[{key:"isValid",value:function(e){return!(this.row<0||this.col<0)&&!(this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}},{key:"isEqual",value:function(e){return e===this||this.row===e.row&&this.col===e.col}},{key:"isSouthEastOf",value:function(e){return this.row>=e.row&&(Se(this,Re)?this.col<=e.col:this.col>=e.col)}},{key:"isNorthWestOf",value:function(e){return this.row<=e.row&&(Se(this,Re)?this.col>=e.col:this.col<=e.col)}},{key:"isSouthWestOf",value:function(e){return this.row>=e.row&&(Se(this,Re)?this.col>=e.col:this.col<=e.col)}},{key:"isNorthEastOf",value:function(e){return this.row<=e.row&&(Se(this,Re)?this.col<=e.col:this.col>=e.col)}},{key:"normalize",value:function(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}},{key:"clone",value:function(){return new e(this.row,this.col,Se(this,Re))}},{key:"toObject",value:function(){return{row:this.row,col:this.col}}}]),e}(),_e=ke;function Oe(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function Me(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xe(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,Ie(e,t,"get"))}function Ne(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Ie(e,t,"set"),n),n}function Ie(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var De=new WeakMap,He=function(){function e(t){(0,S.Z)(this,e);var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Me(this,"highlight",null),Me(this,"from",null),Me(this,"to",null),Oe(this,De,{writable:!0,value:!1}),this.highlight=t.clone().normalize(),this.from=n.clone(),this.to=r.clone(),Ne(this,De,i)}return(0,T.Z)(e,[{key:"setHighlight",value:function(e){return this.highlight=e.clone().normalize(),this}},{key:"setFrom",value:function(e){return this.from=e.clone(),this}},{key:"setTo",value:function(e){return this.to=e.clone(),this}},{key:"isValid",value:function(e){return this.from.isValid(e)&&this.to.isValid(e)}},{key:"isSingle",value:function(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}},{key:"getOuterHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getOuterWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"getHeight",value:function(){if(this.from.row<0&&this.to.row<0)return 0;var e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}},{key:"getWidth",value:function(){if(this.from.col<0&&this.to.col<0)return 0;var e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}},{key:"getCellsCount",value:function(){return this.getWidth()*this.getHeight()}},{key:"includes",value:function(e){var t=e.row,n=e.col,r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return r.row<=t&&i.row>=t&&r.col<=n&&i.col>=n}},{key:"includesRange",value:function(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}},{key:"isEqual",value:function(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}},{key:"overlaps",value:function(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}},{key:"isSouthEastOf",value:function(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}},{key:"isNorthWestOf",value:function(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}},{key:"isOverlappingHorizontally",value:function(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}},{key:"isOverlappingVertically",value:function(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}},{key:"expand",value:function(e){var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)}},{key:"expandByRange",value:function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=this.getDirection(),i=e.getOuterTopStartCorner(),o=e.getOuterBottomEndCorner(),s=Math.min(t.row,i.row),a=Math.min(t.col,i.col),l=Math.max(n.row,o.row),u=Math.max(n.col,o.col),c=this._createCellCoords(s,a),h=this._createCellCoords(l,u);return this.from=c,this.to=h,this.setDirection(r),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(e){switch(e){case"NW-SE":var t=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];this.from=t[0],this.to=t[1];break;case"NE-SW":var n=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var r=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];this.from=r[0],this.to=r[1];break;case"SW-NE":var i=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];this.from=i[0],this.to=i[1]}}},{key:"getVerticalDirection",value:function(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}},{key:"getHorizontalDirection",value:function(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}},{key:"flipDirectionVertically",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}},{key:"flipDirectionHorizontally",value:function(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}},{key:"getTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getTopLeftCorner",value:function(){return xe(this,De)?this.getTopEndCorner():this.getTopStartCorner()}},{key:"getBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getBottomRightCorner",value:function(){return xe(this,De)?this.getBottomStartCorner():this.getBottomEndCorner()}},{key:"getTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}},{key:"getTopRightCorner",value:function(){return xe(this,De)?this.getTopStartCorner():this.getTopEndCorner()}},{key:"getBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}},{key:"getBottomLeftCorner",value:function(){return xe(this,De)?this.getBottomEndCorner():this.getBottomStartCorner()}},{key:"getOuterTopStartCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterTopLeftCorner",value:function(){return xe(this,De)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}},{key:"getOuterBottomEndCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterBottomRightCorner",value:function(){return xe(this,De)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}},{key:"getOuterTopEndCorner",value:function(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getOuterTopRightCorner",value:function(){return xe(this,De)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}},{key:"getOuterBottomStartCorner",value:function(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getOuterBottomLeftCorner",value:function(){return xe(this,De)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}},{key:"isCorner",value:function(e,t){return!!(t&&t.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(t.from.row,t.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(t.from.row,t.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(t.to.row,t.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(t.to.row,t.to.col))))||(e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner()))}},{key:"getOppositeCorner",value:function(e,t){if(!(e instanceof _e))return!1;if(t){var n=t.from,r=t.to;if(t.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(n.row,r.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(r.row,n.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterTopStartCorner()}}return e.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():e.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():e.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():e.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0}},{key:"getBordersSharedWith",value:function(e){if(!this.includesRange(e))return[];var t=Math.min(this.from.row,this.to.row),n=Math.max(this.from.row,this.to.row),r=Math.min(this.from.col,this.to.col),i=Math.max(this.from.col,this.to.col),o=Math.min(e.from.row,e.to.row),s=Math.max(e.from.row,e.to.row),a=Math.min(e.from.col,e.to.col),l=Math.max(e.from.col,e.to.col),u=[];return t===o&&u.push("top"),i===l&&u.push("right"),n===s&&u.push("bottom"),r===a&&u.push("left"),u}},{key:"getInner",value:function(){for(var e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[],r=e.row;r<=t.row;r++)for(var i=e.col;i<=t.col;i++)this.from.row===r&&this.from.col===i||this.to.row===r&&this.to.col===i||n.push(this._createCellCoords(r,i));return n}},{key:"getAll",value:function(){for(var e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[],r=e.row;r<=t.row;r++)for(var i=e.col;i<=t.col;i++)e.row===r&&e.col===i?n.push(e):t.row===r&&t.col===i?n.push(t):n.push(this._createCellCoords(r,i));return n}},{key:"forAll",value:function(e){for(var t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=t.row;r<=n.row;r++)for(var i=t.col;i<=n.col;i++){if(!1===e(r,i))return}}},{key:"clone",value:function(){return new e(this.highlight,this.from,this.to,xe(this,De))}},{key:"toObject",value:function(){return{from:this.from.toObject(),to:this.to.toObject()}}},{key:"_createCellCoords",value:function(e,t){return new _e(e,t,xe(this,De))}}]),e}(),Ae=He;function Le(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Pe=function(){function e(t,n){(0,S.Z)(this,e),Le(this,"wtTable",void 0),Le(this,"wtScroll",void 0),Le(this,"wtViewport",void 0),Le(this,"wtOverlays",void 0),Le(this,"selections",void 0),Le(this,"wtEvent",void 0),Le(this,"guid","wt_".concat((0,C.O1)())),Le(this,"drawInterrupted",!1),Le(this,"drawn",!1),Le(this,"domBindings",void 0),Le(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new we(this.createScrollDao())}return(0,T.Z)(e,[{key:"eventManager",get:function(){return new d.Z(this)}},{key:"findOriginalHeaders",value:function(){var e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var t=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;t<n;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,n){(0,a.tT)(n,e[t])}])}}},{key:"createCellCoords",value:function(e,t){return new _e(e,t,this.wtSettings.getSetting("rtlMode"))}},{key:"createCellRange",value:function(e,t,n){return new Ae(e,t,n,this.wtSettings.getSetting("rtlMode"))}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,e||this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}},{key:"getCell",value:function(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(e);var t=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),r=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<n&&e.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<i&&e.row>=t-r){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<t&&e.row>=t-r&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}},{key:"scrollViewport",value:function(e,t,n,r,i){return!(e.col<0||e.row<0)&&this.wtScroll.scrollViewport(e,t,n,r,i)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return!(e<0)&&this.wtScroll.scrollViewportVertically(e,t,n)}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{key:"createScrollDao",value:function(){var e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}},{key:"getTableDao",value:function(){var e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selections(){return e.selections},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count}}}}]),e}();function Ve(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var We=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(e,r,i){var o;(0,S.Z)(this,n),o=t.call(this,e,r),Ve((0,R.Z)(o),"cloneSource",void 0),Ve((0,R.Z)(o),"cloneOverlay",void 0);var s=o.wtSettings.getSetting("facade",(0,R.Z)(o));return o.cloneSource=i.source,o.cloneOverlay=i.overlay,o.wtTable=o.cloneOverlay.createTable(o.getTableDao(),s,o.domBindings,o.wtSettings),o.wtViewport=i.viewport,o.selections=i.selections,o.wtEvent=new N(s,o.domBindings,o.wtSettings,o.eventManager,o.wtTable,o.selections,i.event),o.findOriginalHeaders(),o}return(0,T.Z)(n)}(Pe);function Fe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Be=function(){function e(t,n,r,i,o){(0,S.Z)(this,e),Fe(this,"wtSettings",null),(0,f.jW)(this,"wot",t,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;var s=this.wot.wtTable,l=s.TABLE,u=s.hider,c=s.spreader,h=s.holder,d=s.wtRootElement;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=l,this.hider=u,this.spreader=c,this.holder=h,this.wtRootElement=d,this.trimmingContainer=(0,a.$g)(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}return(0,T.Z)(e,[{key:"updateStateOfRendering",value:function(){var e=this.needFullRender;this.needFullRender=this.shouldBeRendered();var t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=(0,a.$g)(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){var e=this.wot.wtTable;"hidden"===this.domBindings.rootWindow.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=(0,a.dD)(e.TABLE)}},{key:"getRelativeCellPosition",value:function(e,t,n){if(!1!==this.clone.wtTable.holder.contains(e)){var r=this.mainTableScrollableElement===this.domBindings.rootWindow,i=n<this.wtSettings.getSetting("fixedColumnsStart"),o=t<this.wtSettings.getSetting("fixedRowsTop"),s=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),a=this.clone.wtTable.spreader,l={start:this.getRelativeStartPosition(a),top:a.offsetTop},u={start:this.getRelativeStartPosition(e),top:e.offsetTop};return r?this.getRelativeCellPositionWithinWindow(o,i,u,l):this.getRelativeCellPositionWithinHolder(o,s,i,u,l)}(0,z.ZK)("The provided element is not a child of the ".concat(this.type," overlay"))}},{key:"getRelativeStartPosition",value:function(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}},{key:"getRelativeCellPositionWithinWindow",value:function(e,t,n,r){var i=this.wot.wtTable.wtRootElement.getBoundingClientRect(),o=0,s=0;if(t){var l=i.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(i.left+i.width+(0,a.np)())),o=l<=0?-1*l:0}else o=r.start;e?s=this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top:s=r.top;return{start:n.start+o,top:n.top+s}}},{key:"getRelativeCellPositionWithinHolder",value:function(e,t,n,r,i){var o=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),s=this.wot.wtOverlays.topOverlay.getScrollPosition(),a=0,l=0;if(n||(a=o-i.start),t){var u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+u.top}else e||(l=s-i.top);return{start:r.start-a,top:r.top-l}}},{key:"makeClone",value:function(){if(-1===se.indexOf(this.type))throw new Error('Clone type "'.concat(this.type,'" is not supported.'));var e=this.wot.wtTable,t=this.domBindings,n=t.rootDocument,r=t.rootWindow,i=n.createElement("DIV"),o=n.createElement("TABLE"),s=e.wtRootElement.parentNode;i.className="".concat(ae.get(this.type)," handsontable"),i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,o.className=e.TABLE.className,i.appendChild(o),s.appendChild(i);var l=this.wtSettings.getSetting("preventOverflow");return!0===l||"horizontal"===l&&this.type===te||"vertical"===l&&this.type===re?this.mainTableScrollableElement=r:"hidden"===r.getComputedStyle(s).getPropertyValue("overflow")?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=(0,a.dD)(e.TABLE),new We(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}},{key:"reset",value:function(){if(this.clone){var e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,n=e.style,r=t.style,i=e.parentNode.style;(0,g.Bk)([n,r,i],(function(e){e.width="",e.height=""}))}}},{key:"isRtl",value:function(){return this.wtSettings.getSetting("rtlMode")}},{key:"destroy",value:function(){this.clone.eventManager.destroy()}}]),e}();function Ze(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var je=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(e,r,i,o){var s;return(0,S.Z)(this,n),s=t.call(this,e,r,te,i,o),Ze((0,R.Z)(s),"cachedFixedRowsTop",-1),s.cachedFixedRowsTop=s.wtSettings.getSetting("fixedRowsTop"),s}return(0,T.Z)(n,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,I.Z)(ve,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode,t=this.domBindings.rootWindow,n=this.wtSettings.getSetting("preventOverflow"),r=0,i=!1;if(this.trimmingContainer!==t||n&&"vertical"===n)r=this.getScrollPosition(),(0,a.WH)(e);else{var o=this.wot.wtTable.hider.getBoundingClientRect();i=Math.ceil(o.bottom)===e.offsetHeight,r=this.getOverlayOffset(),(0,a.I2)(e,"0px","".concat(r,"px"))}var s=this.adjustHeaderBordersPosition(r,i);return this.adjustElementsSize(),s}},{key:"setScrollPosition",value:function(e){var t=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo((0,a.DZ)(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.wtSettings.getSetting("defaultRowHeight"),r=e,i=0;r<t;){var o=this.wot.wtTable.getRowHeight(r);i+=void 0===o?n:o,r+=1}return i}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot.wtTable,t=this.domBindings,n=t.rootDocument,r=t.rootWindow,i=(0,a.np)(n),o=this.clone.wtTable.holder.parentNode.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===s){var l=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(l-=i),l=Math.min(l,e.wtRootElement.scrollWidth),o.width="".concat(l,"px")}else o.width="";this.clone.wtTable.holder.style.width=o.width;var u=(0,a.Pb)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),o.height="".concat(u,"px")}},{key:"adjustRootChildrenSize",value:function(){var e,t=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),i=Math.abs(null!==(e=null===n||void 0===n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height="".concat(parseInt(t.parentNode.style.height,10)+i,"px")}},{key:"applyToDOM",value:function(){var e=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var e=this.isRtl()?"right":"left",t=this.clone.wtTable.spreader;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):t.style[e]=""}},{key:"scrollTo",value:function(e,t){var n=this.wot,r=this.wtSettings,i=(n.cloneSource?n.cloneSource:n).wtTable.holder,o=this.getTableParentOffset(),s=0;t&&(this.wot.wtTable.getRowHeight(e)>this.wot.wtViewport.getViewportHeight()&&(t=!1));if(t&&i.offsetHeight!==i.clientHeight&&(s=(0,a.np)(this.domBindings.rootDocument)),t){var l=r.getSetting("fixedRowsBottom"),u=r.getSetting("totalRows");o+=this.sumCellSizes(0,e+1),o-=n.wtViewport.getViewportHeight()-this.sumCellSizes(u-l,u),o+=1}else o+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return o+=s,this.setScrollPosition(o)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return(0,a.cx)(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var e=this.domBindings.rootWindow,t=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){var r=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight();(n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>r&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?(0,a.IV)(n,"emptyColumns"):(0,a.cn)(n,"emptyColumns");var r=!1;if(!t){var i=this.wtSettings.getSetting("fixedRowsTop"),o=this.cachedFixedRowsTop!==i,s=this.wtSettings.getSetting("columnHeaders");if((o||0===i)&&s.length>0){var l=(0,a.pv)(n,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||0===this.wtSettings.getSetting("totalRows")?((0,a.cn)(n,"innerBorderTop"),r=!l):((0,a.IV)(n,"innerBorderTop"),r=l)}}return r}}]),n}(Be),Ue={getFirstRenderedRow:function(){var e=this.wtSettings.getSetting("totalRows"),t=this.wtSettings.getSetting("fixedRowsBottom"),n=e-t;return 0===e||0===t?-1:n<0?0:n},getFirstVisibleRow:function(){return this.getFirstRenderedRow()},getLastRenderedRow:function(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow:function(){return this.getLastRenderedRow()},getRenderedRowsCount:function(){var e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount:function(){return this.getRenderedRowsCount()}};(0,f.jW)(Ue,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});var Ye=Ue,ze=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(e,r,i,o){return(0,S.Z)(this,n),t.call(this,e,r,i,o,ne)}return(0,T.Z)(n)}(ce);(0,f.jB)(ze,Ye),(0,f.jB)(ze,ge);var Ge=ze;function Xe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ke=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(e,r,i,o){var s;return(0,S.Z)(this,n),s=t.call(this,e,r,ne,i,o),Xe((0,R.Z)(s),"cachedFixedRowsBottom",-1),s.cachedFixedRowsBottom=s.wtSettings.getSetting("fixedRowsBottom"),s}return(0,T.Z)(n,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,I.Z)(Ge,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}},{key:"resetFixedPosition",value:function(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;var e=this.domBindings.rootWindow,t=this.clone.wtTable.holder.parentNode;t.style.top="";var n=0,r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==e||r&&"vertical"===r?(n=this.getScrollPosition(),this.repositionOverlay()):(n=this.getOverlayOffset(),t.style.bottom="".concat(n,"px"));var i=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),i}},{key:"repositionOverlay",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,r=this.domBindings.rootDocument,i=this.clone.wtTable.holder.parentNode,o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-t.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=(0,a.np)(r)),i.style.bottom="".concat(o,"px")}},{key:"setScrollPosition",value:function(e){var t=this.domBindings.rootWindow,n=!1;return this.mainTableScrollableElement===t?(t.scrollTo((0,a.DZ)(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.wot,r=n.wtTable,i=n.wtSettings.getSetting("defaultRowHeight"),o=e,s=0;o<t;){var a=r.getRowHeight(o);s+=void 0===a?i:a,o+=1}return s}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,r=this.domBindings,i=r.rootDocument,o=r.rootWindow,s=(0,a.np)(i),l=this.clone.wtTable.holder.parentNode.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||"horizontal"===u){var c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=s),c=Math.min(c,t.wtRootElement.scrollWidth),l.width="".concat(c,"px")}else l.width="";this.clone.wtTable.holder.style.width=l.width;var h=(0,a.Pb)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(h=0),l.height="".concat(h,"px")}},{key:"adjustRootChildrenSize",value:function(){var e=this.clone.wtTable.holder;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}},{key:"applyToDOM",value:function(){var e=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){var e=this.isRtl()?"right":"left",t=this.clone.wtTable.spreader;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px"):t.style[e]=""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,i=0;t&&r.offsetHeight!==r.clientHeight&&(i=(0,a.np)(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return(0,a.cx)(this.mainTableScrollableElement,this.domBindings.rootWindow)}},{key:"getOverlayOffset",value:function(){var e=this.domBindings.rootWindow,t=this.wtSettings.getSetting("preventOverflow"),n=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){var r=this.wot.wtTable.getTotalHeight(),i=r-this.clone.wtTable.getTotalHeight(),o=this.domBindings.rootDocument.documentElement.clientHeight;(n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-o+r,0))>i&&(n=0)}return n}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,r=this.wtSettings.getSetting("columnHeaders"),i=!1;if((n||0===t)&&r.length>0){var o=this.wot.wtTable.holder.parentNode,s=(0,a.pv)(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||0===this.wtSettings.getSetting("totalRows")?((0,a.cn)(o,"innerBorderBottom"),i=!s):((0,a.IV)(o,"innerBorderBottom"),i=s)}return i}}]),n}(Be),qe={getFirstRenderedRow:function(){var e=this.dataAccessObject.startRowRendered;return null===e?-1:e},getFirstVisibleRow:function(){var e=this.dataAccessObject.startRowVisible;return null===e?-1:e},getLastRenderedRow:function(){var e=this.dataAccessObject.endRowRendered;return null===e?-1:e},getLastVisibleRow:function(){var e=this.dataAccessObject.endRowVisible;return null===e?-1:e},getRenderedRowsCount:function(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount:function(){return this.dataAccessObject.countRowsVisible}};(0,f.jW)(qe,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});var $e=qe,Qe={getFirstRenderedColumn:function(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn:function(){return this.getFirstRenderedColumn()},getLastRenderedColumn:function(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn:function(){return this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount:function(){return this.getRenderedColumnsCount()}};(0,f.jW)(Qe,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});var Je=Qe,et=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(e,r,i,o){return(0,S.Z)(this,n),t.call(this,e,r,i,o,re)}return(0,T.Z)(n)}(ce);(0,f.jB)(et,$e),(0,f.jB)(et,Je);var tt=et,nt=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(e,r,i,o){return(0,S.Z)(this,n),t.call(this,e,r,re,i,o)}return(0,T.Z)(n,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,I.Z)(tt,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var e=this.wot.wtTable;if(!this.needFullRender||!e.holder.parentNode)return!1;var t=this.domBindings.rootWindow,n=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow"),i=0;this.trimmingContainer!==t||r&&"horizontal"===r?(i=this.getScrollPosition(),(0,a.WH)(n)):(i=this.getOverlayOffset()*(this.isRtl()?-1:1),(0,a.I2)(n,"".concat(i,"px"),"0px"));var o=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),o}},{key:"setScrollPosition",value:function(e){var t=this.domBindings.rootWindow,n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,(0,a.AQ)(t)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}},{key:"onScroll",value:function(){this.wtSettings.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(e,t){for(var n=this.wtSettings.getSetting("defaultColumnWidth"),r=e,i=0;r<t;)i+=this.wot.wtTable.getStretchedColumnWidth(r)||n,r+=1;return i}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}},{key:"adjustRootElementSize",value:function(){var e=this.wot.wtTable,t=this.domBindings,n=t.rootDocument,r=t.rootWindow,i=(0,a.np)(n),o=this.clone.wtTable.holder.parentNode.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"vertical"===s){var l=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(l-=i),l=Math.min(l,e.wtRootElement.scrollHeight),o.height="".concat(l,"px")}else o.height="";this.clone.wtTable.holder.style.height=o.height;var u=(0,a.iO)(this.clone.wtTable.TABLE);o.width="".concat(u,"px")}},{key:"adjustRootChildrenSize",value:function(){var e,t=this.clone.wtTable.holder,n=this.wot.selections,r=this.facadeGetter(),i=Math.abs(null!==(e=null===n||void 0===n?void 0:n.getCell().getBorder(r).cornerCenterPointOffset)&&void 0!==e?e:0);this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width="".concat(parseInt(t.parentNode.style.width,10)+i,"px")}},{key:"applyToDOM",value:function(){var e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if("number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[t]="".concat(this.wot.wtViewport.columnsRenderCalculator.startPosition,"px");else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[t]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top="".concat(this.wot.wtViewport.rowsRenderCalculator.startPosition,"px"):this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),r=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,i=0;t&&(this.wot.wtTable.getColumnWidth(e)>this.wot.wtViewport.getViewportWidth()&&(t=!1));return t&&r.offsetWidth!==r.clientWidth&&(i=(0,a.np)(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),n+=i,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var e=0;return this.wtSettings.getSetting("preventOverflow")||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}},{key:"getScrollPosition",value:function(){return Math.abs((0,a.vj)(this.mainTableScrollableElement,this.domBindings.rootWindow))}},{key:"getOverlayOffset",value:function(){var e=this.domBindings.rootWindow,t=this.wtSettings.getSetting("preventOverflow"),n=0;this.trimmingContainer!==e||t&&"horizontal"===t||(n=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(n=0);return n}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("rowHeaders"),r=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?(0,a.IV)(t,"emptyRows"):(0,a.cn)(t,"emptyRows");var i=!1;if(r&&!n.length)(0,a.cn)(t,"innerBorderLeft innerBorderInlineStart");else if(!r&&n.length){var o=(0,a.pv)(t,"innerBorderInlineStart");e?((0,a.cn)(t,"innerBorderLeft innerBorderInlineStart"),i=!o):((0,a.IV)(t,"innerBorderLeft innerBorderInlineStart"),i=o)}return i}}]),n}(Be),rt=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(e,r,i,o){return(0,S.Z)(this,n),t.call(this,e,r,i,o,ie)}return(0,T.Z)(n)}(ce);(0,f.jB)(rt,de),(0,f.jB)(rt,Je);var it=rt;function ot(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var st=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(e,r,i,o,s,a){var l;return(0,S.Z)(this,n),l=t.call(this,e,r,ie,i,o),ot((0,R.Z)(l),"topOverlay",void 0),ot((0,R.Z)(l),"inlineStartOverlay",void 0),l.topOverlay=s,l.inlineStartOverlay=a,l}return(0,T.Z)(n,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,I.Z)(it,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;var e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){var t=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),n=this.topOverlay.getOverlayOffset();(0,a.I2)(e,"".concat(t,"px"),"".concat(n,"px"))}else(0,a.WH)(e);var r=(0,a.Pb)(this.clone.wtTable.TABLE),i=(0,a.iO)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height="".concat(r,"px"),e.style.width="".concat(i,"px"),!1}}]),n}(Be),at=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(e,r,i,o){return(0,S.Z)(this,n),t.call(this,e,r,i,o,oe)}return(0,T.Z)(n)}(ce);(0,f.jB)(at,Ye),(0,f.jB)(at,Je);var lt=at,ut=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(e,r,i,o,s,a){var l;return(0,S.Z)(this,n),(l=t.call(this,e,r,oe,i,o)).bottomOverlay=s,l.inlineStartOverlay=a,l}return(0,T.Z)(n,[{key:"createTable",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,I.Z)(lt,t)}},{key:"shouldBeRendered",value:function(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}},{key:"resetFixedPosition",value:function(){var e=this.wot;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;var t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){var n=this.inlineStartOverlay.getOverlayOffset(),r=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]="".concat(n,"px"),t.style.bottom="".concat(r,"px")}else(0,a.WH)(t),this.repositionOverlay();var i=(0,a.Pb)(this.clone.wtTable.TABLE),o=(0,a.iO)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),t.style.height="".concat(i,"px"),t.style.width="".concat(o,"px"),!1}},{key:"repositionOverlay",value:function(){var e=this.wot,t=e.wtTable,n=e.wtViewport,r=this.domBindings.rootDocument,i=this.clone.wtTable.holder.parentNode,o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-t.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=(0,a.np)(r)),i.style.bottom="".concat(o,"px")}}]),n}(Be);function ct(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ht=function(){function e(t,n,r,i,o,s){var l=this;(0,S.Z)(this,e),ct(this,"wot",null),ct(this,"topOverlay",null),ct(this,"bottomOverlay",null),ct(this,"inlineStartOverlay",null),ct(this,"topInlineStartCornerOverlay",null),ct(this,"bottomInlineStartCornerOverlay",null),ct(this,"browserLineHeight",void 0),ct(this,"wtSettings",null),ct(this,"resizeObserver",new ResizeObserver((function(e){var t;t=function(){Array.isArray(e)&&e.length&&l.wtSettings.getSetting("onContainerElementResize")},window.requestAnimationFrame(t)}))),this.wot=t,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;var u=this.domBindings,c=u.rootDocument,h=u.rootWindow;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=(0,a.np)(c);var d="hidden"===h.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=d?s.holder:(0,a.dD)(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=h.scrollX,this.lastScrollY=h.scrollY}return(0,T.Z)(e,[{key:"getOverlays",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&t.push(this.wtTable),t}},{key:"initBrowserLineHeight",value:function(){var e=this.domBindings,t=e.rootWindow,n=e.rootDocument,r=t.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=1.2*parseInt(r.fontSize,10);this.browserLineHeight=i||o}},{key:"initOverlays",value:function(){var e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=(0,I.Z)(je,e),this.bottomOverlay=(0,I.Z)(Ke,e),this.inlineStartOverlay=(0,I.Z)(nt,e),this.topInlineStartCornerOverlay=(0,I.Z)(st,e.concat([this.topOverlay,this.inlineStartOverlay])),this.bottomInlineStartCornerOverlay=(0,I.Z)(ut,e.concat([this.bottomOverlay,this.inlineStartOverlay]))}},{key:"updateStateOfRendering",value:function(){var e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}},{key:"refreshAll",value:function(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}},{key:"registerListeners",value:function(){var e=this,t=this.domBindings,n=t.rootDocument,r=t.rootWindow,i=this.topOverlay.mainTableScrollableElement,o=this.inlineStartOverlay.mainTableScrollableElement;this.eventManager.addEventListener(n.documentElement,"keydown",(function(t){return e.onKeyDown(t)})),this.eventManager.addEventListener(n.documentElement,"keyup",(function(){return e.onKeyUp()})),this.eventManager.addEventListener(n,"visibilitychange",(function(){return e.onKeyUp()})),this.eventManager.addEventListener(i,"scroll",(function(t){return e.onTableScroll(t)}),{passive:!0}),i!==o&&this.eventManager.addEventListener(o,"scroll",(function(t){return e.onTableScroll(t)}),{passive:!0});var s,a=r.devicePixelRatio&&r.devicePixelRatio>1,l=this.scrollableElement===r,u=this.wtSettings.getSetting("preventWheel"),h={passive:l};(u||a||!(0,c.i7)())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(function(t){return e.onCloneWheel(t,u)}),h),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach((function(t){if(t&&t.needFullRender){var n=t.clone.wtTable.holder;e.eventManager.addEventListener(n,"wheel",(function(t){return e.onCloneWheel(t,u)}),h)}})),this.eventManager.addEventListener(r,"resize",(function(){clearTimeout(s),s=setTimeout((function(){e.wtSettings.getSetting("onWindowResize")}),200)})),l||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}},{key:"deregisterListeners",value:function(){this.eventManager.clearEvents(!0)}},{key:"onTableScroll",value:function(e){var t=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,i=e.target;this.keyPressed&&(r!==t&&i!==t&&!e.target.contains(r)||n!==t&&i!==t&&!e.target.contains(n))||this.syncScrollPositions(e)}},{key:"onCloneWheel",value:function(e,t){var n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target,s=i!==n&&o!==n&&!o.contains(i),a=r!==n&&o!==n&&!o.contains(r);if(!this.keyPressed||!s&&!a){var l=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&l)&&e.preventDefault()}}},{key:"onKeyDown",value:function(e){this.keyPressed=(0,D.ot)(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(e){var t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(n+=n*this.browserLineHeight,t+=t*this.browserLineHeight);var r=this.scrollVertically(t),i=this.scrollHorizontally(n);return r||i}},{key:"scrollVertically",value:function(e){var t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}},{key:"scrollHorizontally",value:function(e){var t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}},{key:"syncScrollPositions",value:function(){if(!this.destroyed){var e=this.domBindings.rootWindow,t=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,r=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop],i=r[0],o=r[1];if(this.horizontalScrolling=t.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=i;var s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(n.scrollTop=o),this.refreshAll()}}},{key:"syncScrollWithMaster",value:function(){var e=this.topOverlay.mainTableScrollableElement,t=e.scrollLeft,n=e.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();var e=this.wtTable;"hidden"===this.domBindings.rootWindow.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=e.holder:this.scrollableElement=(0,a.dD)(e.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}},{key:"updateLastSpreaderSize",value:function(){var e=this.wtTable.spreader,t=e.clientWidth,n=e.clientHeight,r=t!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=n),r}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot.wtViewport,n=this.wtTable,r=this.wtSettings.getSetting("totalColumns"),i=this.wtSettings.getSetting("totalRows"),o=t.getRowHeaderWidth(),s=t.getColumnHeaderHeight(),a=n.hider.style;if(a.width="".concat(o+this.inlineStartOverlay.sumCellSizes(0,r),"px"),a.height="".concat(s+this.topOverlay.sumCellSizes(0,i)+1,"px"),this.scrollbarSize>0){var l=n.wtRootElement,u=l.scrollHeight,c=l.scrollWidth,h=n.holder,d=h.scrollHeight,f=h.scrollWidth;this.hasScrollbarRight=u<d,this.hasScrollbarBottom=c<f,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}},{key:"applyToDOM",value:function(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}},{key:"getParentOverlay",value:function(e){if(!e)return null;var t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],n=null;return(0,g.Bk)(t,(function(t){t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(n=t.clone)})),n}},{key:"syncOverlayTableClassNames",value:function(){var e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];(0,g.Bk)(t,(function(t){t&&(t.clone.wtTable.TABLE.className=e.className)}))}}]),e}(),dt=ht;function ft(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gt=function(){function e(t){var n=this;(0,S.Z)(this,e),ft(this,"settings",{}),ft(this,"defaults",Object.freeze(this.getDefaults())),(0,f._l)(this.defaults,(function(e,r){if(void 0!==t[r])n.settings[r]=t[r];else{if(void 0===e)throw new Error('A required setting "'.concat(r,'" was not provided'));n.settings[r]=e}}))}return(0,T.Z)(e,[{key:"getDefaults",value:function(){var e=this;return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:function(){return e.getSetting("fixedColumnsStart")>0||e.getSetting("rowHeaders").length>0},shouldRenderTopOverlay:function(){return e.getSetting("fixedRowsTop")>0||e.getSetting("columnHeaders").length>0},shouldRenderBottomOverlay:function(){return e.getSetting("fixedRowsBottom")>0},minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(t,n,r){var i=e.getSetting("data",t,n);(0,a.tT)(r,void 0===i||null===i?"":i)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(e){return e},onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:function(e){return e},onBeforeHighlightingColumnHeader:function(e){return e},onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}},{key:"update",value:function(e,t){var n=this;return void 0===t?(0,f._l)(e,(function(e,t){n.settings[t]=e})):this.settings[e]=t,this}},{key:"getSetting",value:function(e,t,n,r,i){return"function"===typeof this.settings[e]?this.settings[e](t,n,r,i):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}},{key:"getSettingPure",value:function(e){return this.settings[e]}},{key:"has",value:function(e){return!!this.settings[e]}}]),e}(),mt=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(e,r,i,o){return(0,S.Z)(this,n),t.call(this,e,r,i,o,"master")}return(0,T.Z)(n,[{key:"alignOverlaysWithTrimmingContainer",value:function(){var e=(0,a.$g)(this.wtRootElement),t=this.domBindings.rootWindow;if(e===t){this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{var n=e.parentElement,r=(0,a.C2)(e,"height",t),i=(0,a.C2)(e,"overflow",t),o=this.holder.style,s=e.scrollWidth,l=e.scrollHeight,u=e.getBoundingClientRect(),c=u.width,h=u.height;if(n&&["auto","hidden","scroll"].includes(i)){var d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?n.insertBefore(d,e.nextElementSibling):n.appendChild(d);var f=parseInt((0,a.Dx)(d,t).height,10);n.removeChild(d),0===f&&(h=0)}h=Math.min(h,l),o.height="auto"===r?"auto":"".concat(h,"px"),c=Math.min(c,s),o.width="".concat(c,"px"),o.overflow="",this.hasTableHeight="auto"===o.height||h>0,this.hasTableWidth=c>0}this.isTableVisible=(0,a.pn)(this.TABLE)}},{key:"markOversizedColumnHeaders",value:function(){var e=this.wtSettings,t=this.dataAccessObject.wtViewport,n="master",r=e.getSetting("columnHeaders").length;if(r&&!t.hasOversizedColumnHeadersMarked[n]){for(var i=e.getSetting("rowHeaders").length,o=this.getRenderedColumnsCount(),s=0;s<r;s++)for(var a=-1*i;a<o;a++)this.markIfOversizedColumnHeader(a);t.hasOversizedColumnHeadersMarked[n]=!0}}}]),n}(ce);(0,f.jB)(mt,$e),(0,f.jB)(mt,ge);var vt=mt,pt=new WeakMap,yt=function(){function e(){(0,S.Z)(this,e);var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.viewportSize,r=t.scrollOffset,i=t.totalItems,o=t.itemSizeFn,s=t.overrideFn,a=t.calculationType,l=t.scrollbarHeight;pt.set(this,{viewportHeight:n,scrollOffset:r,totalRows:i,rowHeightFn:o,overrideFn:s,calculationType:a,horizontalScrollbarHeight:l}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}return(0,T.Z)(e,[{key:"calculate",value:function(){for(var t,n=pt.get(this),r=n.calculationType,i=n.overrideFn,o=n.rowHeightFn,s=n.scrollOffset,a=Math.max(n.scrollOffset,0),l=n.totalRows,u=n.viewportHeight,c=n.horizontalScrollbarHeight||0,h=0,d=!0,f=[],g=0,m=0,v=0;v<l;v++)if(t=o(v),isNaN(t)&&(t=e.DEFAULT_HEIGHT),h<=a&&2!==r&&(this.startRow=v,g=t),h>=a&&h+(2===r?t:0)<=a+u-c&&(null===this.startRow&&(this.startRow=v,g=t),this.endRow=v),f.push(h),h+=t,m=t,2!==r&&(this.endRow=v),h>=a+u-c){d=!1;break}var p=2===r?0:m;if(s+u-c<(2===r?g:0)||s>f.at(-1)+p?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===l-1&&d)for(this.startRow=this.endRow;this.startRow>0;){var y=f[this.endRow]+t-f[this.startRow-1];if((y<=u-c||2!==r)&&(this.startRow-=1),y>=u-c)break}1===r&&null!==this.startRow&&i&&i(this),this.startPosition=f[this.startRow],void 0===this.startPosition&&(this.startPosition=null),l<this.endRow&&(this.endRow=l-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}],[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),e}(),wt=yt,Ct=new WeakMap,bt=function(){function e(){(0,S.Z)(this,e);var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.viewportSize,r=t.scrollOffset,i=t.totalItems,o=t.itemSizeFn,s=t.overrideFn,a=t.calculationType,l=t.stretchMode,u=t.stretchingItemWidthFn,c=void 0===u?function(e){return e}:u,h=t.inlineStartOffset;Ct.set(this,{viewportWidth:n,scrollOffset:r,totalColumns:i,columnWidthFn:o,overrideFn:s,calculationType:a,stretchingColumnWidthFn:c,inlineStartOffset:h}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=l,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return(0,T.Z)(e,[{key:"calculate",value:function(){for(var e,t=0,n=!0,r=[],i=0,o=0,s=Ct.get(this),a=s.calculationType,l=s.overrideFn,u=s.scrollOffset,c=Math.max(s.scrollOffset,0),h=s.totalColumns,d=s.viewportWidth,f=c>0?d+1:d,g=0;g<h;g++)if(e=this._getColumnWidth(g),t<=c&&2!==a&&(this.startColumn=g,i=e),t>=c&&t+(2===a?e:0)<=c+f&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=g,i=e),this.endColumn=g),r.push(t),t+=e,o=e,2!==a&&(this.endColumn=g),t>=c+d){n=!1;break}var m=2===a?0:o,v=2===a?i:0;if(u+d-f<-1*s.inlineStartOffset||u>r.at(-1)+m||-1*s.scrollOffset-s.viewportWidth>-1*v?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===h-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var p=r[this.endColumn]+e-r[this.startColumn-1];if((p<=d||2!==a)&&(this.startColumn-=1),p>d)break}1===a&&null!==this.startColumn&&l&&l(this),this.startPosition=r[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),h<this.endColumn&&(this.endColumn=h-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(e){if("none"!==this.stretch){var t=e;this.totalTargetWidth=t;for(var n=Ct.get(this),r=n.totalColumns,i=0,o=0;o<r;o++){var s=this._getColumnWidth(o),a=n.stretchingColumnWidthFn(void 0,o);"number"===typeof a?t-=a:i+=s}var l=t-i;if("all"===this.stretch&&l>0)this.stretchAllRatio=t/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&t!==1/0){var u=this._getColumnWidth(r-1),c=l+u;this.stretchLastWidth=c>=0?c:u}}}},{key:"getStretchedColumnWidth",value:function(e,t){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(e)),n}},{key:"_getStretchedAllColumnWidth",value:function(e,t){var n=0,r=Ct.get(this),i=r.totalColumns;if(!this.stretchAllColumnsWidth[e]){var o=Math.round(t*this.stretchAllRatio),s=r.stretchingColumnWidthFn(o,e);this.stretchAllColumnsWidth[e]=void 0===s?o:isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var a=0;a<this.stretchAllColumnsWidth.length;a++)n+=this.stretchAllColumnsWidth[a];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]}},{key:"_getStretchedLastColumnWidth",value:function(e){return e===Ct.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(t){var n=Ct.get(this).columnWidthFn(t);return isNaN(n)&&(n=e.DEFAULT_WIDTH),n}}],[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),e}(),St=bt,Tt=function(){function e(t,n,r,i,o){var s=this;(0,S.Z)(this,e),this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(function(){s.clientHeight=s.getWorkspaceHeight()}))}return(0,T.Z)(e,[{key:"getWorkspaceHeight",value:function(){var e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer,n=0;t===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=(0,a.Pb)(t)>0&&t.clientHeight>0?t.clientHeight:1/0;return n}},{key:"getWorkspaceWidth",value:function(){var e,t,n=this.wtSettings,r=this.domBindings,i=r.rootDocument,o=r.rootWindow,s=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=i.documentElement.offsetWidth,u=n.getSetting("totalColumns"),c=n.getSetting("preventOverflow"),h=n.getSetting("rtlMode"),d=this.wtTable.TABLE.getBoundingClientRect(),f=l-(h?d.right-l:d.left);if(c)return(0,a.iO)(this.wtTable.wtRootElement);if(e=n.getSetting("freezeOverlays")?Math.min(f,l):Math.min(this.getContainerFillWidth(),f,l),s===o&&u>0&&this.sumColumnWidths(0,u-1)>e)return i.documentElement.clientWidth;if(s!==o&&("scroll"===(t=(0,a.C2)(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o))||"hidden"===t||"auto"===t))return Math.max(e,s.clientWidth);var g=n.getSetting("stretchH");return"none"!==g&&g?e:Math.max(e,(0,a.iO)(this.wtTable.TABLE))}},{key:"hasVerticalScroll",value:function(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(e,t){for(var n=0,r=e;r<t;)n+=this.wtTable.getColumnWidth(r),r+=1;return n}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);var n=t.offsetWidth;return this.containerWidth=n,e.removeChild(t),n}},{key:"getWorkspaceOffset",value:function(){return(0,a.cv)(this.wtTable.TABLE)}},{key:"getColumnHeaderHeight",value:function(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=(0,a.Pb)(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var e=this.getWorkspaceHeight();if(e===1/0)return e;var t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}},{key:"getRowHeaderWidth",value:function(){var e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(var n=0,r=t.length;n<r;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(t.length){var i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var o=0,s=t.length;o<s;o++)i?(this.rowHeaderWidth+=(0,a.iO)(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var e=this.getWorkspaceWidth();if(e===1/0)return e;var t=this.getRowHeaderWidth();return t>0?e-t:e}},{key:"createRowsCalculator",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=this.wtSettings,o=this.wtTable;this.rowHeaderWidth=NaN,e=i.getSetting("renderAllRows")&&1===r?1/0:this.getViewportHeight();var s=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,l=i.getSetting("fixedRowsTop"),u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");return l&&s>=0&&(s+=n=this.dataAccessObject.topOverlay.sumCellSizes(0,l),e-=n),u&&this.dataAccessObject.bottomOverlay.clone&&(e-=n=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c)),t=o.holder.clientHeight===o.holder.offsetHeight?0:(0,a.np)(this.domBindings.rootDocument),new wt({viewportSize:e,scrollOffset:s,totalItems:i.getSetting("totalRows"),itemSizeFn:function(e){return o.getRowHeight(e)},overrideFn:i.getSettingPure("viewportRowCalculatorOverride"),calculationType:r,scrollbarHeight:t})}},{key:"createColumnsCalculator",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.wtSettings,n=this.wtTable,r=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;var o=t.getSetting("fixedColumnsStart");if(o&&i>=0){var s=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);i+=s,r-=s}return n.holder.clientWidth!==n.holder.offsetWidth&&(r-=(0,a.np)(this.domBindings.rootDocument)),new St({viewportSize:r,scrollOffset:i,totalItems:t.getSetting("totalColumns"),itemSizeFn:function(e){return n.getColumnWidth(e)},overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:t.getSetting("stretchH"),stretchingItemWidthFn:function(e,n){return t.getSetting("onBeforeStretchingColumnWidth",e,n)},inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}},{key:"createRenderCalculators",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e){var t=this.createRowsCalculator(2),n=this.createColumnsCalculator(2);this.areAllProposedVisibleRowsAlreadyRendered(t)&&this.areAllProposedVisibleColumnsAlreadyRendered(n)||(e=!1)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(1),this.columnsRenderCalculator=this.createColumnsCalculator(1)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(2),this.columnsVisibleCalculator=this.createColumnsCalculator(2)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(e){if(!this.rowsVisibleCalculator)return!1;var t=e.startRow,n=e.endRow,r=e.isVisibleInTrimmingContainer;if(null===t&&null===n)return!r;var i=this.rowsRenderCalculator,o=i.startRow,s=i.endRow;return!(t<o||t===o&&t>0)&&!(n>s||n===s&&n<this.wtSettings.getSetting("totalRows")-1)}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(e){if(!this.columnsVisibleCalculator)return!1;var t=e.startColumn,n=e.endColumn,r=e.isVisibleInTrimmingContainer;if(null===t&&null===n)return!r;var i=this.columnsRenderCalculator,o=i.startColumn,s=i.endColumn;return!(t<o||t===o&&t>0)&&!(n>s||n===s&&n<this.wtSettings.getSetting("totalColumns")-1)}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){(0,f._l)(this.hasOversizedColumnHeadersMarked,(function(e,t,n){n[t]=void 0}))}}]),e}(),Et=Tt,Rt=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(e,r){var i;(0,S.Z)(this,n);var o=(i=t.call(this,e,new gt(r))).wtSettings.getSetting("facade",(0,R.Z)(i));return i.wtTable=new vt(i.getTableDao(),o,i.domBindings,i.wtSettings),i.wtViewport=new Et(i.getViewportDao(),i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.selections=i.wtSettings.getSetting("selections"),i.wtEvent=new N(o,i.domBindings,i.wtSettings,i.eventManager,i.wtTable,i.selections),i.wtOverlays=new dt((0,R.Z)(i),o,i.domBindings,i.wtSettings,i.eventManager,i.wtTable),i.exportSettingsAsClassNames(),i.findOriginalHeaders(),i}return(0,T.Z)(n,[{key:"exportSettingsAsClassNames",value:function(){var e=this,t=[],n=[];(0,f._l)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(function(r,i){e.wtSettings.getSetting(i).length&&n.push(r),t.push(r)})),(0,a.IV)(this.wtTable.wtRootElement.parentNode,t),(0,a.cn)(this.wtTable.wtRootElement.parentNode,n)}},{key:"getViewportDao",value:function(){var e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}]),n}(Pe),kt=function(){function e(t){(0,S.Z)(this,e),t instanceof Pe?this._wot=t:this._initFromSettings(t)}return(0,T.Z)(e,[{key:"_initFromSettings",value:function(t){t.facade=function(t){var n=new e(t);return function(){return n}},this._wot=new Rt(t.table,t)}},{key:"guid",get:function(){return this._wot.guid}},{key:"rootDocument",get:function(){return this._wot.domBindings.rootDocument}},{key:"rootWindow",get:function(){return this._wot.domBindings.rootWindow}},{key:"wtSettings",get:function(){return this._wot.wtSettings}},{key:"cloneSource",get:function(){return this._wot.cloneSource}},{key:"cloneOverlay",get:function(){return this._wot.cloneOverlay}},{key:"selections",get:function(){return this._wot.selections}},{key:"wtViewport",get:function(){return this._wot.wtViewport}},{key:"wtOverlays",get:function(){return this._wot.wtOverlays}},{key:"wtTable",get:function(){return this._wot.wtTable}},{key:"wtEvent",get:function(){return this._wot.wtEvent}},{key:"wtScroll",get:function(){return this._wot.wtScroll}},{key:"drawn",get:function(){return this._wot.drawn},set:function(e){this._wot.drawn=e}},{key:"drawInterrupted",get:function(){return this._wot.drawInterrupted},set:function(e){this._wot.drawInterrupted=e}},{key:"lastMouseOver",get:function(){return this._wot.lastMouseOver},set:function(e){this._wot.lastMouseOver=e}},{key:"momentumScrolling",get:function(){return this._wot.momentumScrolling},set:function(e){this._wot.momentumScrolling=e}},{key:"touchApplied",get:function(){return this._wot.touchApplied},set:function(e){this._wot.touchApplied=e}},{key:"domBindings",get:function(){return this._wot.domBindings}},{key:"eventListeners",get:function(){return this._wot.eventListeners},set:function(e){this._wot.eventListeners=e}},{key:"eventManager",get:function(){return this._wot.eventManager}},{key:"createCellCoords",value:function(e,t){return this._wot.createCellCoords(e,t)}},{key:"createCellRange",value:function(e,t,n){return this._wot.createCellRange(e,t,n)}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(e),this}},{key:"getCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(e,t)}},{key:"scrollViewport",value:function(e,t,n,r,i){return this._wot.scrollViewport(e,t,n,r,i)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return this._wot.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return this._wot.scrollViewportVertically(e,t,n)}},{key:"getViewport",value:function(){return this._wot.getViewport()}},{key:"getOverlayName",value:function(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}},{key:"exportSettingsAsClassNames",value:function(){return this._wot.exportSettingsAsClassNames()}},{key:"update",value:function(e,t){return this._wot.wtSettings.update(e,t),this}},{key:"getSetting",value:function(e,t,n,r,i){return this._wot.wtSettings.getSetting(e,t,n,r,i)}},{key:"hasSetting",value:function(e){return this._wot.wtSettings.hasSetting(e)}},{key:"destroy",value:function(){this._wot.destroy()}}]),e}();function _t(e){var t=e.isShiftKey,n=e.isLeftClick,r=e.isRightClick,i=e.coords,o=e.selection,s=e.controller,a=e.cellCoordsFactory,l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(t&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{var h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0)}}var Ot=new Map([["mousedown",_t],["mouseover",function(e){var t=e.isLeftClick,n=e.coords,r=e.selection,i=e.controller,o=e.cellCoordsFactory;if(t){var s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n)}}],["touchstart",_t]]);function Mt(e,t){var n=t.coords,r=t.selection,i=t.controller,o=t.cellCoordsFactory;Ot.get(e.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:e.shiftKey,isLeftClick:(0,E.pW)(e)||"touchstart"===e.type,isRightClick:(0,E.dO)(e)})}var xt=new WeakMap,Nt=Symbol("rootInstance");function It(e){return e===Nt}function Dt(e){return xt.has(e)}function Ht(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function At(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lt(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,Vt(e,t,"get"))}function Pt(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Vt(e,t,"set"),n),n}function Vt(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Wt=new WeakMap,Ft=new WeakMap,Bt=new WeakMap,Zt=function(){function e(t){(0,S.Z)(this,e),At(this,"instance",void 0),At(this,"eventManager",void 0),At(this,"settings",void 0),At(this,"THEAD",void 0),At(this,"TBODY",void 0),At(this,"_wt",void 0),At(this,"activeWt",void 0),Ht(this,Ft,{writable:!0,value:0}),Ht(this,Bt,{writable:!0,value:0}),At(this,"postponedAdjustElementsSize",!1),this.instance=t,this.eventManager=new d.Z(this.instance),this.settings=this.instance.getSettings(),Wt.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}return(0,T.Z)(e,[{key:"render",value:function(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}},{key:"getCellAtCoords",value:function(e,t){var n=this._wt.getCell(e,t);return n<0?null:n}},{key:"scrollViewport",value:function(e,t,n,r,i){return this._wt.scrollViewport(e,t,n,r,i)}},{key:"scrollViewportHorizontally",value:function(e,t,n){return this._wt.scrollViewportHorizontally(e,t,n)}},{key:"scrollViewportVertically",value:function(e,t,n){return this._wt.scrollViewportVertically(e,t,n)}},{key:"createElements",value:function(){var e=Wt.get(this),t=this.instance,n=t.rootElement,r=t.rootDocument,i=n.getAttribute("style");i&&n.setAttribute("data-originalstyle",i),(0,a.cn)(n,"handsontable"),e.table=r.createElement("TABLE"),(0,a.cn)(e.table,"htCore"),this.instance.getSettings().tableClassName&&(0,a.cn)(e.table,this.instance.getSettings().tableClassName),this.THEAD=r.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}},{key:"registerEvents",value:function(){var e=this,t=Wt.get(this),n=this.instance,r=n.rootElement,i=n.rootDocument,o=n.selection,s=i.documentElement;this.eventManager.addEventListener(r,"mousedown",(function(n){if(t.selectionMouseDown=!0,!e.isTextSelectionAllowed(n.target)){var r=e.instance.rootWindow;(0,a.a7)(r),n.preventDefault(),r.focus()}})),this.eventManager.addEventListener(r,"mouseup",(function(){t.selectionMouseDown=!1})),this.eventManager.addEventListener(r,"mousemove",(function(n){t.selectionMouseDown&&!e.isTextSelectionAllowed(n.target)&&(e.settings.fragmentSelection&&(0,a.a7)(e.instance.rootWindow),n.preventDefault())})),this.eventManager.addEventListener(s,"keyup",(function(e){o.isInProgress()&&!e.shiftKey&&o.finish()})),this.eventManager.addEventListener(s,"mouseup",(function(n){o.isInProgress()&&(0,E.pW)(n)&&o.finish(),t.mouseDown=!1,!(0,a.pV)(i.activeElement)&&(o.isSelected()||o.isSelectedByAnyHeader()||r.contains(n.target)||(0,E.dO)(n))||e.instance.unlisten()})),this.eventManager.addEventListener(s,"contextmenu",(function(e){o.isInProgress()&&(0,E.dO)(e)&&(o.finish(),t.mouseDown=!1)})),this.eventManager.addEventListener(s,"touchend",(function(){o.isInProgress()&&o.finish(),t.mouseDown=!1})),this.eventManager.addEventListener(s,"mousedown",(function(n){var o=n.target,l=n.x||n.clientX,u=n.y||n.clientY,c=n.target;if(!t.mouseDown&&r&&e.instance.view){var h=e.instance.view._wt.wtTable.holder;if(c===h){var d=(0,a.np)(i);if(i.elementFromPoint(l+d,u)!==h||i.elementFromPoint(l,u+d)!==h)return}else for(;c!==s;){if(null===c){if(n.isTargetWebComponent)break;return}if(c===r)return;c=c.parentNode}("function"===typeof e.settings.outsideClickDeselects?e.settings.outsideClickDeselects(o):e.settings.outsideClickDeselects)?e.instance.deselectCell():e.instance.destroyEditor(!1,!1)}})),this.eventManager.addEventListener(t.table,"selectstart",(function(t){e.settings.fragmentSelection||(0,a.u7)(t.target)||t.preventDefault()}))}},{key:"translateFromRenderableToVisualCoords",value:function(e){var t,n=e.row,r=e.col;return(t=this.instance)._createCellCoords.apply(t,(0,s.Z)(this.translateFromRenderableToVisualIndex(n,r)))}},{key:"translateFromRenderableToVisualIndex",value:function(e,t){var n=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===n&&(n=e),null===r&&(r=t),[n,r]}},{key:"countRenderableIndexes",value:function(e,t){var n=Math.min(e.getNotTrimmedIndexesLength(),t),r=e.getNearestNotHiddenIndex(n-1,-1);return null===r?0:e.getRenderableFromVisualIndex(r)+1}},{key:"countRenderableColumns",value:function(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}},{key:"countRenderableRows",value:function(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}},{key:"countNotHiddenRowIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.rowIndexMapper,this.countRenderableRows())}},{key:"countNotHiddenColumnIndexes",value:function(e,t){return this.countNotHiddenIndexes(e,t,this.instance.columnIndexMapper,this.countRenderableColumns())}},{key:"countNotHiddenIndexes",value:function(e,t,n,r){if(isNaN(e)||e<0)return 0;var i=n.getNearestNotHiddenIndex(e,t),o=n.getRenderableFromVisualIndex(i);if(!Number.isInteger(o))return 0;var s=0;return t<0?s=o+1:t>0&&(s=r-o),s}},{key:"countNotHiddenFixedColumnsStart",value:function(){var e=this.instance.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}},{key:"countNotHiddenFixedRowsTop",value:function(){var e=this.instance.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}},{key:"countNotHiddenFixedRowsBottom",value:function(){var e=this.instance.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}},{key:"isMainTableNotFullyCoveredByOverlays",value:function(){var e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>e&&this.instance.countRenderedCols()>t}},{key:"initializeWalkontable",value:function(){var e=this,t=Wt.get(this),n={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:t.table,isDataViewInstance:function(){return Dt(e.instance)},preventOverflow:function(){return e.settings.preventOverflow},preventWheel:function(){return e.settings.preventWheel},stretchH:function(){return e.settings.stretchH},data:function(t,n){var r;return(r=e.instance).getDataAtCell.apply(r,(0,s.Z)(e.translateFromRenderableToVisualIndex(t,n)))},totalRows:function(){return e.countRenderableRows()},totalColumns:function(){return e.countRenderableColumns()},fixedColumnsStart:function(){return e.countNotHiddenFixedColumnsStart()},fixedRowsTop:function(){return e.countNotHiddenFixedRowsTop()},fixedRowsBottom:function(){return e.countNotHiddenFixedRowsBottom()},shouldRenderInlineStartOverlay:function(){return e.settings.fixedColumnsStart>0||n.rowHeaders().length>0},shouldRenderTopOverlay:function(){return e.settings.fixedRowsTop>0||n.columnHeaders().length>0},shouldRenderBottomOverlay:function(){return e.settings.fixedRowsBottom>0},minSpareRows:function(){return e.settings.minSpareRows},renderAllRows:this.settings.renderAllRows,rowHeaders:function(){var t=[];return e.instance.hasRowHeaders()&&t.push((function(t,n){var r=t>=0?e.instance.rowIndexMapper.getVisualFromRenderableIndex(t):t;e.appendRowHeader(r,n)})),e.instance.runHooks("afterGetRowHeaderRenderers",t),Pt(e,Bt,t.length),t},columnHeaders:function(){var t=[];return e.instance.hasColHeaders()&&t.push((function(t,n){var r=t>=0?e.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;e.appendColHeader(r,n)})),e.instance.runHooks("afterGetColumnHeaderRenderers",t),Pt(e,Ft,t.length),t},columnWidth:function(t){var n=e.instance.columnIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getColWidth(null===n?t:n)},rowHeight:function(t){var n=e.instance.rowIndexMapper.getVisualFromRenderableIndex(t);return e.instance.getRowHeight(null===n?t:n)},cellRenderer:function(t,n,r){var i=e.translateFromRenderableToVisualIndex(t,n),s=(0,o.Z)(i,2),a=s[0],l=s[1],u=e.instance.runHooks("modifyGetCellCoords",a,l),c=a,h=l;if(Array.isArray(u)){var d=(0,o.Z)(u,2);c=d[0],h=d[1]}var f=e.instance.getCellMeta(c,h),g=e.instance.colToProp(h),m=e.instance.getDataAtRowProp(c,g);e.instance.hasHook("beforeValueRender")&&(m=e.instance.runHooks("beforeValueRender",m,f)),e.instance.runHooks("beforeRenderer",r,a,l,g,m,f),e.instance.getCellRenderer(f)(e.instance,r,a,l,g,m,f),e.instance.runHooks("afterRenderer",r,a,l,g,m,f)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:function(){return e.settings.fragmentSelection},onWindowResize:function(){e.instance&&!e.instance.isDestroyed&&e.instance.refreshDimensions()},onContainerElementResize:function(){e.instance&&!e.instance.isDestroyed&&e.instance.refreshDimensions()},onCellMouseDown:function(n,r,i,o){var s=e.translateFromRenderableToVisualCoords(r),a={row:!1,column:!1,cell:!1};e.instance.listen(),e.activeWt=o,t.mouseDown=!0,e.instance.runHooks("beforeOnCellMouseDown",n,s,i,a),(0,E.Ty)(n)||(Mt(n,{coords:s,selection:e.instance.selection,controller:a,cellCoordsFactory:function(t,n){return e.instance._createCellCoords(t,n)}}),e.instance.runHooks("afterOnCellMouseDown",n,s,i),e.activeWt=e._wt)},onCellContextMenu:function(n,r,i,o){var s=e.translateFromRenderableToVisualCoords(r);e.activeWt=o,t.mouseDown=!1,e.instance.selection.isInProgress()&&e.instance.selection.finish(),e.instance.runHooks("beforeOnCellContextMenu",n,s,i),(0,E.Ty)(n)||(e.instance.runHooks("afterOnCellContextMenu",n,s,i),e.activeWt=e._wt)},onCellMouseOut:function(t,n,r,i){var o=e.translateFromRenderableToVisualCoords(n);e.activeWt=i,e.instance.runHooks("beforeOnCellMouseOut",t,o,r),(0,E.Ty)(t)||(e.instance.runHooks("afterOnCellMouseOut",t,o,r),e.activeWt=e._wt)},onCellMouseOver:function(n,r,i,o){var s=e.translateFromRenderableToVisualCoords(r),a={row:!1,column:!1,cell:!1};e.activeWt=o,e.instance.runHooks("beforeOnCellMouseOver",n,s,i,a),(0,E.Ty)(n)||(t.mouseDown&&Mt(n,{coords:s,selection:e.instance.selection,controller:a,cellCoordsFactory:function(t,n){return e.instance._createCellCoords(t,n)}}),e.instance.runHooks("afterOnCellMouseOver",n,s,i),e.activeWt=e._wt)},onCellMouseUp:function(t,n,r,i){var o=e.translateFromRenderableToVisualCoords(n);e.activeWt=i,e.instance.runHooks("beforeOnCellMouseUp",t,o,r),(0,E.Ty)(t)||e.instance.isDestroyed||(e.instance.runHooks("afterOnCellMouseUp",t,o,r),e.activeWt=e._wt)},onCellCornerMouseDown:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(t){t.preventDefault(),e.instance.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:function(t,n){return e.beforeRender(t,n)},onDraw:function(t){return e.afterRender(t)},onScrollVertically:function(){return e.instance.runHooks("afterScrollVertically")},onScrollHorizontally:function(){return e.instance.runHooks("afterScrollHorizontally")},onBeforeRemoveCellClassNames:function(){return e.instance.runHooks("beforeRemoveCellClassNames")},onBeforeHighlightingRowHeader:function(t,n,r){var i=e.instance.rowIndexMapper,o=i.getVisualFromRenderableIndex(t),s=e.instance.runHooks("beforeHighlightingRowHeader",o,n,r);return i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:function(t,n,r){var i=e.instance.columnIndexMapper,o=i.getVisualFromRenderableIndex(t),s=e.instance.runHooks("beforeHighlightingColumnHeader",o,n,r);return i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:function(t,n,r){var i,s=e.translateFromRenderableToVisualIndex(t,n),a=(0,o.Z)(s,2),l=a[0],u=a[1],c=e.instance.selection.getSelectedRange(),h=c.size();if(h>0){var d=(null!==r&&void 0!==r?r:0)+1-h,f=c.peekByIndex(d);i=[f.from.row,f.from.col,f.to.row,f.to.col]}return e.instance.runHooks("afterDrawSelection",l,u,i,r)},onBeforeDrawBorders:function(t,n){var r=(0,o.Z)(t,4),i=r[0],s=r[1],a=r[2],l=r[3],u=[e.instance.rowIndexMapper.getVisualFromRenderableIndex(i),e.instance.columnIndexMapper.getVisualFromRenderableIndex(s),e.instance.rowIndexMapper.getVisualFromRenderableIndex(a),e.instance.columnIndexMapper.getVisualFromRenderableIndex(l)];return e.instance.runHooks("beforeDrawBorders",u,n)},onBeforeTouchScroll:function(){return e.instance.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){return e.instance.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(t,n){var r=e.instance.columnIndexMapper.getVisualFromRenderableIndex(n);return e.instance.runHooks("beforeStretchingColumnWidth",t,r)},onModifyRowHeaderWidth:function(t){return e.instance.runHooks("modifyRowHeaderWidth",t)},onModifyGetCellCoords:function(t,n,r){var i=e.instance.rowIndexMapper,s=e.instance.columnIndexMapper,a=n>=0?s.getVisualFromRenderableIndex(n):n,l=t>=0?i.getVisualFromRenderableIndex(t):t,u=e.instance.runHooks("modifyGetCellCoords",l,a,r);if(Array.isArray(u)){var c=(0,o.Z)(u,4),h=c[0],d=c[1],f=c[2],g=c[3];return[h>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(h,1)):h,d>=0?s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(d,1)):d,f>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(f,-1)):f,g>=0?s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(g,-1)):g]}},viewportRowCalculatorOverride:function(t){var n=e.settings.viewportRowRenderingOffset;if("auto"===n&&e.settings.fixedRowsTop&&(n=10),n>0||"auto"===n){var r=e.countRenderableRows(),i=t.startRow,o=t.endRow;if("number"===typeof n)t.startRow=Math.max(i-n,0),t.endRow=Math.min(o+n,r-1);else if("auto"===n){var s=Math.ceil(o/r*12);t.startRow=Math.max(i-s,0),t.endRow=Math.min(o+s,r-1)}}e.instance.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:function(t){var n=e.settings.viewportColumnRenderingOffset;if("auto"===n&&e.settings.fixedColumnsStart&&(n=10),n>0||"auto"===n){var r=e.countRenderableColumns(),i=t.startColumn,o=t.endColumn;if("number"===typeof n&&(t.startColumn=Math.max(i-n,0),t.endColumn=Math.min(o+n,r-1)),"auto"===n){var s=Math.ceil(o/r*6);t.startColumn=Math.max(i-s,0),t.endColumn=Math.min(o+s,r-1)}}e.instance.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:function(){return e.settings.rowHeaderWidth},columnHeaderHeight:function(){var t=e.instance.runHooks("modifyColumnHeaderHeight");return e.settings.columnHeaderHeight||t}};this.instance.runHooks("beforeInitWalkontable",n),this._wt=new kt(n),this.activeWt=this._wt;var r=this._wt.wtTable.spreader,i=this.instance.rootElement.getBoundingClientRect(),a=i.width,l=i.height;this.setLastSize(a,l),this.eventManager.addEventListener(r,"mousedown",(function(e){e.target===r&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(r,"contextmenu",(function(e){e.target===r&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",(function(){e.settings.observeDOMVisibility&&e._wt.drawInterrupted&&(e.instance.forceFullRender=!0,e.render())}))}},{key:"isTextSelectionAllowed",value:function(e){if((0,a.u7)(e))return!0;var t=(0,a.MO)(e,this.instance.view._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!t)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}},{key:"isMouseDown",value:function(){return Wt.get(this).mouseDown}},{key:"isSelectedOnlyCell",value:function(){var e,t;return null!==(e=null===(t=this.instance.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&void 0!==e&&e}},{key:"isCellEdited",value:function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()}},{key:"beforeRender",value:function(e,t){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,t)}},{key:"afterRender",value:function(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}},{key:"appendRowHeader",value:function(e,t){if(t.firstChild){var n=t.firstChild;if(!(0,a.pv)(n,"relative"))return(0,a.cS)(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{var r=this.instance,i=r.rootDocument,o=r.getRowHeader,s=i.createElement("div"),l=i.createElement("span");s.className="relative",l.className="rowHeader",this.updateCellHeader(l,e,o),s.appendChild(l),t.appendChild(s)}this.instance.runHooks("afterGetRowHeader",e,t)}},{key:"appendColHeader",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.instance.getColHeader,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t.firstChild){var i=t.firstChild;(0,a.pv)(i,"relative")?this.updateCellHeader(i.querySelector(".colHeader"),e,n,r):((0,a.cS)(t),this.appendColHeader(e,t,n,r))}else{var o=this.instance.rootDocument,s=o.createElement("div"),l=o.createElement("span");s.className="relative",l.className="colHeader",this.updateCellHeader(l,e,n,r),s.appendChild(l),t.appendChild(s)}this.instance.runHooks("afterGetColHeader",e,t,r)}},{key:"updateCellHeader",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t,o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&((0,a.pv)(e,"colHeader")?i=o.wtTable.columnFilter.sourceToRendered(t):(0,a.pv)(e,"rowHeader")&&(i=o.wtTable.rowFilter.sourceToRendered(t))),i>-1?(0,a.uS)(e,n(t,r)):((0,a.tT)(e,String.fromCharCode(160)),(0,a.cn)(e,"cornerHeader"))}},{key:"maximumVisibleElementWidth",value:function(e){var t=this._wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0}},{key:"maximumVisibleElementHeight",value:function(e){var t=this._wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0}},{key:"setLastSize",value:function(e,t){var n=Wt.get(this),r=[e,t];n.lastWidth=r[0],n.lastHeight=r[1]}},{key:"getLastSize",value:function(){var e=Wt.get(this);return{width:e.lastWidth,height:e.lastHeight}}},{key:"getFirstFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}},{key:"getLastFullyVisibleRow",value:function(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}},{key:"getFirstFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}},{key:"getLastFullyVisibleColumn",value:function(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}},{key:"getColumnHeadersCount",value:function(){return Lt(this,Ft)}},{key:"getRowHeadersCount",value:function(){return Lt(this,Bt)}},{key:"destroy",value:function(){this._wt.destroy(),this.eventManager.destroy()}}]),e}(),jt=Zt,Ut=26;function Yt(e){for(var t,n=e+1,r="";n>0;)t=(n-1)%Ut,r=String.fromCharCode(65+t)+r,n=parseInt((n-t)/Ut,10);return r}function zt(e){var t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&(0,f.Kn)(e[0])&&(t=(0,f.Q8)(e[0]))),t}var Gt=function(){function e(t){(0,S.Z)(this,e);var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.hot=t,this.data=n,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return(0,T.Z)(e,[{key:"modifyRowData",value:function(e){var t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}},{key:"getData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}},{key:"setData",value:function(e){this.data=e}},{key:"getAtColumn",value:function(e){var t=this,n=[];return(0,g.Bk)(this.data,(function(r,i){var o=t.getAtCell(i,e);n.push(o)})),n}},{key:"getAtRow",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=void 0===t&&void 0===n,s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],o?s.forEach((function(t,n){a[n]=r.getAtPhysicalCell(e,n,s)})):(0,b.q4)(t,n,(function(n){a[n-t]=r.getAtPhysicalCell(e,n,s)}));else if((0,f.Kn)(s)||(0,l.mf)(s))if(a=i?[]:{},!o||i){var u=this.countFirstRowKeys()-1;(0,b.q4)(0,u,(function(o){var l=r.colToProp(o);if(o>=(t||0)&&o<=(n||u)&&!Number.isInteger(l)){var c=r.getAtPhysicalCell(e,l,s);i?a.push(c):(0,f.Hn)(a,l,c)}}))}else(0,f._l)(s,(function(t,n){(0,f.Hn)(a,n,r.getAtPhysicalCell(e,n,s))}));return a}},{key:"setAtCell",value:function(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){var r=(0,f.sm)(n);this.hot.runHooks("modifySourceData",e,t,r,"set"),r.isTouched()&&(n=r.value)}Number.isInteger(t)?this.data[e][t]=n:(0,f.Hn)(this.data[e],t,n)}}},{key:"getAtPhysicalCell",value:function(e,t,n){var r=null;if(n&&(r="string"===typeof t?(0,f.$s)(n,t):"function"===typeof t?t(n):n[t]),this.hot.hasHook("modifySourceData")){var i=(0,f.sm)(r);this.hot.runHooks("modifySourceData",e,t,i,"get"),i.isTouched()&&(r=i.value)}return r}},{key:"getAtCell",value:function(e,t){var n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}},{key:"getByRange",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!1,o=null,s=null,a=null,l=null;null===t||null===n?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(t.row,n.row),s=Math.min(t.col,n.col),a=Math.max(t.row,n.row),l=Math.max(t.col,n.col));var u=[];return(0,b.q4)(o,a,(function(t){u.push(i?e.getAtRow(t,void 0,void 0,r):e.getAtRow(t,s,l,r))})),u}},{key:"countRows",value:function(){if(this.hot.hasHook("modifySourceLength")){var e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}},{key:"countFirstRowKeys",value:function(){return zt(this.data)}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}(),Xt=Gt,Kt=n(1752),qt=n(1120),$t=n(908),Qt=function(){function e(){(0,S.Z)(this,e);var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.indexedValues=[],this.initValueOrFn=t}return(0,T.Z)(e,[{key:"getValues",value:function(){return this.indexedValues}},{key:"getValueAtIndex",value:function(e){var t=this.indexedValues;if(e<t.length)return t[e]}},{key:"setValues",value:function(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}},{key:"setValueAtIndex",value:function(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}},{key:"clear",value:function(){this.setDefaultValues()}},{key:"getLength",value:function(){return this.getValues().length}},{key:"setDefaultValues",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,(0,l.mf)(this.initValueOrFn)?(0,b.q4)(t-1,(function(t){return e.indexedValues.push(e.initValueOrFn(t))})):(0,b.q4)(t-1,(function(){return e.indexedValues.push(e.initValueOrFn)})),this.runLocalHooks("change")}},{key:"init",value:function(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}},{key:"insert",value:function(){this.runLocalHooks("change")}},{key:"remove",value:function(){this.runLocalHooks("change")}},{key:"destroy",value:function(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}]),e}();function Jt(e,t,n){return[].concat((0,s.Z)(e.slice(0,t)),(0,s.Z)(n),(0,s.Z)(e.slice(t)))}function en(e,t){return(0,g.w7)(e,(function(e){return!1===t.includes(e)}))}function tn(e,t){return(0,g.Sc)(e,(function(e){return e-t.filter((function(t){return t<e})).length}))}function nn(e,t){var n=t[0],r=t.length;return(0,g.Sc)(e,(function(e){return e>=n?e+r:e}))}(0,f.jB)(Qt,$t.Z);var rn=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(){return(0,S.Z)(this,n),t.call(this,(function(e){return e}))}return(0,T.Z)(n,[{key:"insert",value:function(e,t){var r=nn(this.indexedValues,t);this.indexedValues=Jt(r,e,t),(0,Kt.Z)((0,qt.Z)(n.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){var t=en(this.indexedValues,e);this.indexedValues=tn(t,e),(0,Kt.Z)((0,qt.Z)(n.prototype),"remove",this).call(this,e)}}]),n}(Qt);function on(e,t,n,r){var i=n.length?n[0]:void 0;return[].concat((0,s.Z)(e.slice(0,i)),(0,s.Z)(n.map((function(e,t){return(0,l.mf)(r)?r(e,t):r}))),(0,s.Z)(void 0===i?[]:e.slice(i)))}function sn(e,t){return(0,g.w7)(e,(function(e,n){return!1===t.includes(n)}))}var an=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(){return(0,S.Z)(this,n),t.apply(this,arguments)}return(0,T.Z)(n,[{key:"insert",value:function(e,t){this.indexedValues=on(this.indexedValues,0,t,this.initValueOrFn),(0,Kt.Z)((0,qt.Z)(n.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=sn(this.indexedValues,e),(0,Kt.Z)((0,qt.Z)(n.prototype),"remove",this).call(this,e)}}]),n}(Qt),ln=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(){(0,S.Z)(this,n);var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t.call(this,e)}return(0,T.Z)(n,[{key:"getHiddenIndexes",value:function(){return(0,g.k$)(this.getValues(),(function(e,t,n){return t&&e.push(n),e}),[])}}]),n}(an);function un(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var cn=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(){var e;return(0,S.Z)(this,n),e=t.apply(this,arguments),un((0,R.Z)(e),"orderOfIndexes",[]),e}return(0,T.Z)(n,[{key:"getValues",value:function(){var e=this;return this.orderOfIndexes.map((function(t){return e.indexedValues[t]}))}},{key:"setValues",value:function(e){this.orderOfIndexes=(0,s.Z)(Array(e.length).keys()),(0,Kt.Z)((0,qt.Z)(n.prototype),"setValues",this).call(this,e)}},{key:"setValueAtIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0)}},{key:"clearValue",value:function(e){this.orderOfIndexes=en(this.orderOfIndexes,[e]),(0,l.mf)(this.initValueOrFn)?(0,Kt.Z)((0,qt.Z)(n.prototype),"setValueAtIndex",this).call(this,e,this.initValueOrFn(e)):(0,Kt.Z)((0,qt.Z)(n.prototype),"setValueAtIndex",this).call(this,e,this.initValueOrFn)}},{key:"getLength",value:function(){return this.orderOfIndexes.length}},{key:"setDefaultValues",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,(0,Kt.Z)((0,qt.Z)(n.prototype),"setDefaultValues",this).call(this,e)}},{key:"insert",value:function(e,t){this.indexedValues=on(this.indexedValues,0,t,this.initValueOrFn),this.orderOfIndexes=nn(this.orderOfIndexes,t),(0,Kt.Z)((0,qt.Z)(n.prototype),"insert",this).call(this,e,t)}},{key:"remove",value:function(e){this.indexedValues=sn(this.indexedValues,e),this.orderOfIndexes=en(this.orderOfIndexes,e),this.orderOfIndexes=tn(this.orderOfIndexes,e),(0,Kt.Z)((0,qt.Z)(n.prototype),"remove",this).call(this,e)}},{key:"getEntries",value:function(){var e=this;return this.orderOfIndexes.map((function(t){return[t,e.getValueAtIndex(t)]}))}}]),n}(Qt),hn=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(){(0,S.Z)(this,n);var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t.call(this,e)}return(0,T.Z)(n,[{key:"getTrimmedIndexes",value:function(){return(0,g.k$)(this.getValues(),(function(e,t,n){return t&&e.push(n),e}),[])}}]),n}(an),dn=new Map([["hiding",ln],["index",Qt],["linkedPhysicalIndexToValue",cn],["physicalIndexToValue",an],["trimming",hn]]);var fn=function(){function e(){(0,S.Z)(this,e),this.collection=new Map}return(0,T.Z)(e,[{key:"register",value:function(e,t){var n=this;!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",(function(){return n.runLocalHooks("change",t)})),1)}},{key:"unregister",value:function(e){var t=this.collection.get(e);(0,u.$K)(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),1)}},{key:"unregisterAll",value:function(){var e=this;this.collection.forEach((function(t,n){return e.unregister(n)})),this.collection.clear()}},{key:"get",value:function(e){return(0,u.o8)(e)?Array.from(this.collection.values()):this.collection.get(e)}},{key:"getLength",value:function(){return this.collection.size}},{key:"removeFromEvery",value:function(e){this.collection.forEach((function(t){t.remove(e)}))}},{key:"insertToEvery",value:function(e,t){this.collection.forEach((function(n){n.insert(e,t)}))}},{key:"initEvery",value:function(e){this.collection.forEach((function(t){t.init(e)}))}}]),e}();(0,f.jB)(fn,$t.Z);var gn=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(e,r){var i;return(0,S.Z)(this,n),(i=t.call(this)).mergedValuesCache=[],i.aggregationFunction=e,i.fallbackValue=r,i}return(0,T.Z)(n,[{key:"getMergedValues",value:function(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];for(var e=(0,g.Sc)(this.get(),(function(e){return e.getValues()})),t=[],n=(0,u.$K)(e[0])&&e[0].length||0,r=0;r<n;r+=1){for(var i=[],o=0;o<this.getLength();o+=1)i.push(e[o][r]);t.push(i)}return(0,g.Sc)(t,this.aggregationFunction)}},{key:"getMergedValueAtIndex",value:function(e,t){var n=this.getMergedValues(t)[e];return(0,u.$K)(n)?n:this.fallbackValue}},{key:"updateCache",value:function(){this.mergedValuesCache=this.getMergedValues(!1)}}]),n}(fn);function mn(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function vn(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,pn(e,t,"set"),n),n}function pn(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var yn=new WeakMap,wn=function(){function e(){(0,S.Z)(this,e),mn(this,yn,{writable:!0,value:[]})}return(0,T.Z)(e,[{key:"subscribe",value:function(e){var t;return this.addLocalHook("change",e),this._write(function(e,t){return t.get?t.get.call(e):t.value}(t=this,pn(t,yn,"get"))),this}},{key:"unsubscribe",value:function(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}},{key:"_write",value:function(e){return e.length>0&&this.runLocalHooks("change",e),this}},{key:"_writeInitialChanges",value:function(e){vn(this,yn,e)}}]),e}();function Cn(e,t){for(var n=[],r=0,i=0;r<e.length&&i<t.length;r++,i++)e[r]!==t[i]&&n.push({op:"replace",index:i,oldValue:e[r],newValue:t[i]});for(;r<t.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:t[r]});for(;i<e.length;i++)n.push({op:"remove",index:i,oldValue:e[i],newValue:void 0});return n}function bn(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function Sn(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,En(e,t,"get"))}function Tn(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,En(e,t,"set"),n),n}function En(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}(0,f.jB)(wn,$t.Z);var Rn=new WeakMap,kn=new WeakMap,_n=new WeakMap,On=new WeakMap,Mn=new WeakMap,xn=function(){function e(){(0,S.Z)(this,e);var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).initialIndexValue;bn(this,Rn,{writable:!0,value:new Set}),bn(this,kn,{writable:!0,value:[]}),bn(this,_n,{writable:!0,value:[]}),bn(this,On,{writable:!0,value:!1}),bn(this,Mn,{writable:!0,value:!1}),Tn(this,Mn,null!==t&&void 0!==t&&t)}return(0,T.Z)(e,[{key:"createObserver",value:function(){var e=this,t=new wn;return Sn(this,Rn).add(t),t.addLocalHook("unsubscribe",(function(){Sn(e,Rn).delete(t)})),t._writeInitialChanges(Cn(Sn(this,kn),Sn(this,_n))),t}},{key:"emit",value:function(e){var t=Sn(this,_n);Sn(this,On)&&Sn(this,kn).length===e.length||(0===e.length?e=new Array(t.length).fill(Sn(this,Mn)):Tn(this,kn,new Array(e.length).fill(Sn(this,Mn))),Sn(this,On)||(Tn(this,On,!0),t=Sn(this,kn)));var n=Cn(t,e);Sn(this,Rn).forEach((function(e){return e._write(n)})),Tn(this,_n,e)}}]),e}(),Nn=(new Set,function(){function e(){var t=this;(0,S.Z)(this,e),this.indexesSequence=new rn,this.trimmingMapsCollection=new gn((function(e){return e.some((function(e){return!0===e}))}),!1),this.hidingMapsCollection=new gn((function(e){return e.some((function(e){return!0===e}))}),!1),this.variousMapsCollection=new fn,this.hidingChangesObservable=new xn({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",(function(){t.indexesSequenceChanged=!0,t.updateCache(),t.runLocalHooks("indexesSequenceChange",t.indexesChangeSource),t.runLocalHooks("change",t.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(function(e){t.trimmedIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(function(e){t.hiddenIndexesChanged=!0,t.updateCache(),t.runLocalHooks("change",e,t.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(function(e){t.runLocalHooks("change",e,t.variousMapsCollection)}))}return(0,T.Z)(e,[{key:"suspendOperations",value:function(){this.isBatched=!0}},{key:"resumeOperations",value:function(){this.isBatched=!1,this.updateCache()}},{key:"createChangesObserver",value:function(e){if("hiding"!==e)throw new Error('Unsupported index map type "'.concat(e,'".'));return this.hidingChangesObservable.createObserver()}},{key:"createAndRegisterIndexMap",value:function(e,t,n){return this.registerMap(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!dn.has(e))throw new Error('The provided map type ("'.concat(e,'") does not exist.'));return new(dn.get(e))(t)}(t,n))}},{key:"registerMap",value:function(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error('Map with name "'.concat(e,'" has been already registered.'));t instanceof hn?this.trimmingMapsCollection.register(e,t):t instanceof ln?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);var n=this.getNumberOfIndexes();return n>0&&t.init(n),t}},{key:"unregisterMap",value:function(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}},{key:"unregisterAll",value:function(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}},{key:"getPhysicalFromVisualIndex",value:function(e){var t=this.notTrimmedIndexesCache[e];return(0,u.$K)(t)?t:null}},{key:"getPhysicalFromRenderableIndex",value:function(e){var t=this.renderablePhysicalIndexesCache[e];return(0,u.$K)(t)?t:null}},{key:"getVisualFromPhysicalIndex",value:function(e){var t=this.fromPhysicalToVisualIndexesCache.get(e);return(0,u.$K)(t)?t:null}},{key:"getVisualFromRenderableIndex",value:function(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}},{key:"getRenderableFromVisualIndex",value:function(e){var t=this.fromVisualToRenderableIndexesCache.get(e);return(0,u.$K)(t)?t:null}},{key:"getNearestNotHiddenIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(e))return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;var r=Array.from(this.fromVisualToRenderableIndexesCache.keys()),i=-1;return-1===(i=t>0?r.findIndex((function(t){return t>e})):r.reverse().findIndex((function(t){return t<e})))?n?this.getNearestNotHiddenIndex(e,-t,!1):null:r[i]}},{key:"initToLength",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=(0,s.Z)(new Array(e).keys()),this.notHiddenIndexesCache=(0,s.Z)(new Array(e).keys()),this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}},{key:"fitToLength",value:function(e){var t=this.getNumberOfIndexes();if(e<t){var n=(0,s.Z)(Array(this.getNumberOfIndexes()-e).keys()).map((function(t){return t+e}));this.removeIndexes(n)}else this.insertIndexes(t,e-t)}},{key:"getIndexesSequence",value:function(){return this.indexesSequence.getValues()}},{key:"setIndexesSequence",value:function(e){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}},{key:"getNotTrimmedIndexes",value:function(){var e=this;return!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this.notTrimmedIndexesCache:this.getIndexesSequence().filter((function(t){return!1===e.isTrimmed(t)}))}},{key:"getNotTrimmedIndexesLength",value:function(){return this.getNotTrimmedIndexes().length}},{key:"getNotHiddenIndexes",value:function(){var e=this;return!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this.notHiddenIndexesCache:this.getIndexesSequence().filter((function(t){return!1===e.isHidden(t)}))}},{key:"getNotHiddenIndexesLength",value:function(){return this.getNotHiddenIndexes().length}},{key:"getRenderableIndexes",value:function(){var e=this;return!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter((function(t){return!1===e.isHidden(t)}))}},{key:"getRenderableIndexesLength",value:function(){return this.getRenderableIndexes().length}},{key:"getNumberOfIndexes",value:function(){return this.getIndexesSequence().length}},{key:"moveIndexes",value:function(e,t){var n=this;"number"===typeof e&&(e=[e]);var r=(0,g.Sc)(e,(function(e){return n.getPhysicalFromVisualIndex(e)})),i=this.getNotTrimmedIndexesLength(),o=e.length,s=en(this.getIndexesSequence(),r),a=s.filter((function(e){return!1===n.isTrimmed(e)})),l=s.indexOf(a[a.length-1])+1;if(t+o<i){var u=a[t];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(Jt(s,l,r)),this.indexesChangeSource=void 0}},{key:"isTrimmed",value:function(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}},{key:"isHidden",value:function(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}},{key:"insertIndexes",value:function(e,t){var n=this.getNotTrimmedIndexes()[e],r=(0,u.$K)(n)?n:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),o=(0,g.Sc)(new Array(t).fill(r),(function(e,t){return e+t}));this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,o),this.hidingMapsCollection.insertToEvery(i,o),this.variousMapsCollection.insertToEvery(i,o),this.resumeOperations()}},{key:"removeIndexes",value:function(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}},{key:"updateCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}},{key:"cacheFromPhysicalToVisualIndexes",value:function(){var e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(var t=0;t<e;t+=1){var n=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(n,t)}}},{key:"cacheFromVisualToRenderableIndexes",value:function(){var e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(var t=0;t<e;t+=1){var n=this.getPhysicalFromRenderableIndex(t),r=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(r,t)}}}]),e}());(0,f.jB)(Nn,$t.Z);var In,Dn=n(1131);function Hn(e){var t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);return t?"".concat(t[1].toLowerCase(),"-").concat(t[2].toUpperCase()):e}function An(e){(0,u.$K)(e)&&(0,z.vU)((0,G.e)(In||(In=(0,Y.Z)(['Language with code "','" was not found. You should register particular language \n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'],['Language with code "','" was not found. You should register particular language\\x20\n    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.'])),e))}var Ln=n(3107);var Pn=(0,Ln.Z)("phraseFormatters"),Vn=Pn.register,Wn=Pn.getValues;Vn("pluralize",(function(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e}));var Fn,Bn=n(4942),Zn=n(4782),jn=(Fn={languageCode:"en-US"},(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_NO_ITEMS,"No available options"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_ROW_ABOVE,"Insert row above"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_ROW_BELOW,"Insert row below"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_INSERT_LEFT,"Insert column left"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_INSERT_RIGHT,"Insert column right"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_REMOVE_ROW,["Remove row","Remove rows"]),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_REMOVE_COLUMN,["Remove column","Remove columns"]),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_UNDO,"Undo"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_REDO,"Redo"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_READ_ONLY,"Read only"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_CLEAR_COLUMN,"Clear column"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_ALIGNMENT,"Alignment"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,"Left"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,"Center"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,"Right"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,"Justify"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_ALIGNMENT_TOP,"Top"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,"Middle"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,"Bottom"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_FREEZE_COLUMN,"Freeze column"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,"Unfreeze column"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_BORDERS,"Borders"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_BORDERS_TOP,"Top"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_BORDERS_RIGHT,"Right"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_BORDERS_BOTTOM,"Bottom"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_BORDERS_LEFT,"Left"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_REMOVE_BORDERS,"Remove border(s)"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_ADD_COMMENT,"Add comment"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_EDIT_COMMENT,"Edit comment"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_REMOVE_COMMENT,"Delete comment"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,"Read-only comment"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_MERGE_CELLS,"Merge cells"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_UNMERGE_CELLS,"Unmerge cells"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_COPY,"Copy"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,["Copy with header","Copy with headers"]),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,["Copy with group header","Copy with group headers"]),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,["Copy header only","Copy headers only"]),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_CUT,"Cut"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,"Insert child row"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,"Detach from parent"),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_HIDE_COLUMN,["Hide column","Hide columns"]),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_SHOW_COLUMN,["Show column","Show columns"]),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_HIDE_ROW,["Hide row","Hide rows"]),(0,Bn.Z)(Fn,Zn.CONTEXTMENU_ITEMS_SHOW_ROW,["Show row","Show rows"]),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_NONE,"None"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_EMPTY,"Is empty"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_NOT_EMPTY,"Is not empty"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_EQUAL,"Is equal to"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_NOT_EQUAL,"Is not equal to"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_BEGINS_WITH,"Begins with"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_ENDS_WITH,"Ends with"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_CONTAINS,"Contains"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_NOT_CONTAIN,"Does not contain"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_GREATER_THAN,"Greater than"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,"Greater than or equal to"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_LESS_THAN,"Less than"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,"Less than or equal to"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_BETWEEN,"Is between"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_NOT_BETWEEN,"Is not between"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_AFTER,"After"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_BEFORE,"Before"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_TODAY,"Today"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_TOMORROW,"Tomorrow"),(0,Bn.Z)(Fn,Zn.FILTERS_CONDITIONS_YESTERDAY,"Yesterday"),(0,Bn.Z)(Fn,Zn.FILTERS_VALUES_BLANK_CELLS,"Blank cells"),(0,Bn.Z)(Fn,Zn.FILTERS_DIVS_FILTER_BY_CONDITION,"Filter by condition"),(0,Bn.Z)(Fn,Zn.FILTERS_DIVS_FILTER_BY_VALUE,"Filter by value"),(0,Bn.Z)(Fn,Zn.FILTERS_LABELS_CONJUNCTION,"And"),(0,Bn.Z)(Fn,Zn.FILTERS_LABELS_DISJUNCTION,"Or"),(0,Bn.Z)(Fn,Zn.FILTERS_BUTTONS_SELECT_ALL,"Select all"),(0,Bn.Z)(Fn,Zn.FILTERS_BUTTONS_CLEAR,"Clear"),(0,Bn.Z)(Fn,Zn.FILTERS_BUTTONS_OK,"OK"),(0,Bn.Z)(Fn,Zn.FILTERS_BUTTONS_CANCEL,"Cancel"),(0,Bn.Z)(Fn,Zn.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,"Search"),(0,Bn.Z)(Fn,Zn.FILTERS_BUTTONS_PLACEHOLDER_VALUE,"Value"),(0,Bn.Z)(Fn,Zn.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,"Second value"),Fn),Un=Zn,Yn=jn.languageCode,zn=(0,Ln.Z)("languagesDictionaries"),Gn=zn.register,Xn=zn.getItem,Kn=zn.hasItem,qn=zn.getValues;function $n(e,t){var n=e,r=t;return(0,f.Kn)(e)&&(n=(r=e).languageCode),function(e,t){e!==Yn&&(n=t,r=Xn(Yn),(0,f._l)(r,(function(e,t){(0,u.o8)(n[t])&&(n[t]=e)})));var n,r}(n,r),Gn(n,(0,f.I8)(r)),(0,f.I8)(r)}function Qn(e){return Jn(e)?(0,f.I8)(Xn(e)):null}function Jn(e){return Kn(e)}function er(e,t,n){var r=Qn(e);if(null===r)return null;var i=r[t];if((0,u.o8)(i))return null;var o=function(e,t){var n=e;return(0,g.Bk)(function(){return Wn()}(),(function(r){n=r(e,t)})),n}(i,n);return Array.isArray(o)?o[0]:o}$n(jn);var tr=n(1413),nr="active-header",rr="area",ir="cell",or="fill",sr="header",ar="custom-selection",lr=n(3366);function ur(e,t){if(null==e)return{};var n,r,i=(0,lr.Z)(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var cr=function(){function e(t,n){(0,S.Z)(this,e),n&&(this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}return(0,T.Z)(e,[{key:"registerListeners",value:function(){var e=this,t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",(function(){return e.onMouseDown()})),this.eventManager.addEventListener(t,"mouseup",(function(){return e.onMouseUp()}));for(var n=function(t){var n=e.main.childNodes[t];e.eventManager.addEventListener(n,"mouseenter",(function(n){return e.onMouseEnter(n,e.main.childNodes[t])}))},r=0,i=this.main.childNodes.length;r<i;r++)n(r)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(e,t){if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){e.preventDefault(),(0,E.mM)(e);var n=this,r=this.wot.rootDocument.body,i=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(r,"mousemove",(function e(o){var s;((s=o).clientY<Math.floor(i.top)||s.clientY>Math.ceil(i.top+i.height)||s.clientX<Math.floor(i.left)||s.clientX>Math.ceil(i.left+i.width))&&(n.eventManager.removeEventListener(r,"mousemove",e),t.style.display="block")}))}}},{key:"createBorders",value:function(e){var t=this.wot.rootDocument;this.main=t.createElement("div");var n=["top","start","bottom","end","corner"],r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(var i=0;i<5;i++){var o=n[i],s=t.createElement("div");s.className="wtBorder ".concat(this.settings.className||""),this.settings[o]&&this.settings[o].hide&&(s.className+=" hidden"),(r=s.style).backgroundColor=this.settings[o]&&this.settings[o].color?this.settings[o].color:e.border.color,r.height=this.settings[o]&&this.settings[o].width?"".concat(this.settings[o].width,"px"):"".concat(e.border.width,"px"),r.width=this.settings[o]&&this.settings[o].width?"".concat(this.settings[o].width,"px"):"".concat(e.border.width,"px"),this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),(0,c.K1)()&&this.createMultipleSelectorHandles(),this.disappear();var a=this.wot.wtTable,l=a.bordersHolder;l||((l=t.createElement("div")).className="htBorders",a.bordersHolder=l,a.spreader.appendChild(l)),l.appendChild(this.main)}},{key:"createMultipleSelectorHandles",value:function(){var e=this,t=this.wot.rootDocument;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")};this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};var n={position:"absolute",height:"".concat(40,"px"),width:"".concat(40,"px"),"border-radius":"".concat(parseInt(40/1.5,10),"px")};(0,f._l)(n,(function(t,n){e.selectionHandles.styles.bottomHitArea[n]=t,e.selectionHandles.styles.topHitArea[n]=t}));var r={position:"absolute",height:"".concat(10,"px"),width:"".concat(10,"px"),"border-radius":"".concat(parseInt(10/1.5,10),"px"),background:"#F5F5FF",border:"1px solid #4285c8"};(0,f._l)(r,(function(t,n){e.selectionHandles.styles.bottom[n]=t,e.selectionHandles.styles.top[n]=t})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}},{key:"isPartRange",value:function(e,t){var n=this.wot.selections.createOrGetArea();return!(!n.cellRange||e===n.cellRange.to.row&&t===n.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(e,t,n,r,i,o){var s=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",a=this.selectionHandles.styles,l=a.top,u=a.topHitArea,c=a.bottom,h=a.bottomHitArea,d=parseInt(l.borderWidth,10),f=parseInt(l.width,10),g=parseInt(u.width,10),m=this.wot.wtTable.getWidth(),v=this.wot.wtTable.getHeight();l.top="".concat(parseInt(n-f-1,10),"px"),l[s]="".concat(parseInt(r-f-1,10),"px"),u.top="".concat(parseInt(n-g/4*3,10),"px"),u[s]="".concat(parseInt(r-g/4*3,10),"px");var p=Math.min(parseInt(r+i,10),m-f-2*d),y=Math.min(parseInt(r+i-g/4,10),m-g-2*d);c[s]="".concat(p,"px"),h[s]="".concat(y,"px");var w=Math.min(parseInt(n+o,10),v-f-2*d),C=Math.min(parseInt(n+o-g/4,10),v-g-2*d);c.top="".concat(w,"px"),h.top="".concat(C,"px"),this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(l.display="block",u.display="block",this.isPartRange(e,t)?(c.display="none",h.display="none"):(c.display="block",h.display="block")):(l.display="none",c.display="none",u.display="none",h.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(l.zIndex="9999",u.zIndex="9999"):(l.zIndex="",u.zIndex="")}},{key:"appear",value:function(e){if(!this.disabled){for(var t,n,r,i,s,l,u=this.wot,h=u.wtTable,d=u.rootDocument,f=u.rootWindow,g=h.getRenderedRowsCount(),m=0;m<g;m+=1){var v=h.rowFilter.renderedToSource(m);if(v>=e[0]&&v<=e[2]){t=v,s=e[0];break}}for(var p=g-1;p>=0;p-=1){var y=h.rowFilter.renderedToSource(p);if(y>=e[0]&&y<=e[2]){n=y;break}}for(var w=h.getRenderedColumnsCount(),C=0;C<w;C+=1){var b=h.columnFilter.renderedToSource(C);if(b>=e[1]&&b<=e[3]){r=b,l=e[1];break}}for(var S=w-1;S>=0;S-=1){var T=h.columnFilter.renderedToSource(S);if(T>=e[1]&&T<=e[3]){i=T;break}}if(void 0!==t&&void 0!==r){var E=h.getCell(this.wot.createCellCoords(t,r)),R=t!==n||r!==i,k=R?h.getCell(this.wot.createCellCoords(n,i)):E,_=(0,a.cv)(E),O=R?(0,a.cv)(k):_,M=(0,a.cv)(h.TABLE),x=(0,a.iO)(h.TABLE),N=_.top,I=_.left,D=this.wot.wtSettings.getSetting("rtlMode"),H=0,A=0;if(D){var L=(0,a.iO)(E),P=f.innerWidth-M.left-x;A=I+L-O.left,H=f.innerWidth-I-L-P-1}else A=O.left+(0,a.iO)(k)-I,H=I-M.left-1;if(this.isEntireColumnSelected(t,n)){var V=this.getDimensionsFromHeader("columns",r,i,s,M),W=null;if(V){var F=(0,o.Z)(V,3);W=F[0],H=F[1],A=F[2]}W&&(E=W)}var B=N-M.top-1,Z=O.top+(0,a.Pb)(k)-N;if(this.isEntireRowSelected(r,i)){var j=this.getDimensionsFromHeader("rows",t,n,l,M),U=null;if(j){var Y=(0,o.Z)(j,3);U=Y[0],B=Y[1],Z=Y[2]}U&&(E=U)}var z=(0,a.Dx)(E,f);parseInt(z.borderTopWidth,10)>0&&(B+=1,Z=Z>0?Z-1:0),parseInt(z[D?"borderRightWidth":"borderLeftWidth"],10)>0&&(H+=1,A=A>0?A-1:0);var G=D?"right":"left";this.topStyle.top="".concat(B,"px"),this.topStyle[G]="".concat(H,"px"),this.topStyle.width="".concat(A,"px"),this.topStyle.display="block",this.startStyle.top="".concat(B,"px"),this.startStyle[G]="".concat(H,"px"),this.startStyle.height="".concat(Z,"px"),this.startStyle.display="block";var X=Math.floor(this.settings.border.width/2);this.bottomStyle.top="".concat(B+Z-X,"px"),this.bottomStyle[G]="".concat(H,"px"),this.bottomStyle.width="".concat(A,"px"),this.bottomStyle.display="block",this.endStyle.top="".concat(B,"px"),this.endStyle[G]="".concat(H+A-X,"px"),this.endStyle.height="".concat(Z+1,"px"),this.endStyle.display="block";var K=this.settings.border.cornerVisible;K="function"===typeof K?K(this.settings.layerLevel):K;var q=this.wot.getSetting("onModifyGetCellCoords",n,i),$=n,Q=i;if(q&&Array.isArray(q)){var J=(0,o.Z)(q,4);$=J[2],Q=J[3]}if((0,c.K1)()||!K||this.isPartRange($,Q))this.cornerStyle.display="none";else{this.cornerStyle.top="".concat(B+Z+this.cornerCenterPointOffset-1,"px"),this.cornerStyle[G]="".concat(H+A+this.cornerCenterPointOffset-1,"px"),this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";var ee=(0,a.$g)(h.TABLE),te=ee===f;te&&(ee=d.documentElement);var ne=parseInt(this.cornerDefaultStyle.width,10)/2,re=parseInt(this.cornerDefaultStyle.height,10)/2;if(i===this.wot.getSetting("totalColumns")-1){var ie=te?k.getBoundingClientRect().left:k.offsetLeft;(D?ie-parseInt(this.cornerDefaultStyle.width,10)/2<0:ie+(0,a.iO)(k)+parseInt(this.cornerDefaultStyle.width,10)/2>=(0,a.x9)(ee))&&(this.cornerStyle[G]="".concat(Math.floor(H+A+this.cornerCenterPointOffset-ne),"px"),this.cornerStyle[D?"borderLeftWidth":"borderRightWidth"]=0)}if(n===this.wot.getSetting("totalRows")-1)(te?k.getBoundingClientRect().top:k.offsetTop)+(0,a.Pb)(k)+parseInt(this.cornerDefaultStyle.height,10)/2>=(0,a.WS)(ee)&&(this.cornerStyle.top="".concat(Math.floor(B+Z+this.cornerCenterPointOffset-re),"px"),this.cornerStyle.borderBottomWidth=0);this.cornerStyle.display="block"}(0,c.K1)()&&this.updateMultipleSelectionHandlesPosition(n,i,B,H,A,Z)}else this.disappear()}}},{key:"isEntireColumnSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}},{key:"isEntireRowSelected",value:function(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}},{key:"getDimensionsFromHeader",value:function(e,t,n,r,i){var o=this.wot.wtTable,s=o.wtRootElement.parentNode,l=null,u=null,c=null,h=null,d=null,f=null,g=null,m=null;switch(e){case"rows":l=function(){return o.getRowHeader.apply(o,arguments)},u=function(){return a.Pb.apply(void 0,arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return o.getColumnHeader.apply(o,arguments)},u=function(){return a.iO.apply(void 0,arguments)},c="ht__selection--columns",f="left"}if(s.classList.contains(c)){var v=this.wot.getSetting("columnHeaders").length;if(g=l(t,v-r),m=l(n,v-r),!g||!m)return!1;var p=(0,a.cv)(g),y=(0,a.cv)(m);return g&&m&&(h=p[f]-i[f]-1,d=y[f]+u(m)-p[f]),[g,h,d]}return!1}},{key:"changeBorderStyle",value:function(e,t){var n=this[e].style,r=t[e];!r||r.hide?(0,a.cn)(this[e],"hidden"):((0,a.pv)(this[e],"hidden")&&(0,a.IV)(this[e],"hidden"),n.backgroundColor=r.color,"top"!==e&&"bottom"!==e||(n.height="".concat(r.width,"px")),"start"!==e&&"end"!==e||(n.width="".concat(r.width,"px")))}},{key:"changeBorderToDefaultStyle",value:function(e){var t=1,n="#000",r=this[e].style;r.backgroundColor=n,r.width="".concat(t,"px"),r.height="".concat(t,"px")}},{key:"toggleHiddenClass",value:function(e,t){this.changeBorderToDefaultStyle(e),t?(0,a.cn)(this[e],"hidden"):(0,a.IV)(this[e],"hidden")}},{key:"disappear",value:function(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",(0,c.K1)()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}},{key:"destroy",value:function(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}]),e}(),hr=cr,dr=function(){function e(t,n){(0,S.Z)(this,e),this.settings=t,this.cellRange=n||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}return(0,T.Z)(e,[{key:"getBorder",value:function(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new hr(e,this.settings)),this.instanceBorders[e.guid]}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}},{key:"replace",value:function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}},{key:"clear",value:function(){return this.cellRange=null,this}},{key:"getCorners",value:function(){var e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}},{key:"addClassAtCoords",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=e.wtTable.getCell(this.settings.createCellCoords(t,n));if("object"===typeof o){var s=r;i&&(s=this.classNameGenerator(o),this.classNames.includes(s)||this.classNames.push(s)),(0,a.cn)(o,s)}return this}},{key:"linearClassNameGenerator",value:function(e,t){return function n(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0===t||0===i)return e;var o=i>=0?i:t,s=e,l=0===(o-=1)?e:"".concat(e,"-").concat(o);if((0,a.pv)(r,l)){var u=o+1;s="".concat(e,"-").concat(u)}else s=n(r,o);return s}}},{key:"draw",value:function(e){if(this.isEmpty())this.settings.border&&this.getBorder(e).disappear();else{var t=e.wtTable.getRenderedRowsCount(),n=e.wtTable.getRenderedColumnsCount(),r=this.getCorners(),i=(0,o.Z)(r,4),s=i[0],l=i[1],u=i[2],c=i[3],h=this.settings,d=h.highlightHeaderClassName,f=h.highlightColumnClassName,g=h.highlightRowClassName,m=h.highlightOnlyClosestHeader,v=h.selectionType,p=void 0===v||["active-header","header"].includes(v);if(p&&null!==l&&null!==c)for(var y=0,w=0;w<n;w+=1){var C=e.wtTable.columnFilter.renderedToSource(w);if(C>=l&&C<=c){var b=e.wtTable.getColumnHeaders(C),S=b.length-1;m&&b.length>1&&(b=[b[S]]);for(var T=0;T<b.length;T+=1){var E=[],R=b[T];d&&E.push(d),f&&E.push(f),T=m?S:T;var k=e.getSetting("onBeforeHighlightingColumnHeader",C,T,{selectionType:v,columnCursor:y,selectionWidth:c-l+1,classNames:E});k!==C&&(R=e.wtTable.getColumnHeader(k,T)),(0,a.cn)(R,E)}y+=1}}if(null!==s&&null!==u)for(var _=0,O=0;O<t;O+=1){var M=e.wtTable.rowFilter.renderedToSource(O);if(p&&M>=s&&M<=u){var x=e.wtTable.getRowHeaders(M),N=x.length-1;m&&x.length>1&&(x=[x[N]]);for(var I=0;I<x.length;I+=1){var D=[],H=x[I];d&&D.push(d),g&&D.push(g),I=m?N:I;var A=e.getSetting("onBeforeHighlightingRowHeader",M,I,{selectionType:v,rowCursor:_,selectionHeight:u-s+1,classNames:D});A!==M&&(H=e.wtTable.getRowHeader(A,I)),(0,a.cn)(H,D)}_+=1}if(null!==l&&null!==c)for(var L=0;L<n;L+=1){var P=e.wtTable.columnFilter.renderedToSource(L);M>=s&&M<=u&&P>=l&&P<=c?this.settings.className&&this.addClassAtCoords(e,M,P,this.settings.className,this.settings.markIntersections):M>=s&&M<=u?g&&this.addClassAtCoords(e,M,P,g):P>=l&&P<=c&&f&&this.addClassAtCoords(e,M,P,f);var V=e.getSetting("onAfterDrawSelection",M,P,this.settings.layerLevel);"string"===typeof V&&this.addClassAtCoords(e,M,P,V)}}e.getSetting("onBeforeDrawBorders",r,this.settings.className),this.settings.border&&this.getBorder(e).appear(r)}}},{key:"destroy",value:function(){Object.values(this.instanceBorders).forEach((function(e){return e.destroy()}))}}]),e}();function fr(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gr=function(e){(0,k.Z)(n,e);var t=(0,_.Z)(n);function n(e,r){var i;return(0,S.Z)(this,n),i=t.call(this,e,null),fr((0,R.Z)(i),"visualCellRange",null),i.visualCellRange=r||null,i.commit(),i}return(0,T.Z)(n,[{key:"add",value:function(e){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}},{key:"clear",value:function(){return this.visualCellRange=null,(0,Kt.Z)((0,qt.Z)(n.prototype),"clear",this).call(this)}},{key:"trimToVisibleCellsRangeOnly",value:function(e){var t=e.from,n=e.to,r=this.getNearestNotHiddenCoords(t,1),i=this.getNearestNotHiddenCoords(n,-1);if(null===r||null===i)return null;if(r.row>i.row||r.col>i.col){if(!("header"===this.settings.type||"active-header"===this.settings.type))return null;r=t,i=n}return this.settings.createCellRange(r,r,i)}},{key:"getNearestNotHiddenCoords",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),e.row,t);if(null===r)return null;var i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),e.col,n);return null===i?null:this.settings.createCellCoords(r,i)}},{key:"getNearestNotHiddenIndex",value:function(e,t,n){if(t<0)return t;var r=e.getNearestNotHiddenIndex(t,n);return("header"===this.settings.type||"active-header"===this.settings.type)&&null===r?-1:r}},{key:"commit",value:function(){if(null===this.visualCellRange)return this;var e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===e?null:this.createRenderableCellRange(e.from,e.to),this}},{key:"syncWith",value:function(e){var t="N-S"===e.getVerticalDirection()?1:-1,n="W-E"===e.getHorizontalDirection()?1:-1,r=this.getNearestNotHiddenCoords(e.from.clone().normalize(),t,n);if(null!==r&&e.overlaps(r)){if(null===this.cellRange){var i=this.settings.visualToRenderableCoords(r);this.cellRange=this.settings.createCellRange(i)}return e.setHighlight(r),this}return e.setHighlight(e.from),this}},{key:"getCorners",value:function(){var e=this.cellRange,t=e.from,n=e.to,r=null===t.row||null===n.row,i=null===t.col||null===n.col,o=this.settings.createCellCoords(r?null:Math.min(t.row,n.row),i?null:Math.min(t.col,n.col)),s=this.settings.createCellCoords(r?null:Math.max(t.row,n.row),i?null:Math.max(t.col,n.col));return[o.row,o.col,s.row,s.col]}},{key:"getVisualCorners",value:function(){var e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}},{key:"createRenderableCellRange",value:function(e,t){var n=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(t);return this.settings.createCellRange(n,n,r)}}]),n}(dr),mr=gr,vr=["activeHeaderClassName"];var pr=function(e){var t=e.activeHeaderClassName,n=ur(e,vr);return new mr((0,tr.Z)((0,tr.Z)({highlightHeaderClassName:t},n),{},{selectionType:nr}))},yr=["layerLevel","areaCornerVisible"];var wr=function(e){var t=e.layerLevel,n=e.areaCornerVisible,r=ur(e,yr);return new mr((0,tr.Z)((0,tr.Z)({className:"area",markIntersections:!0,layerLevel:Math.min(t,7),border:{width:1,color:"#4b89ff",cornerVisible:n}},r),{},{selectionType:rr}))},Cr=["cellCornerVisible"];var br=function(e){var t=e.cellCornerVisible,n=ur(e,Cr);return new mr((0,tr.Z)((0,tr.Z)({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:t}},n),{},{selectionType:ir}))},Sr=["border","visualCellRange"];var Tr=function(e){var t=e.border,n=e.visualCellRange,r=ur(e,Sr);return new mr((0,tr.Z)((0,tr.Z)((0,tr.Z)({},t),r),{},{selectionType:ar}),n)};var Er=function(e){var t=Object.assign({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));return new mr((0,tr.Z)((0,tr.Z)({className:"fill",border:{width:1,color:"#ff0000"}},t),{},{selectionType:or}))},Rr=["headerClassName","rowClassName","columnClassName"];var kr=function(e){var t=e.headerClassName,n=e.rowClassName,r=e.columnClassName,i=ur(e,Rr);return new mr((0,tr.Z)((0,tr.Z)({className:"highlight",highlightHeaderClassName:t,highlightRowClassName:n,highlightColumnClassName:r},i),{},{highlightOnlyClosestHeader:!0,selectionType:sr}))},_r=(0,Ln.Z)("highlight/types"),Or=_r.register,Mr=_r.getItem;function xr(e,t){return Mr(e)((0,tr.Z)({type:e},t))}Or(nr,pr),Or(rr,wr),Or(ir,br),Or(ar,Tr),Or(or,Er),Or(sr,kr);var Nr=function(e){function t(e){(0,S.Z)(this,t),this.options=e,this.layerLevel=0,this.cell=xr(ir,e),this.fill=xr(or,e),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}return(0,T.Z)(t,[{key:"isEnabledFor",value:function(e,t){var n=e;e===ir&&(n="current");var r=this.options.disabledCellSelection(t.row,t.col);return"string"===typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(n)}},{key:"useLayerLevel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}},{key:"getCell",value:function(){return this.cell}},{key:"getFill",value:function(){return this.fill}},{key:"createOrGetArea",value:function(){var e,t=this.layerLevel;return this.areas.has(t)?e=this.areas.get(t):(e=xr(rr,(0,tr.Z)({layerLevel:t},this.options)),this.areas.set(t,e)),e}},{key:"getAreas",value:function(){return(0,s.Z)(this.areas.values())}},{key:"createOrGetHeader",value:function(){var e,t=this.layerLevel;return this.headers.has(t)?e=this.headers.get(t):(e=xr(sr,(0,tr.Z)({},this.options)),this.headers.set(t,e)),e}},{key:"getHeaders",value:function(){return(0,s.Z)(this.headers.values())}},{key:"createOrGetActiveHeader",value:function(){var e,t=this.layerLevel;return this.activeHeaders.has(t)?e=this.activeHeaders.get(t):(e=xr(nr,(0,tr.Z)({},this.options)),this.activeHeaders.set(t,e)),e}},{key:"getActiveHeaders",value:function(){return(0,s.Z)(this.activeHeaders.values())}},{key:"getCustomSelections",value:function(){return(0,s.Z)(this.customSelections.values())}},{key:"addCustomSelection",value:function(e){this.customSelections.push(xr(ar,(0,tr.Z)((0,tr.Z)({},this.options),e)))}},{key:"clear",value:function(){this.cell.clear(),this.fill.clear(),(0,g.Bk)(this.areas.values(),(function(e){e.clear()})),(0,g.Bk)(this.headers.values(),(function(e){e.clear()})),(0,g.Bk)(this.activeHeaders.values(),(function(e){e.clear()}))}},{key:e,value:function(){return[this.cell,this.fill].concat((0,s.Z)(this.areas.values()),(0,s.Z)(this.headers.values()),(0,s.Z)(this.activeHeaders.values()),(0,s.Z)(this.customSelections))[Symbol.iterator]()}}]),t}(Symbol.iterator),Ir=Nr,Dr=function(e){function t(e){(0,S.Z)(this,t),this.ranges=[],this.createCellRange=e}return(0,T.Z)(t,[{key:"isEmpty",value:function(){return 0===this.size()}},{key:"set",value:function(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}},{key:"add",value:function(e){return this.ranges.push(this.createCellRange(e)),this}},{key:"pop",value:function(){return this.ranges.pop(),this}},{key:"current",value:function(){return this.peekByIndex(0)}},{key:"previous",value:function(){return this.peekByIndex(-1)}},{key:"includes",value:function(e){return this.ranges.some((function(t){return t.includes(e)}))}},{key:"clear",value:function(){return this.ranges.length=0,this}},{key:"size",value:function(){return this.ranges.length}},{key:"peekByIndex",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.size()+t-1;return n>=0&&(e=this.ranges[n]),e}},{key:e,value:function(){return this.ranges[Symbol.iterator]()}}]),t}(Symbol.iterator),Hr=Dr,Ar=function(){function e(t,n){(0,S.Z)(this,e),this.range=t,this.options=n}return(0,T.Z)(e,[{key:"transformStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.options.createCellCoords(e,t),i=this.range.current().highlight,o=this.options.visualToRenderableCoords(i),s=o.row,a=o.col,l=i,u=0,c=0;if(this.runLocalHooks("beforeTransformStart",r),null!==s&&null!==a){var h=this.options.countRows(),d=this.options.countCols(),f=this.options.fixedRowsBottom(),g=this.options.minSpareRows(),m=this.options.minSpareCols(),v=this.options.autoWrapRow(),p=this.options.autoWrapCol();s+e>h-1?n&&g>0&&!(f&&s>=h-f-1)?(this.runLocalHooks("insertRowRequire",h),h=this.options.countRows()):p&&(r.row=1-h,r.col=a+r.col===d-1?1-d:1):p&&s+r.row<0&&a+r.col>=0&&(r.row=h-1,r.col=a+r.col===0?d-1:-1),a+r.col>d-1?n&&m>0?(this.runLocalHooks("insertColRequire",d),d=this.options.countCols()):v&&(r.row=s+r.row===h-1?1-h:1,r.col=1-d):v&&a+r.col<0&&s+r.row>=0&&(r.row=s+r.row===0?h-1:-1,r.col=d-1);var y=this.options.createCellCoords(s+r.row,a+r.col);u=0,c=0,y.row<0?(u=-1,y.row=0):y.row>0&&y.row>=h&&(u=1,y.row=h-1),y.col<0?(c=-1,y.col=0):y.col>0&&y.col>=d&&(c=1,y.col=d-1),l=this.options.renderableToVisualCoords(y)}return this.runLocalHooks("afterTransformStart",l,u,c),l}},{key:"transformEnd",value:function(e,t){var n=this.options.createCellCoords(e,t),r=this.range.current(),i=r.to,o=0,s=0;this.runLocalHooks("beforeTransformEnd",n);var a=this.options.visualToRenderableCoords(r.highlight),l=a.row,u=a.col;if(null!==l&&null!==u){var c=this.options.countRows(),h=this.options.countCols(),d=this.options.visualToRenderableCoords(r.to),f=d.row,g=d.col,m=this.options.createCellCoords(f+n.row,g+n.col);o=0,s=0,m.row<0?(o=-1,m.row=0):m.row>0&&m.row>=c&&(o=1,m.row=c-1),m.col<0?(s=-1,m.col=0):m.col>0&&m.col>=h&&(s=1,m.col=h-1),i=this.options.renderableToVisualCoords(m)}return this.runLocalHooks("afterTransformEnd",i,o,s),i}}]),e}();(0,f.jB)(Ar,$t.Z);var Lr,Pr=Ar,Vr=0,Wr=1,Fr=2,Br=3,Zr=[Br,Fr],jr=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Ur=Symbol("root"),Yr=Symbol("child");function zr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ur;if(t!==Ur&&t!==Yr)throw new Error("The second argument is used internally only and cannot be overwritten.");var n=Array.isArray(e),r=t===Ur,i=Vr;if(n){var o=e[0];if(0===e.length)i=Wr;else if(r&&o instanceof Ae)i=Br;else if(r&&Array.isArray(o))i=zr(o,Yr);else if(e.length>=2&&e.length<=4){!e.some((function(e,t){return!jr[t].includes(typeof e)}))&&(i=Fr)}}return i}function Gr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.keepDirection,r=void 0!==n&&n,i=t.propToCol;if(!Zr.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(t){var n=e===Br,o=n?t.from.row:t[0],s=n?t.from.col:t[1],a=n?t.to.row:t[2],l=n?t.to.col:t[3];if("function"===typeof i&&("string"===typeof s&&(s=i(s)),"string"===typeof l&&(l=i(l))),(0,u.o8)(a)&&(a=o),(0,u.o8)(l)&&(l=s),!r){var c=o,h=s,d=a,f=l;o=Math.min(c,d),s=Math.min(h,f),a=Math.max(c,d),l=Math.max(h,f)}return[o,s,a,l]}}function Xr(e){return"number"===typeof e&&e>=0&&e<(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0)}var Kr=function(){function e(t,n){var r=this;(0,S.Z)(this,e);var i=this;this.settings=t,this.tableProps=n,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new Hr((function(e,t,n){return r.tableProps.createCellRange(e,t,n)})),this.highlight=new Ir({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,disabledCellSelection:function(e,t){return r.tableProps.isDisabledCellSelection(e,t)},cellCornerVisible:function(){return i.isCellCornerVisible.apply(i,arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible.apply(i,arguments)},visualToRenderableCoords:function(e){return r.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return r.tableProps.renderableToVisualCoords(e)},createCellCoords:function(e,t){return r.tableProps.createCellCoords(e,t)},createCellRange:function(e,t,n){return r.tableProps.createCellRange(e,t,n)},rowIndexMapper:function(){return r.tableProps.rowIndexMapper()},columnIndexMapper:function(){return r.tableProps.columnIndexMapper()}}),this.transformation=new Pr(this.selectedRange,{countRows:function(){return r.tableProps.countRowsTranslated()},countCols:function(){return r.tableProps.countColsTranslated()},visualToRenderableCoords:function(e){return r.tableProps.visualToRenderableCoords(e)},renderableToVisualCoords:function(e){return r.tableProps.renderableToVisualCoords(e)},createCellCoords:function(e,t){return r.tableProps.createCellCoords(e,t)},fixedRowsBottom:function(){return t.fixedRowsBottom},minSpareRows:function(){return t.minSpareRows},minSpareCols:function(){return t.minSpareCols},autoWrapRow:function(){return t.autoWrapRow},autoWrapCol:function(){return t.autoWrapCol}}),this.transformation.addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runLocalHooks.apply(i,["beforeModifyTransformStart"].concat(t))})),this.transformation.addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runLocalHooks.apply(i,["afterModifyTransformStart"].concat(t))})),this.transformation.addLocalHook("beforeTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runLocalHooks.apply(i,["beforeModifyTransformEnd"].concat(t))})),this.transformation.addLocalHook("afterTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runLocalHooks.apply(i,["afterModifyTransformEnd"].concat(t))})),this.transformation.addLocalHook("insertRowRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runLocalHooks.apply(i,["insertRowRequire"].concat(t))})),this.transformation.addLocalHook("insertColRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.runLocalHooks.apply(i,["insertColRequire"].concat(t))}))}return(0,T.Z)(e,[{key:"getSelectedRange",value:function(){return this.selectedRange}},{key:"begin",value:function(){this.inProgress=!0}},{key:"finish",value:function(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}},{key:"isInProgress",value:function(){return this.inProgress}},{key:"setRangeStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="multiple"===this.settings.selectionMode,i=(0,u.o8)(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,o=e.row<0,s=e.col<0,a=o&&s,l=e.clone();this.selectedByCorner=a,this.runLocalHooks("beforeSetRangeStart".concat(n?"Only":""),l),(!r||r&&!i&&(0,u.o8)(t))&&this.selectedRange.clear(),this.selectedRange.add(l),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!a&&s&&this.selectedByRowHeader.add(this.getLayerLevel()),!a&&o&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(e)}},{key:"setRangeStartOnly",value:function(e,t){this.setRangeStart(e,t,!0)}},{key:"setRangeEnd",value:function(e){if(!this.selectedRange.isEmpty()){var t=e.clone();this.runLocalHooks("beforeSetRangeEnd",t),this.begin();var n=this.selectedRange.current();"single"!==this.settings.selectionMode&&n.setTo(this.tableProps.createCellCoords(t.row,t.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(ir,n.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(n);var r=this.getLayerLevel();r<this.highlight.layerLevel&&((0,g.Bk)(this.highlight.getAreas(),(function(e){e.clear()})),(0,g.Bk)(this.highlight.getHeaders(),(function(e){e.clear()})),(0,g.Bk)(this.highlight.getActiveHeaders(),(function(e){e.clear()}))),this.highlight.useLayerLevel(r);var i=this.highlight.createOrGetArea(),o=this.highlight.createOrGetHeader(),s=this.highlight.createOrGetActiveHeader();if(i.clear(),o.clear(),s.clear(),this.highlight.isEnabledFor(rr,n.highlight)&&(this.isMultiple()||r>=1)&&(i.add(n.from).add(n.to).commit(),1===r)){var a=this.selectedRange.previous();this.highlight.useLayerLevel(r-1).createOrGetArea().add(a.from).commit().syncWith(a),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(sr,n.highlight)){var l=0===this.tableProps.countRowsTranslated(),u=0===this.tableProps.countColsTranslated(),c=n;if((l||u)&&(c=n.clone()),l&&(c.from.row=-1),u&&(c.from.col=-1),"single"===this.settings.selectionMode?(this.isSelectedByAnyHeader()&&c.from.normalize(),o.add(c.from).commit()):o.add(c.from).add(c.to).commit(),this.isEntireRowSelected())this.tableProps.countCols()===n.getWidth()&&s.add(this.tableProps.createCellCoords(n.from.row,-1)).add(this.tableProps.createCellCoords(n.to.row,-1)).commit();if(this.isEntireColumnSelected())this.tableProps.countRows()===n.getHeight()&&s.add(this.tableProps.createCellCoords(-1,n.from.col)).add(this.tableProps.createCellCoords(-1,n.to.col)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}}},{key:"isMultiple",value:function(){var e=(0,f.sm)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}},{key:"transformStart",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(e,t,n))}},{key:"transformEnd",value:function(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}},{key:"getLayerLevel",value:function(){return this.selectedRange.size()-1}},{key:"isSelected",value:function(){return!this.selectedRange.isEmpty()}},{key:"isSelectedByRowHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}},{key:"isEntireRowSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}},{key:"isSelectedByColumnHeader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}},{key:"isEntireColumnSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}},{key:"isSelectedByAnyHeader",value:function(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}},{key:"isSelectedByCorner",value:function(){return this.selectedByCorner}},{key:"inInSelection",value:function(e){return this.selectedRange.includes(e)}},{key:"isCellCornerVisible",value:function(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}},{key:"isAreaCornerVisible",value:function(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}},{key:"clear",value:function(){this.selectedRange.clear(),this.highlight.clear()}},{key:"deselect",value:function(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}},{key:"selectAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.tableProps.countRows(),r=this.tableProps.countCols();if(e||t||0!==n&&0!==r){var i=this.tableProps.createCellCoords(t?-1:0,e?-1:0),o=this.tableProps.createCellCoords(n-1,r-1);this.clear(),this.setRangeStartOnly(i),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(o),this.finish()}}},{key:"selectCells",value:function(e){var t=this,n=zr(e);if(n===Wr)return!1;if(n===Vr)throw new Error((0,G.e)(Lr||(Lr=(0,Y.Z)(["Unsupported format of the selection ranges was passed. To select cells pass \n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd, \n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."],["Unsupported format of the selection ranges was passed. To select cells pass\\x20\n        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\\x20\n        columnEnd/columnPropEnd]]) or as an array of CellRange objects."]))));var r=Gr(n,{propToCol:function(e){return t.tableProps.propToCol(e)},keepDirection:!0}),i=this.tableProps.countRows(),s=this.tableProps.countCols(),a=!e.some((function(e){var t=r(e),n=(0,o.Z)(t,4),a=n[0],l=n[1],u=n[2],c=n[3];return!(Xr(a,i)&&Xr(l,s)&&Xr(u,i)&&Xr(c,s))}));return a&&(this.clear(),(0,g.Bk)(e,(function(e){var n=r(e),i=(0,o.Z)(n,4),s=i[0],a=i[1],l=i[2],u=i[3];t.setRangeStartOnly(t.tableProps.createCellCoords(s,a),!1),t.setRangeEnd(t.tableProps.createCellCoords(l,u)),t.finish()}))),a}},{key:"selectColumns",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r="string"===typeof e?this.tableProps.propToCol(e):e,i="string"===typeof t?this.tableProps.propToCol(t):t,o=this.tableProps.countCols(),s=this.tableProps.countRows(),a=Xr(r,o)&&Xr(i,o);return a&&(this.setRangeStartOnly(this.tableProps.createCellCoords(n,r)),this.setRangeEnd(this.tableProps.createCellCoords(s-1,i)),this.finish()),a}},{key:"selectRows",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=Xr(e,r)&&Xr(t,r);return o&&(this.setRangeStartOnly(this.tableProps.createCellCoords(e,n)),this.setRangeEnd(this.tableProps.createCellCoords(t,i-1)),this.finish()),o}},{key:"refresh",value:function(){if(this.highlight.getCustomSelections().forEach((function(e){e.commit()})),this.isSelected()){var e=this.highlight.getCell(),t=this.getLayerLevel();e.commit().syncWith(this.selectedRange.current());for(var n=0;n<this.selectedRange.size();n+=1){this.highlight.useLayerLevel(n);var r=this.highlight.createOrGetArea(),i=this.highlight.createOrGetHeader(),o=this.highlight.createOrGetActiveHeader();r.commit(),i.commit(),o.commit()}this.highlight.useLayerLevel(t)}}}]),e}();(0,f.jB)(Kr,$t.Z);var qr=Kr,$r=n(9679);function Qr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r="string"===typeof t.type?(0,$r.DA)(t.type):t.type;if(e._automaticallyAssignedMetaProps&&(0,f._l)(t,(function(t,n){e._automaticallyAssignedMetaProps.delete(n)})),(0,f.Kn)(r)){n!==e||e._automaticallyAssignedMetaProps||(e._automaticallyAssignedMetaProps=new Set);var i={};(0,f._l)(r,(function(t,r){var o;(function(e,t){var n;return"CELL_TYPE"!==e&&((null===(n=t._automaticallyAssignedMetaProps)||void 0===n?void 0:n.has(e))||!(0,f.nr)(t,e))})(r,n)&&(i[r]=t,null===(o=e._automaticallyAssignedMetaProps)||void 0===o||o.add(r))})),(0,f.l7)(e,i)}}function Jr(e){return Number.isInteger(e)&&e>=0}function ei(e,t){if(!e())throw new Error("Assertion failed: ".concat(t))}function ti(e){return null===e||void 0===e}var ni=function(){return{_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol:function(e){var t,n,r;for(t=0,n=this.countRows();t<n;t++)if(r=this.getDataAtCell(t,e),!1===(0,u.xb)(r))return!1;return!0},isEmptyRow:function(e){var t,n,r,i;for(t=0,n=this.countCols();t<n;t++)if(r=this.getDataAtCell(e,t),!1===(0,u.xb)(r))return"object"===typeof r&&(i=this.getCellMeta(e,t),(0,f.Z1)(this.getSchema()[i.prop],r));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0}};var ri=function(){function e(t){(0,S.Z)(this,e),this.metaCtor=(0,T.Z)((function e(){(0,S.Z)(this,e)})),this.meta=this.metaCtor.prototype,(0,f.l7)(this.meta,ni()),this.meta.instance=t}return(0,T.Z)(e,[{key:"getMetaConstructor",value:function(){return this.metaCtor}},{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){var t;(0,f.l7)(this.meta,e),Qr(this.meta,(0,tr.Z)((0,tr.Z)({},e),{},{type:null!==(t=e.type)&&void 0!==t?t:this.meta.type}),e)}}]),e}(),ii=function(){function e(t){(0,S.Z)(this,e);var n=t.getMetaConstructor();this.meta=new n}return(0,T.Z)(e,[{key:"getMeta",value:function(){return this.meta}},{key:"updateMeta",value:function(e){(0,f.l7)(this.meta,e),Qr(this.meta,e,e)}}]),e}(),oi=function(e){function t(e){(0,S.Z)(this,t),this.valueFactory=e,this.data=[],this.index=[],this.holes=new Set}return(0,T.Z)(t,[{key:"obtain",value:function(e){ei((function(){return Jr(e)}),"Expecting an unsigned number.");var t,n=this._getStorageIndexByKey(e);if(n>=0)void 0===(t=this.data[n])&&(t=this.valueFactory(e),this.data[n]=t);else if(t=this.valueFactory(e),this.holes.size>0){var r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=t,this.index[e]=r}else this.data.push(t),this.index[e]=this.data.length-1;return t}},{key:"insert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;ei((function(){return Jr(e)||ti(e)}),"Expecting an unsigned number or null/undefined argument.");for(var n=[],r=this.data.length,i=0;i<t;i++)n.push(r+i),this.data.push(void 0);var o=ti(e)?this.index.length:e;this.index=[].concat((0,s.Z)(this.index.slice(0,o)),n,(0,s.Z)(this.index.slice(o)))}},{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;ei((function(){return Jr(e)||ti(e)}),"Expecting an unsigned number or null/undefined argument.");for(var n=this.index.splice(ti(e)?this.index.length-t:e,t),r=0;r<n.length;r++){var i=n[r];"number"===typeof i&&this.holes.add(i)}}},{key:"size",value:function(){return this.data.length-this.holes.size}},{key:"values",value:function(){var e=this;return(0,g.w7)(this.data,(function(t,n){return!e.holes.has(n)}))[Symbol.iterator]()}},{key:"entries",value:function(){for(var e=[],t=0;t<this.data.length;t++){var n=this._getKeyByStorageIndex(t);-1!==n&&e.push([n,this.data[t]])}var r=0;return{next:function(){if(r<e.length){var t=e[r];return r+=1,{value:t,done:!1}}return{done:!0}}}}},{key:"clear",value:function(){this.data=[],this.index=[],this.holes.clear()}},{key:"_getStorageIndexByKey",value:function(e){return this.index.length>e?this.index[e]:-1}},{key:"_getKeyByStorageIndex",value:function(e){return this.index.indexOf(e)}},{key:e,value:function(){return this.entries()}}]),t}(Symbol.iterator),si=["data","width"],ai=function(){function e(t){var n=this;(0,S.Z)(this,e),this.globalMeta=t,this.metas=new oi((function(){return n._createMeta()}))}return(0,T.Z)(e,[{key:"updateMeta",value:function(e,t){var n=this.getMeta(e);(0,f.l7)(n,t),Qr(n,t)}},{key:"createColumn",value:function(e,t){this.metas.insert(e,t)}},{key:"removeColumn",value:function(e,t){this.metas.remove(e,t)}},{key:"getMeta",value:function(e){return this.metas.obtain(e)}},{key:"getMetaConstructor",value:function(e){return this.metas.obtain(e).constructor}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createMeta",value:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(){}(0,f.ED)(n,e);for(var r=0;r<t.length;r++)n.prototype[t[r]]=void 0;return n}(this.globalMeta.getMetaConstructor(),si).prototype}}]),e}(),li=function(){function e(t){var n=this;(0,S.Z)(this,e),this.columnMeta=t,this.metas=new oi((function(){return n._createRow()}))}return(0,T.Z)(e,[{key:"updateMeta",value:function(e,t,n){var r=this.getMeta(e,t);(0,f.l7)(r,n),Qr(r,n)}},{key:"createRow",value:function(e,t){this.metas.insert(e,t)}},{key:"createColumn",value:function(e,t){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,t)}},{key:"removeRow",value:function(e,t){this.metas.remove(e,t)}},{key:"removeColumn",value:function(e,t){for(var n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,t)}},{key:"getMeta",value:function(e,t,n){var r=this.metas.obtain(e).obtain(t);return void 0===n?r:r[n]}},{key:"setMeta",value:function(e,t,n,r){var i,o=this.metas.obtain(e).obtain(t);null===(i=o._automaticallyAssignedMetaProps)||void 0===i||i.delete(n),o[n]=r}},{key:"removeMeta",value:function(e,t,n){delete this.metas.obtain(e).obtain(t)[n]}},{key:"getMetas",value:function(){for(var e=[],t=Array.from(this.metas.values()),n=0;n<t.length;n++)e.push.apply(e,(0,s.Z)(t[n].values()));return e}},{key:"getMetasAtRow",value:function(e){ei((function(){return Jr(e)}),"Expecting an unsigned number.");var t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}},{key:"clearCache",value:function(){this.metas.clear()}},{key:"_createRow",value:function(){var e=this;return new oi((function(t){return e._createMeta(t)}))}},{key:"_createMeta",value:function(e){return new(this.columnMeta.getMetaConstructor(e))}}]),e}(),ui=function(){function e(t){var n=this;(0,S.Z)(this,e);var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=t,this.globalMeta=new ri(t),this.tableMeta=new ii(this.globalMeta),this.columnMeta=new ai(this.globalMeta),this.cellMeta=new li(this.columnMeta),i.forEach((function(e){return new e(n)})),this.globalMeta.updateMeta(r)}return(0,T.Z)(e,[{key:"getGlobalMeta",value:function(){return this.globalMeta.getMeta()}},{key:"updateGlobalMeta",value:function(e){this.globalMeta.updateMeta(e)}},{key:"getTableMeta",value:function(){return this.tableMeta.getMeta()}},{key:"updateTableMeta",value:function(e){this.tableMeta.updateMeta(e)}},{key:"getColumnMeta",value:function(e){return this.columnMeta.getMeta(e)}},{key:"updateColumnMeta",value:function(e,t){this.columnMeta.updateMeta(e,t)}},{key:"getCellMeta",value:function(e,t,n){var r=n.visualRow,i=n.visualColumn,o=this.cellMeta.getMeta(e,t);return o.visualRow=r,o.visualCol=i,o.row=e,o.col=t,this.runLocalHooks("afterGetCellMeta",o),o}},{key:"getCellMetaKeyValue",value:function(e,t,n){if("string"!==typeof n)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,n)}},{key:"setCellMeta",value:function(e,t,n,r){this.cellMeta.setMeta(e,t,n,r)}},{key:"updateCellMeta",value:function(e,t,n){this.cellMeta.updateMeta(e,t,n)}},{key:"removeCellMeta",value:function(e,t,n){this.cellMeta.removeMeta(e,t,n)}},{key:"getCellsMeta",value:function(){return this.cellMeta.getMetas()}},{key:"getCellsMetaAtRow",value:function(e){return this.cellMeta.getMetasAtRow(e)}},{key:"createRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}},{key:"removeRow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}},{key:"createColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}},{key:"removeColumn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}},{key:"clearCellsCache",value:function(){this.cellMeta.clearCache()}},{key:"clearCache",value:function(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}]),e}();(0,f.jB)(ui,$t.Z);var ci=function(){function e(t){var n=this;(0,S.Z)(this,e),this.metaManager=t,this.metaSyncMemo=new Map,t.addLocalHook("afterGetCellMeta",(function(e){return n.extendCellMeta(e)})),Dn.Z.getSingleton().add("beforeRender",(function(e){e&&n.metaSyncMemo.clear()}),this.metaManager.hot)}return(0,T.Z)(e,[{key:"extendCellMeta",value:function(e){var t,n=e.row,r=e.col;if(null===(t=this.metaSyncMemo.get(n))||void 0===t||!t.has(r)){var i=e.visualRow,o=e.visualCol,s=this.metaManager.hot,a=s.colToProp(o);e.prop=a,s.runHooks("beforeGetCellMeta",i,o,e);var u,c=(0,f.nr)(e,"type")?e.type:null,h=(0,l.mf)(e.cells)?e.cells(n,r,a):null;if(c)if(h)h.type=null!==(u=h.type)&&void 0!==u?u:c;else h={type:c};h&&this.metaManager.updateCellMeta(n,r,h),s.runHooks("afterGetCellMeta",i,o,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(r)}}}]),e}(),hi=function(){function e(t){(0,S.Z)(this,e),this.metaManager=t,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange:function(e){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===e)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange:function(e,t,n){if(!n)throw new Error("The `".concat(e,"` option can not be updated after the Handsontable is initialized."))}}]]),this.extendMetaProps()}return(0,T.Z)(e,[{key:"extendMetaProps",value:function(){var e=this;this.propDescriptors.forEach((function(t,n){var r=t.target,i=t.onChange,o=void 0===i?function(){}:i,s="string"===typeof r,a=s?r:n,l="_".concat(a);e.metaManager.globalMeta.meta[l]=e.metaManager.globalMeta.meta[a],e.installPropWatcher(n,l,o),s&&e.installPropWatcher(r,l,o)}))}},{key:"installPropWatcher",value:function(e,t,n){var r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get:function(){return this[t]},set:function(i){var o=!r.usageTracker.has(e);r.usageTracker.add(e),n.call(r,e,i,o),this[t]=i},enumerable:!0,configurable:!0})}}]),e}(),di=n(4128),fi=function(){function e(t,n,r){(0,S.Z)(this,e),this.instance=t,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}return(0,T.Z)(e,[{key:"createMap",value:function(){var e=this.getSchema();if("undefined"===typeof e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");var t,n=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,n){var r=0,i=0,o=!1;if("function"===typeof n){var s=(0,f.Q8)(e);r=s>0?s:this.countFirstRowKeys(),o=!0}else{var a=this.tableMeta.maxCols;r=Math.min(a,n.length)}for(t=0;t<r;t++){var l=o?n(t):n[t];if((0,f.Kn)(l)){if("undefined"!==typeof l.data){var u=o?i:t;this.colToPropCache[u]=l.data,this.propToColCache.set(l.data,u)}i+=1}}}else this.recursiveDuckColumns(e)}},{key:"countFirstRowKeys",value:function(){return zt(this.dataSource)}},{key:"recursiveDuckColumns",value:function(e,t,n){var r,i=this,o=t,s=n;return"undefined"===typeof o&&(o=0,s=""),"object"!==typeof e||Array.isArray(e)||(0,f._l)(e,(function(e,t){null===e?(r=s+t,i.colToPropCache.push(r),i.propToColCache.set(r,o),o+=1):o=i.recursiveDuckColumns(e,o,"".concat(t,"."))})),o}},{key:"colToProp",value:function(e){if(!1===Number.isInteger(e))return e;var t=this.instance.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&(0,u.$K)(this.colToPropCache[t])?this.colToPropCache[t]:t}},{key:"propToCol",value:function(e){var t=this.propToColCache.get(e);if((0,u.$K)(t))return this.instance.toVisualColumn(t);var n=this.instance.toVisualColumn(e);return null===n?e:n}},{key:"getSchema",value:function(){var e=this.tableMeta.dataSchema;return e?"function"===typeof e?e():e:this.duckSchema}},{key:"createDuckSchema",value:function(){return this.dataSource&&this.dataSource[0]?(0,f.ie)(this.dataSource[0]):{}}},{key:"refreshDuckSchema",value:function(){this.duckSchema=this.createDuckSchema()}},{key:"createRow",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.source,o=r.mode,s=void 0===o?"above":o,a=this.instance.countSourceRows(),l=a,u=0,c=e;if(("number"!==typeof c||c>=a)&&(c=a),c<this.instance.countRows()&&(l=this.instance.toPhysicalRow(c)),!1===this.instance.runHooks("beforeCreateRow",c,n,i)||null===l)return{delta:0};for(var h=this.tableMeta.maxRows,d=this.getSchema().length,g=[],m=function(){var e=null;"array"===t.instance.dataType?t.tableMeta.dataSchema?e=(0,f.I8)(t.getSchema()):(e=[],(0,b.q4)(d-1,(function(){return e.push(null)}))):"function"===t.instance.dataType?e=t.tableMeta.dataSchema(c+u):(e={},(0,f.ZB)(e,t.getSchema())),g.push(e),u+=1};u<n&&a+u<h;)m();this.instance.rowIndexMapper.insertIndexes(c,u),"below"===s&&(l=Math.min(l+1,a)),this.spliceData(l,0,g);var v=this.instance.toVisualRow(l);return this.instance.countSourceRows()===g.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),u>0&&(void 0===e||null===e?this.metaManager.createRow(null,u):"auto"!==i&&this.metaManager.createRow(l,n)),this.instance.runHooks("afterCreateRow",v,u,i),this.instance.forceFullRender=!0,{delta:u,startPhysicalIndex:l}}},{key:"createCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.source,i=n.mode,o=void 0===i?"start":i;if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var s=this.dataSource,a=this.tableMeta.maxCols,l=this.instance.countSourceCols(),u=e;if(("number"!==typeof u||u>=l)&&(u=l),!1===this.instance.runHooks("beforeCreateCol",u,t,r))return{delta:0};var c=l;u<this.instance.countCols()&&(c=this.instance.toPhysicalColumn(u));var h=this.instance.countSourceRows(),d=this.instance.countCols(),f=0,g=c;"end"===o&&(g=Math.min(g+1,l));for(var m=g;f<t&&d<a;){if("number"!==typeof u||u>=d)if(h>0)for(var v=0;v<h;v+=1)"undefined"===typeof s[v]&&(s[v]=[]),s[v].push(null);else s.push([null]);else for(var p=0;p<h;p++)s[p].splice(g,0,null);f+=1,g+=1,d+=1}this.instance.columnIndexMapper.insertIndexes(u,f),f>0&&(void 0===e||null===e?this.metaManager.createColumn(null,f):"auto"!==r&&this.metaManager.createColumn(m,t));var y=this.instance.toVisualColumn(m);return this.instance.runHooks("afterCreateCol",y,f,r),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:f,startPhysicalIndex:m}}},{key:"removeRow",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n,o=this.visualRowsToPhysical(i,n),s=this.instance.countSourceRows();if(i=(s+i)%s,!1===this.instance.runHooks("beforeRemoveRow",i,o.length,o,r))return!1;var a=o.length;if(this.filterData(i,a,o),i<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(o);var l=(0,u.$K)(this.tableMeta.columns)||(0,u.$K)(this.tableMeta.dataSchema);0===this.instance.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===l&&this.instance.columnIndexMapper.setIndexesSequence([])}var c=o.slice(0).sort((function(e,t){return t-e}));return c.forEach((function(e){t.metaManager.removeRow(e,1)})),this.instance.runHooks("afterRemoveRow",i,a,o,r),this.instance.forceFullRender=!0,!0}},{key:"removeCol",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if("object"===this.instance.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");var r="number"!==typeof e?-t:e;r=(this.instance.countCols()+r)%this.instance.countCols();var i=this.visualColumnsToPhysical(r,t),o=i.slice(0).sort((function(e,t){return t-e}));if(!1===this.instance.runHooks("beforeRemoveCol",r,t,i,n))return!1;for(var s=!0,a=o.length,l=this.dataSource,u=0;u<a;u++)s&&i[0]!==i[u]-u&&(s=!1);if(s)for(var c=0,h=this.instance.countSourceRows();c<h;c++)l[c].splice(i[0],t),0===c&&this.metaManager.removeColumn(i[0],t);else for(var d=0,f=this.instance.countSourceRows();d<f;d++)for(var g=0;g<a;g++)l[d].splice(o[g],1),0===d&&this.metaManager.removeColumn(o[g],1);return r<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(i),0===this.instance.columnIndexMapper.getNotTrimmedIndexesLength()&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",r,t,i,n),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}},{key:"spliceCol",value:function(e,t,n){for(var r=this.instance.getDataAtCol(e),i=r.slice(t,t+n),o=r.slice(t+n),s=arguments.length,a=new Array(s>3?s-3:0),l=3;l<s;l++)a[l-3]=arguments[l];(0,g.g9)(a,o);for(var u=0;u<n;)a.push(null),u+=1;return(0,g.PI)(a),this.instance.populateFromArray(t,e,a,null,null,"spliceCol"),i}},{key:"spliceRow",value:function(e,t,n){for(var r=this.instance.getSourceDataAtRow(e),i=r.slice(t,t+n),o=r.slice(t+n),s=arguments.length,a=new Array(s>3?s-3:0),l=3;l<s;l++)a[l-3]=arguments[l];(0,g.g9)(a,o);for(var u=0;u<n;)a.push(null),u+=1;return this.instance.populateFromArray(e,t,[a],null,null,"spliceRow"),i}},{key:"spliceData",value:function(e,t,n){var r=this;if(!1!==this.instance.runHooks("beforeDataSplice",e,t,n)){var i=[].concat((0,s.Z)(this.dataSource.slice(0,e)),(0,s.Z)(n),(0,s.Z)(this.dataSource.slice(e)));this.dataSource.length=0,i.forEach((function(e){return r.dataSource.push(e)}))}}},{key:"filterData",value:function(e,t,n){var r=this.instance.runHooks("filterData",e,t,n);!1===Array.isArray(r)&&(r=this.dataSource.filter((function(e,t){return-1===n.indexOf(t)}))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}},{key:"get",value:function(e,t){var n=this.instance.toPhysicalRow(e),r=this.dataSource[n],i=this.instance.runHooks("modifyRowData",n),o=null;if((r=isNaN(i)?i:r)&&r.hasOwnProperty&&(0,f.nr)(r,t))o=r[t];else if("string"===typeof t&&t.indexOf(".")>-1){var s=t.split("."),a=r;if(!a)return null;for(var l=0,u=s.length;l<u;l++)if("undefined"===typeof(a=a[s[l]]))return null;o=a}else"function"===typeof t&&(o=t(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){var c=(0,f.sm)(o);this.instance.runHooks("modifyData",n,this.propToCol(t),c,"get"),c.isTouched()&&(o=c.value)}return o}},{key:"getCopyable",value:function(e,t){return this.instance.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}},{key:"set",value:function(e,t,n){var r=this.instance.toPhysicalRow(e),i=n,o=this.dataSource[r],s=this.instance.runHooks("modifyRowData",r);if(o=isNaN(s)?s:o,this.instance.hasHook("modifyData")){var a=(0,f.sm)(i);this.instance.runHooks("modifyData",r,this.propToCol(t),a,"set"),a.isTouched()&&(i=a.value)}if(o&&o.hasOwnProperty&&(0,f.nr)(o,t))o[t]=i;else if("string"===typeof t&&t.indexOf(".")>-1){var l,u=t.split("."),c=o,h=0;for(h=0,l=u.length-1;h<l;h++)"undefined"===typeof c[u[h]]&&(c[u[h]]={}),c=c[u[h]];c[u[h]]=i}else"function"===typeof t?t(this.dataSource.slice(r,r+1)[0],i):o[t]=i}},{key:"visualRowsToPhysical",value:function(e,t){for(var n,r=this.instance.countSourceRows(),i=[],o=(r+e)%r,s=t;o<r&&s;)n=this.instance.toPhysicalRow(o),i.push(n),s-=1,o+=1;return i}},{key:"visualColumnsToPhysical",value:function(e,t){for(var n=this.instance.countCols(),r=[],i=(n+e)%n,o=t;i<n&&o;){var s=this.instance.toPhysicalColumn(i);r.push(s),o-=1,i+=1}return r}},{key:"clear",value:function(){for(var e=0;e<this.instance.countSourceRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")}},{key:"getLength",value:function(){var e,t=this.tableMeta.maxRows;e=t<0||0===t?0:t||1/0;var n=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,e)}},{key:"getAll",value:function(){var t={row:0,col:0},n={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return t.row-n.row!==0||this.instance.countSourceRows()?this.getRange(t,n,e.DESTINATION_RENDERER):[]}},{key:"countCachedColumns",value:function(){return this.colToPropCache.length}},{key:"getRange",value:function(t,n,r){var i,o,s,a=[],l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(0===l||0===u)return[];var c=r===e.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(t.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(t.col,n.col));for(i=Math.min(t.row,n.row);i<=h;i++){s=[];var f=i>=0?this.instance.toPhysicalRow(i):i;for(o=Math.min(t.col,n.col);o<=d&&null!==f;o++)s.push(c.call(this,i,this.colToProp(o)));null!==f&&a.push(s)}return a}},{key:"getText",value:function(t,n){return(0,di.P)(this.getRange(t,n,e.DESTINATION_RENDERER))}},{key:"getCopyableText",value:function(t,n){return(0,di.P)(this.getRange(t,n,e.DESTINATION_CLIPBOARD_GENERATOR))}},{key:"destroy",value:function(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}],[{key:"DESTINATION_RENDERER",get:function(){return 1}},{key:"DESTINATION_CLIPBOARD_GENERATOR",get:function(){return 2}}]),e}(),gi=fi;function mi(e,t,n,r){var i=r.hotInstance,o=r.dataMap,s=r.dataSource,a=r.internalSource,u=r.source,c=r.metaManager,h=r.firstRun,d=(0,C.ct)(a),g=i.getSettings();Array.isArray(g.dataSchema)?i.dataType="array":(0,l.mf)(g.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),e=i.runHooks("before".concat(d),e,h,u);var m=new gi(i,e,c);if(t(m),"object"===typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("".concat(a," only accepts array of objects or array of arrays (").concat(typeof e," given)"));var v,p=m.getSchema();e=[];var y,w=0;for(w=0,y=g.startRows;w<y;w++)if("object"!==i.dataType&&"function"!==i.dataType||!g.dataSchema)if("array"===i.dataType)v=(0,f.I8)(p[0]),e.push(v);else{v=[];for(var b=0,S=g.startCols;b<S;b++)v.push(null);e.push(v)}else v=(0,f.I8)(p),e.push(v)}Array.isArray(e[0])&&(i.dataType="array"),g.data=e,m.dataSource=e,s.data=e,s.dataType=i.dataType,s.colToProp=m.colToProp.bind(m),s.propToCol=m.propToCol.bind(m),s.countCachedColumns=m.countCachedColumns.bind(m),n(m),i.runHooks("after".concat(d),e,h,u),h||(i.runHooks("afterChange",null,a),i.render())}var vi,pi=n(3209),yi=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),wi=function(e){return e.map((function(e){var t=e.toLowerCase();return yi.has(t)?yi.get(t):t})).sort().join("+")},Ci=function(e){return e.toLowerCase()};var bi=["meta","alt","shift","control"],Si=function(){var e=new Set;return{press:function(t){e.add(t)},release:function(t){e.delete(t)},releaseAll:function(){e.clear()},isPressed:function(t){return e.has(t)}}}();var Ti=function(e){var t=e.ownerWindow,n=e.handleEvent,r=e.beforeKeyDown,i=e.afterKeyDown,h=(0,pi.I)({errorIdExists:function(e){return'The "'.concat(e,'" context name is already registered.')}}),d="grid",g=function(){return d},m=function(e){return h.getItem(e)},v=!1,p=function(e,t,n,r,i){var o=function(e){return bi.includes(e)},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return e.altKey&&n.push("alt"),t&&(e.ctrlKey||e.metaKey)?n.push("control/meta"):(e.ctrlKey&&n.push("control"),e.metaKey&&n.push("meta")),e.shiftKey&&n.push("shift"),n},l=function(e){if(!1!==t(e)){var a=n(e);if(229!==e.keyCode&&!1!==a&&!(0,E.Ty)(e)){var l=Ci(e.key),u=[];o(l)?Si.press(l):u=s(e);var h=[l].concat(u);!i(e,h)&&((0,c.eE)()&&u.includes("meta")||!(0,c.eE)()&&u.includes("control"))&&i(e,[l].concat(s(e,!0))),r(e)}}},u=function(e){if(!1!==t(e)){var n=Ci(e.key);!1!==o(n)&&Si.release(n)}},h=function(){Si.releaseAll()};return{mount:function(){for(var t=e;t;)t.document.documentElement.addEventListener("keydown",l),t.document.documentElement.addEventListener("keyup",u),t.document.documentElement.addEventListener("blur",h),t=(0,a.f5)(t)},unmount:function(){for(var t=e;t;)t.document.documentElement.removeEventListener("keydown",l),t.document.documentElement.removeEventListener("keyup",u),t.document.documentElement.removeEventListener("blur",h),t=(0,a.f5)(t)},isPressed:function(e){return Si.isPressed(e)},releasePressedKeys:function(){return Si.releaseAll()}}}(t,n,r,i,(function(e,t){var n=m(g()),r=!1;if(!n.hasShortcut(t))return r;for(var i=n.getShortcuts(t),o=0;o<i.length;o++){var s=i[o],a=s.callback,l=s.runOnlyIf,u=s.preventDefault,c=s.stopPropagation,h=s.captureCtrl;if(!1!==l(e)&&(v=h,r=!1===a(e,t),v=!1,u&&e.preventDefault(),c&&e.stopPropagation(),r))break}return r}));return p.mount(),{addContext:function(e){var t=function(e){var t=(0,pi.I)({errorIdExists:function(t){return'The "'.concat(t,'" shortcut is already registered in the "').concat(e,'" context.')}}),n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.keys,r=e.callback,i=e.group,o=e.runOnlyIf,s=void 0===o?function(){return!0}:o,a=e.captureCtrl,c=void 0!==a&&a,h=e.preventDefault,d=void 0===h||h,f=e.stopPropagation,g=void 0!==f&&f,m=e.relativeToGroup,v=e.position;if((0,u.o8)(i))throw new Error("You need to define the shortcut's group.");if(!1===(0,l.mf)(r))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(n))throw new Error((0,G.e)(vi||(vi=(0,Y.Z)(["Pass the shortcut's keys as an array of arrays, \n      using the KeyboardEvent.key properties: \n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."],["Pass the shortcut\\'s keys as an array of arrays,\\x20\n      using the KeyboardEvent.key properties:\\x20\n      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values."]))));var p={callback:r,group:i,runOnlyIf:s,captureCtrl:c,preventDefault:d,stopPropagation:g};if((0,u.$K)(m)){var y=[m,v];p.relativeToGroup=y[0],p.position=y[1]}n.forEach((function(e){var n=wi(e);if(t.hasItem(n)){var r=t.getItem(n),i=r.findIndex((function(e){return e.group===m}));-1!==i?"before"===v?i-=1:i+=1:i=r.length,r.splice(i,0,p)}else t.addItem(n,[p])}))},r=function(e){var n=wi(e);t.removeItem(n)};return{addShortcut:n,addShortcuts:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach((function(e){(0,f._l)(t,(function(n,r){!1===Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=t[r])})),n(e)}))},getShortcuts:function(e){var n=wi(e),r=t.getItem(n);return(0,u.$K)(r)?r.slice():[]},hasShortcut:function(e){var n=wi(e);return t.hasItem(n)},removeShortcutsByKeys:r,removeShortcutsByGroup:function(e){t.getItems().forEach((function(t){var n=(0,o.Z)(t,2),i=n[0],a=n[1],l=a.filter((function(t){return t.group!==e}));0===l.length?r(function(e){return e.split("+")}(i)):(a.length=0,a.push.apply(a,(0,s.Z)(l)))}))}}}(e);return h.addItem(e,t),t},getActiveContextName:g,getContext:m,setActiveContextName:function(e){d=e},isCtrlPressed:function(){return!v&&(p.isPressed("control")||p.isPressed("meta"))},releasePressedKeys:function(){return p.releasePressedKeys()},destroy:function(){return p.unmount()}}},Ei="gridDefault",Ri=null;new Set;function ki(e,t){var n,r,i,S,T,E=this,R=arguments.length>2&&void 0!==arguments[2]&&arguments[2],k=!1,_=this,O=new d.Z(_),M=!0;It(R)&&function(e){xt.set(e,!0)}(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;var x=null!==(n=null===t||void 0===t?void 0:t.layoutDirection)&&void 0!==n?n:"inherit",N=["rtl","ltr"].includes(x)?x:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",N),this.isRtl=function(){return"rtl"===N},this.isLtr=function(){return!_.isRtl()},this.getDirectionFactor=function(){return _.isLtr()?1:-1},t.language=function(e){var t=Hn(e);return Jn(t)||(t=Yn,An(e)),t}(t.language);var I=new ui(_,t,[ci,hi]),D=I.getTableMeta(),H=I.getGlobalMeta(),A=(0,pi.I)();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),Dt(this)&&(0,u.ge)(t.licenseKey,e),this.guid="ht_".concat((0,C.O1)()),this.columnIndexMapper=new Nn,this.rowIndexMapper=new Nn,this.columnIndexMapper.addLocalHook("indexesSequenceChange",(function(e){_.runHooks("afterColumnSequenceChange",e)})),this.rowIndexMapper.addLocalHook("indexesSequenceChange",(function(e){_.runHooks("afterRowSequenceChange",e)})),i=new Xt(_),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);var L=function(e){var t=e.row,n=e.col;return _._createCellCoords(t>=0?_.rowIndexMapper.getRenderableFromVisualIndex(t):t,n>=0?_.columnIndexMapper.getRenderableFromVisualIndex(n):n)},P=new qr(D,{rowIndexMapper:function(){return _.rowIndexMapper},columnIndexMapper:function(){return _.columnIndexMapper},countCols:function(){return _.countCols()},countRows:function(){return _.countRows()},propToCol:function(e){return r.propToCol(e)},isEditorOpened:function(){return!!_.getActiveEditor()&&_.getActiveEditor().isOpened()},countColsTranslated:function(){return E.view.countRenderableColumns()},countRowsTranslated:function(){return E.view.countRenderableRows()},getShortcutManager:function(){return _.getShortcutManager()},createCellCoords:function(e,t){return _._createCellCoords(e,t)},createCellRange:function(e,t,n){return _._createCellRange(e,t,n)},visualToRenderableCoords:L,renderableToVisualCoords:function(e){var t=e.row,n=e.col;return _._createCellCoords(t>=0?_.rowIndexMapper.getVisualFromRenderableIndex(t):t,n>=0?_.columnIndexMapper.getVisualFromRenderableIndex(n):n)},isDisabledCellSelection:function(e,t){return _.getCellMeta(e,t).disableVisualSelection}});this.selection=P;var V=function(e){e.hiddenIndexesChanged&&E.selection.refresh()};function W(e){var t=Hn(e);Jn(t)?(_.runHooks("beforeLanguageChange",t),H.language=t,_.runHooks("afterLanguageChange",t)):An(e)}function F(e,t){var n="className"===e?_.rootElement:_.table;if(M)(0,a.cn)(n,t);else{var r=[],i=[];H[e]&&(r=Array.isArray(H[e])?H[e]:(0,g.W7)(H[e])),t&&(i=Array.isArray(t)?t:(0,g.W7)(t));var o=(0,g.o0)(r,i),s=(0,g.o0)(i,r);o.length&&(0,a.IV)(n,o),s.length&&(0,a.cn)(n,s)}H[e]=t}function B(){var e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function Z(e){var t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}function j(e,t,n){if(e.length){var i=_.getActiveEditor(),s=new B,l=!0;s.onQueueEmpty=function(e){i&&l&&i.cancelChanges(),n(e)};for(var u=e.length-1;u>=0;u--){var c=(0,o.Z)(e[u],4),h=c[0],d=c[1],f=c[3],g=r.propToCol(d),m=_.getCellMeta(h,g);"numeric"===m.type&&"string"===typeof f&&(0,b.TR)(f)&&(e[u][3]=Z(f)),_.getCellValidator(m)&&(s.addValidatorToQueue(),_.validateCell(e[u][3],m,function(t,n){return function(r){if("boolean"!==typeof r)throw new Error("Validation error: result is not boolean");if(!1===r&&!1===n.allowInvalid){l=!1,e.splice(t,1),n.valid=!0;var i=_.getCell(n.visualRow,n.visualCol);null!==i&&(0,a.IV)(i,D.invalidCellClassName)}s.removeValidatorFormQueue()}}(u,m),t))}s.checkIfQueueIsEmpty()}}function U(e,t){var n=e.length-1;if(!(n<0)){for(;n>=0;n--){var i=!1;if(null!==e[n]){if(null!==e[n][2]&&void 0!==e[n][2]||null!==e[n][3]&&void 0!==e[n][3]){if(D.allowInsertRow)for(;e[n][0]>_.countRows()-1;){if(0===r.createRow(void 0,void 0,{source:t}).delta){i=!0;break}}if("array"===_.dataType&&(!D.columns||0===D.columns.length)&&D.allowInsertColumn)for(;r.propToCol(e[n][1])>_.countCols()-1;){if(0===r.createCol(void 0,void 0,{source:t}).delta){i=!0;break}}i||r.set(e[n][0],e[n][1],e[n][3])}}else e.splice(n,1)}_.forceFullRender=!0,S.adjustRowsAndCols(),_.runHooks("beforeChangeRender",e,t),T.lockEditor(),_._refreshBorders(null),T.unlockEditor(),_.view.adjustElementsSize(),_.runHooks("afterChange",e,t||"edit");var o=_.getActiveEditor();o&&(0,u.$K)(o.refreshValue)&&o.refreshValue()}}function Y(e,t,n){return Array.isArray(e)?e:[[e,t,n]]}function z(e,t){var n=_.getActiveEditor(),r=_.runHooks("beforeChange",e,t||"edit"),i=e.filter((function(e){return null!==e}));return!1===r||0===i.length?(n&&n.cancelChanges(),[]):i}this.columnIndexMapper.addLocalHook("cacheUpdated",V),this.rowIndexMapper.addLocalHook("cacheUpdated",V),this.selection.addLocalHook("beforeSetRangeStart",(function(e){E.runHooks("beforeSetRangeStart",e)})),this.selection.addLocalHook("beforeSetRangeStartOnly",(function(e){E.runHooks("beforeSetRangeStartOnly",e)})),this.selection.addLocalHook("beforeSetRangeEnd",(function(e){E.runHooks("beforeSetRangeEnd",e),e.row<0&&(e.row=E.view._wt.wtTable.getFirstVisibleRow()),e.col<0&&(e.col=E.view._wt.wtTable.getFirstVisibleColumn())})),this.selection.addLocalHook("afterSetRangeEnd",(function(e){var t=(0,f.sm)(!1),n=E.selection.getSelectedRange(),r=n.current(),i=r.from,o=r.to,s=n.size()-1;E.runHooks("afterSelection",i.row,i.col,o.row,o.col,t,s),E.runHooks("afterSelectionByProp",i.row,_.colToProp(i.col),o.row,_.colToProp(o.col),t,s);var l=E.selection.isSelectedByAnyHeader(),u=E.selection.selectedRange.current(),c=!0;k&&(c=!1),t.isTouched()&&(c=!t.value);var h=E.selection.isSelectedByRowHeader(),d=E.selection.isSelectedByColumnHeader();!1!==c&&(l?h?E.view.scrollViewportVertically(_.rowIndexMapper.getRenderableFromVisualIndex(e.row)):d&&E.view.scrollViewportHorizontally(_.columnIndexMapper.getRenderableFromVisualIndex(e.col)):u&&!E.selection.isMultiple()?E.view.scrollViewport(L(u.from)):E.view.scrollViewport(L(e))),h&&d?(0,a.cn)(E.rootElement,["ht__selection--rows","ht__selection--columns"]):h?((0,a.IV)(E.rootElement,"ht__selection--columns"),(0,a.cn)(E.rootElement,"ht__selection--rows")):d?((0,a.IV)(E.rootElement,"ht__selection--rows"),(0,a.cn)(E.rootElement,"ht__selection--columns")):(0,a.IV)(E.rootElement,["ht__selection--rows","ht__selection--columns"]),E._refreshBorders(null)})),this.selection.addLocalHook("afterSelectionFinished",(function(e){var t=e.length-1,n=e[t],r=n.from,i=n.to;E.runHooks("afterSelectionEnd",r.row,r.col,i.row,i.col,t),E.runHooks("afterSelectionEndByProp",r.row,_.colToProp(r.col),i.row,_.colToProp(i.col),t)})),this.selection.addLocalHook("afterIsMultipleSelection",(function(e){var t=E.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)})),this.selection.addLocalHook("beforeModifyTransformStart",(function(e){E.runHooks("modifyTransformStart",e)})),this.selection.addLocalHook("afterModifyTransformStart",(function(e,t,n){E.runHooks("afterModifyTransformStart",e,t,n)})),this.selection.addLocalHook("beforeModifyTransformEnd",(function(e){E.runHooks("modifyTransformEnd",e)})),this.selection.addLocalHook("afterModifyTransformEnd",(function(e,t,n){E.runHooks("afterModifyTransformEnd",e,t,n)})),this.selection.addLocalHook("afterDeselect",(function(){T.destroyEditor(),E._refreshBorders(),(0,a.IV)(E.rootElement,["ht__selection--rows","ht__selection--columns"]),E.runHooks("afterDeselect")})),this.selection.addLocalHook("insertRowRequire",(function(e){E.alter("insert_row_above",e,1,"auto")})),this.selection.addLocalHook("insertColRequire",(function(e){E.alter("insert_col_start",e,1,"auto")})),S={alter:function(e,t){var n,i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0,h=function(e){if(0===e.length)return[];var t=(0,s.Z)(e);return t.sort((function(e,t){var n=(0,o.Z)(e,1)[0],r=(0,o.Z)(t,1)[0];return n===r?0:n>r?1:-1})),(0,g.k$)(t,(function(e,t){var n=(0,o.Z)(t,2),r=n[0],i=n[1],s=e[e.length-1],a=(0,o.Z)(s,2),l=a[0]+a[1];if(r<=l){var u=Math.max(i-(l-r),0);s[1]+=u}else e.push([r,i]);return e}),[t[0]])};switch(e){case"insert_row_below":case"insert_row_above":var d=_.countSourceRows();if(D.maxRows===d)return;var f="insert_row_below"===e?"below":"above";t=null!==(n=t)&&void 0!==n?n:"below"===f?d:0;var m=r.createRow(t,a,{source:l,mode:f}),v=m.delta,p=m.startPhysicalIndex;if(v){var y=P.selectedRange.current(),w=null===y||void 0===y?void 0:y.from,C=null===w||void 0===w?void 0:w.row,b=_.toVisualRow(p);if(P.isSelectedByCorner())_.selectAll();else if((0,u.$K)(C)&&C>=b){var T=y.to,E=T.row,R=T.col,k=w.col;P.isSelectedByRowHeader()&&(k=-1),P.getSelectedRange().pop(),P.setRangeStartOnly(_._createCellCoords(C+v,k),!0),P.setRangeEnd(_._createCellCoords(E+v,R))}else _._refreshBorders()}break;case"insert_col_start":case"insert_col_end":var O="insert_col_end"===e?"end":"start";t=null!==(i=t)&&void 0!==i?i:"end"===O?_.countSourceCols():0;var M=r.createCol(t,a,{source:l,mode:O}),x=M.delta,N=M.startPhysicalIndex;if(x){if(Array.isArray(D.colHeaders)){var I=[_.toVisualColumn(N),0];I.length+=x,Array.prototype.splice.apply(D.colHeaders,I)}var H=P.selectedRange.current(),A=null===H||void 0===H?void 0:H.from,L=null===A||void 0===A?void 0:A.col,V=_.toVisualColumn(N);if(P.isSelectedByCorner())_.selectAll();else if((0,u.$K)(L)&&L>=V){var W=H.to,F=W.row,B=W.col,Z=A.row;P.isSelectedByColumnHeader()&&(Z=-1),P.getSelectedRange().pop(),P.setRangeStartOnly(_._createCellCoords(Z,L+x),!0),P.setRangeEnd(_._createCellCoords(F,B+x))}else _._refreshBorders()}break;case"remove_row":var j=function(e){var t=0;(0,g.Bk)(e,(function(e){var n=(0,o.Z)(e,2),i=n[0],s=n[1],a=(0,u.xb)(i)?_.countRows()-1:Math.max(i-t,0);if(Number.isInteger(i)&&(i=Math.max(i-t,0)),r.removeRow(i,s,l)){var c=_.countRows(),h=D.fixedRowsTop;h>=a+1&&(D.fixedRowsTop-=Math.min(s,h-a));var d=D.fixedRowsBottom;d&&a>=c-d&&(D.fixedRowsBottom-=Math.min(s,d)),t+=s}}))};Array.isArray(t)?j(h(t)):j([[t,a]]),S.adjustRowsAndCols(),_._refreshBorders();break;case"remove_col":var U=function(e){var t=0;(0,g.Bk)(e,(function(e){var n=(0,o.Z)(e,2),i=n[0],s=n[1],a=(0,u.xb)(i)?_.countCols()-1:Math.max(i-t,0),c=_.toPhysicalColumn(a);if(Number.isInteger(i)&&(i=Math.max(i-t,0)),r.removeCol(i,s,l)){var h=D.fixedColumnsStart;h>=a+1&&(D.fixedColumnsStart-=Math.min(s,h-a)),Array.isArray(D.colHeaders)&&("undefined"===typeof c&&(c=-1),D.colHeaders.splice(c,s)),t+=s}}))};Array.isArray(t)?U(h(t)):U([[t,a]]),S.adjustRowsAndCols(),_._refreshBorders();break;default:throw new Error('There is no such action "'.concat(e,'"'))}c||S.adjustRowsAndCols()},adjustRowsAndCols:function(){var e,t=D.minRows,n=D.minSpareRows,i=D.minCols,o=D.minSpareCols;if(0===_.countRows()&&0===_.countCols()&&P.deselect(),t){var s=_.countRows();s<t&&r.createRow(s,t-s,{source:"auto"})}if(n){var a=_.countEmptyRows(!0);if(a<n){var l=n-a,u=Math.min(l,D.maxRows-_.countSourceRows());r.createRow(_.countRows(),u,{source:"auto"})}}(i||o)&&(e=_.countEmptyCols(!0));var c=_.countCols();if(i&&!D.columns&&c<i){var h=i-c;e+=h,r.createCol(c,h,{source:"auto"})}if(o&&!D.columns&&"array"===_.dataType&&e<o){c=_.countCols();var d=o-e,f=Math.min(d,D.maxCols-c);r.createCol(c,f,{source:"auto"})}if(P.isSelected()){var m=_.countRows(),v=_.countCols();(0,g.Bk)(P.selectedRange,(function(e){var t=!1,n=e.from.row,r=e.from.col,i=e.to.row,o=e.to.col;n>m-1?(t=!0,i>(n=m-1)&&(i=n)):i>m-1&&(t=!0,n>(i=m-1)&&(n=i)),r>v-1?(t=!0,o>(r=v-1)&&(o=r)):o>v-1&&(t=!0,r>(o=v-1)&&(r=o)),t&&_.selectCell(n,r,i,o)}))}_.view&&_.view.adjustElementsSize()},populateFromArray:function(e,t,n,r,i){var o,a,l,u,c=[],h={},d=[],m=e.row,v=e.col;if(0===(a=t.length))return!1;var p=0,y=0;switch((0,f.Kn)(n)&&(p=n.col-v+1,y=n.row-m+1),i){case"shift_down":var w=(0,g.jz)(t),C=w.length,b=Math.max(C,p),S=_.getData().slice(m),T=(0,g.jz)(S).slice(v,v+b);for(l=0;l<b;l+=1)if(l<C){for(o=0,a=w[l].length;o<y-a;o+=1)w[l].push(w[l][o%a]);l<T.length?d.push(w[l].concat(T[l])):d.push(w[l].concat(new Array(S.length).fill(null)))}else d.push(w[l%C].concat(T[l]));_.populateFromArray(m,v,(0,g.jz)(d));break;case"shift_right":var E=t.length,R=Math.max(E,y),k=_.getData().slice(m).map((function(e){return e.slice(v)}));for(o=0;o<R;o+=1)if(o<E){for(l=0,u=t[o].length;l<p-u;l+=1)t[o].push(t[o][l%u]);var O;if(o<k.length)for(var M=0;M<k[o].length;M+=1)t[o].push(k[o][M]);else(O=t[o]).push.apply(O,(0,s.Z)(new Array(k[0].length).fill(null)))}else t.push(t[o%a].slice(0,R).concat(k[o]));_.populateFromArray(m,v,t);break;default:h.row=e.row,h.col=e.col;var x,N=0,I=0,H=!0,A=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=t[e%t.length];return null!==n?r[n%r.length]:r},L=t.length,P=n?n.row-e.row+1:0;for(a=n?P:Math.max(L,P),o=0;o<a&&!(n&&h.row>n.row&&P>L||!D.allowInsertRow&&h.row>_.countRows()-1||h.row>=D.maxRows);o++){var V=o-N,W=A(V).length,F=n?n.col-e.col+1:0;if(u=n?F:Math.max(W,F),h.col=e.col,x=_.getCellMeta(h.row,h.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!x.skipRowOnPaste){for(I=0,l=0;l<u&&!(n&&h.col>n.col&&F>W||!D.allowInsertColumn&&h.col>_.countCols()-1||h.col>=D.maxCols);l++)if(x=_.getCellMeta(h.row,h.col),"CopyPaste.paste"!==r&&"Autofill.fill"!==r||!x.skipColumnOnPaste)if(x.readOnly&&"UndoRedo.undo"!==r)h.col+=1;else{var B=A(V,l-I),Z=_.getDataAtCell(h.row,h.col);if(null!==B&&"object"===typeof B)if(Array.isArray(B)&&null===Z&&(Z=[]),null===Z||"object"!==typeof Z)H=!1;else{var j=(0,f.ie)(Array.isArray(Z)?Z:Z[0]||Z),U=(0,f.ie)(Array.isArray(B)?B:B[0]||B);(0,f.Z1)(j,U)||Array.isArray(j)&&Array.isArray(U)?B=(0,f.I8)(B):H=!1}else null!==Z&&"object"===typeof Z&&(H=!1);H&&c.push([h.row,h.col,B]),H=!0,h.col+=1}else I+=1,h.col+=1,u+=1;h.row+=1}else N+=1,h.row+=1,a+=1}_.setDataAtCell(c,null,null,r||"populateFromArray")}}},this.init=function(){i.setData(D.data),_.runHooks("beforeInit"),((0,c.K1)()||(0,c.L)())&&(0,a.cn)(_.rootElement,"mobile"),this.updateSettings(D,!0),this.view=new jt(this),T=h.ZP.getInstance(_,D,P),_.runHooks("init"),this.forceFullRender=!0,this.view.render(),M&&null===_.rootElement.offsetParent&&(0,a.TT)(_.rootElement,(function(){_.view._wt.wtOverlays.updateLastSpreaderSize(),_.render(),_.view.adjustElementsSize()})),"object"===typeof M&&(_.runHooks("afterChange",M[0],M[1]),M=!1),_.runHooks("afterInit")},this._createCellCoords=function(e,t){return _.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,n){return _.view._wt.createCellRange(e,t,n)},this.validateCell=function(e,t,n,r){var i,o=_.getCellValidator(t);function s(e){if((!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&!0!==t.hidden){var r=t.visualCol,i=t.visualRow,o=_.getCell(i,r,!0);if(o&&"TH"!==o.nodeName){var s=_.rowIndexMapper.getRenderableFromVisualIndex(i),a=_.columnIndexMapper.getRenderableFromVisualIndex(r);_.view._wt.getSetting("cellRenderer",s,a,o)}n(e)}else n(e)}(0,u.Kj)(o)&&(i=o,o=function(e,t){t(i.test(e))}),(0,l.mf)(o)?(e=_.runHooks("beforeValidate",e,t.visualRow,t.prop,r),_._registerImmediate((function(){o.call(t,e,(function(n){_&&(n=_.runHooks("afterValidate",n,e,t.visualRow,t.prop,r),t.valid=n,s(n),_.runHooks("postAfterValidate",n,e,t.visualRow,t.prop,r))}))}))):_._registerImmediate((function(){t.valid=!0,s(t.valid,!1)}))},this.setDataAtCell=function(e,t,n,o){var s,a,l,u=Y(e,t,n),c=[],h=o;for(s=0,a=u.length;s<a;s++){if("object"!==typeof u[s])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!==typeof u[s][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");l=u[s][1]>=this.countCols()?u[s][1]:r.colToProp(u[s][1]),c.push([u[s][0],l,i.getAtCell(this.toPhysicalRow(u[s][0]),u[s][1]),u[s][2]])}h||"object"!==typeof e||(h=t);var d=z(c,o);_.runHooks("afterSetDataAtCell",d,h),j(d,h,(function(){U(d,h)}))},this.setDataAtRowProp=function(e,t,n,r){var o,s,a=Y(e,t,n),l=[],u=r;for(o=0,s=a.length;o<s;o++)l.push([a[o][0],a[o][1],i.getAtCell(this.toPhysicalRow(a[o][0]),a[o][1]),a[o][2]]);u||"object"!==typeof e||(u=t);var c=z(l,r);_.runHooks("afterSetDataAtRowProp",c,u),j(c,u,(function(){U(c,u)}))},this.listen=function(){_&&!_.isListening()&&(Ri=_.guid,_.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Ri=null,_.runHooks("afterUnlisten"))},this.isListening=function(){return Ri===_.guid},this.destroyEditor=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];_._refreshBorders(e,t)},this.populateFromArray=function(e,t,n,r,i,o,s){if("object"!==typeof n||"object"!==typeof n[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");var a="number"===typeof r?_._createCellCoords(r,i):null;return S.populateFromArray(_._createCellCoords(e,t),n,a,o,s)},this.spliceCol=function(e,t,n){for(var i,o=arguments.length,s=new Array(o>3?o-3:0),a=3;a<o;a++)s[a-3]=arguments[a];return(i=r).spliceCol.apply(i,[e,t,n].concat(s))},this.spliceRow=function(e,t,n){for(var i,o=arguments.length,s=new Array(o>3?o-3:0),a=3;a<o;a++)s[a-3]=arguments[a];return(i=r).spliceRow.apply(i,[e,t,n].concat(s))},this.getSelected=function(){if(P.isSelected())return(0,g.Sc)(P.getSelectedRange(),(function(e){var t=e.from,n=e.to;return[t.row,t.col,n.row,n.col]}))},this.getSelectedLast=function(){var e,t=this.getSelected();return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(P.isSelected())return Array.from(P.getSelectedRange())},this.getSelectedRangeLast=function(){var e,t=this.getSelectedRange();return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(e){var t=this;if(P.isSelected()&&0!==this.countRows()&&0!==this.countCols()){var n=[];(0,g.Bk)(P.getSelectedRange(),(function(e){var r=e.getTopStartCorner(),i=e.getBottomEndCorner();(0,b.q4)(r.row,i.row,(function(e){(0,b.q4)(r.col,i.col,(function(r){t.getCellMeta(e,r).readOnly||n.push([e,r,null])}))}))})),n.length>0&&this.setDataAtCell(n,e)}},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){var e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(T.lockEditor(),this._refreshBorders(null),T.unlockEditor()))},this.batchRender=function(e){this.suspendRender();var t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();var n=e();return this.resumeExecution(t),n},this.batch=function(e){this.suspendRender(),this.suspendExecution();var t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(_.view){var e=_.view.getLastSize(),t=e.width,n=e.height,r=_.rootElement.getBoundingClientRect(),i=r.width,o=r.height,s=i!==t||o!==n;!1===_.runHooks("beforeRefreshDimensions",{width:t,height:n},{width:i,height:o},s)||((s||_.view._wt.wtOverlays.scrollableElement===_.rootWindow)&&(_.view.setLastSize(i,o),_.render()),_.runHooks("afterRefreshDimensions",{width:t,height:n},{width:i,height:o},s))}},this.updateData=function(e,t){var n=this;mi(e,(function(e){r=e}),(function(e){r=e,_.columnIndexMapper.fitToLength(n.getInitialColumnCount()),_.rowIndexMapper.fitToLength(n.countSourceRows()),S.adjustRowsAndCols()}),{hotInstance:_,dataMap:r,dataSource:i,internalSource:"updateData",source:t,metaManager:I,firstRun:M})},this.loadData=function(e,t){mi(e,(function(e){r=e}),(function(){I.clearCellsCache(),_.initIndexMappers(),S.adjustRowsAndCols(),M&&(M=[null,"loadData"])}),{hotInstance:_,dataMap:r,dataSource:i,internalSource:"loadData",source:t,metaManager:I,firstRun:M})},this.getInitialColumnCount=function(){var e=D.columns,t=0;if(Array.isArray(e))t=e.length;else if((0,l.mf)(e))if("array"===_.dataType)for(var n=this.countSourceCols(),i=0;i<n;i+=1)e(i)&&(t+=1);else"object"!==_.dataType&&"function"!==_.dataType||(t=r.colToPropCache.length);else if((0,u.$K)(D.dataSchema)){var o=r.getSchema();t=Array.isArray(o)?o.length:(0,f.Q8)(o)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,n,i){return(0,u.o8)(e)?r.getAll():r.getRange(_._createCellCoords(e,t),_._createCellCoords(n,i),r.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,n,i){return r.getCopyableText(_._createCellCoords(e,t),_._createCellCoords(n,i))},this.getCopyableData=function(e,t){return r.getCopyable(e,r.colToProp(t))},this.getSchema=function(){return r.getSchema()},this.updateSettings=function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=(M?_.loadData:_.updateData).bind(this),s=!1;if((0,u.$K)(e.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if((0,u.$K)(e.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if((0,u.$K)(e.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(t in e)"data"===t||("language"===t?W(e.language):"className"===t?F("className",e.className):"tableClassName"===t&&_.table?(F("tableClassName",e.tableClassName),_.view._wt.wtOverlays.syncOverlayTableClassNames()):Dn.Z.getSingleton().isRegistered(t)||Dn.Z.getSingleton().isDeprecated(t)?((0,l.mf)(e[t])||Array.isArray(e[t]))&&(e[t].initialHook=!0,_.addHook(t,e[t])):!i&&(0,f.nr)(e,t)&&(H[t]=e[t]));void 0===e.data&&void 0===D.data?o(null,"updateSettings"):void 0!==e.data?o(e.data,"updateSettings"):void 0!==e.columns&&(r.createMap(),_.initIndexMappers());var a=_.countCols(),c=D.columns;if(c&&(0,l.mf)(c)&&(s=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||I.clearCache(),a>0)for(t=0,n=0;t<a;t++){if(c){var h=s?c(t):c[n];h&&I.updateColumnMeta(n,h)}n+=1}(0,u.$K)(e.cell)&&(0,f._l)(e.cell,(function(e){_.setCellMetaObject(e.row,e.col,e)})),_.runHooks("afterCellMetaReset");var d=_.rootElement.style.height;""!==d&&(d=parseInt(_.rootElement.style.height,10));var g=e.height;((0,l.mf)(g)&&(g=g()),i)&&(_.rootElement.getAttribute("style")&&_.rootElement.setAttribute("data-initialstyle",_.rootElement.getAttribute("style")));if(null===g){var m=_.rootElement.getAttribute("data-initialstyle");m&&(m.indexOf("height")>-1||m.indexOf("overflow")>-1)?_.rootElement.setAttribute("style",m):(_.rootElement.style.height="",_.rootElement.style.overflow="")}else void 0!==g&&(_.rootElement.style.height=isNaN(g)?"".concat(g):"".concat(g,"px"),_.rootElement.style.overflow="hidden");if("undefined"!==typeof e.width){var v=e.width;(0,l.mf)(v)&&(v=v()),_.rootElement.style.width=isNaN(v)?"".concat(v):"".concat(v,"px")}i||(_.view&&(_.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),_.view._wt.exportSettingsAsClassNames()),_.runHooks("afterUpdateSettings",e)),S.adjustRowsAndCols(),_.view&&!M&&(_.forceFullRender=!0,T.lockEditor(),_._refreshBorders(null),_.view._wt.wtOverlays.adjustElementsSize(),T.unlockEditor()),i||!_.view||""!==d&&""!==g&&void 0!==g||d===g||_.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var e=_.getSelectedLast();if(D.getValue){if((0,l.mf)(D.getValue))return D.getValue.call(_);if(e)return _.getData()[e[0][0]][D.getValue]}else if(e)return _.getDataAtCell(e[0],e[1])},this.getSettings=function(){return D},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,n,r,i){S.alter(e,t,n,r,i)},this.getCell=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t,i=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;i=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===i||null===r?null:_.view.getCellAtCoords(_._createCellCoords(i,r),n)},this.getCoords=function(e){var t=this.view._wt.wtTable.getCoords(e);if(null===t)return null;var n=t.row,r=t.col,i=n,o=r;return n>=0&&(i=this.rowIndexMapper.getVisualFromRenderableIndex(n)),r>=0&&(o=this.columnIndexMapper.getVisualFromRenderableIndex(r)),_._createCellCoords(i,o)},this.colToProp=function(e){return r.colToProp(e)},this.propToCol=function(e){return r.propToCol(e)},this.toVisualRow=function(e){return E.rowIndexMapper.getVisualFromPhysicalIndex(e)},this.toVisualColumn=function(e){return E.columnIndexMapper.getVisualFromPhysicalIndex(e)},this.toPhysicalRow=function(e){return E.rowIndexMapper.getPhysicalFromVisualIndex(e)},this.toPhysicalColumn=function(e){return E.columnIndexMapper.getPhysicalFromVisualIndex(e)},this.getDataAtCell=function(e,t){return r.get(e,r.colToProp(t))},this.getDataAtRowProp=function(e,t){return r.get(e,t)},this.getDataAtCol=function(e){for(var t=[],n=r.getRange(_._createCellCoords(0,e),_._createCellCoords(D.data.length-1,e),r.DESTINATION_RENDERER),i=0;i<n.length;i+=1)for(var o=0;o<n[i].length;o+=1)t.push(n[i][o]);return t},this.getDataAtProp=function(e){for(var t=[],n=r.getRange(_._createCellCoords(0,r.propToCol(e)),_._createCellCoords(D.data.length-1,r.propToCol(e)),r.DESTINATION_RENDERER),i=0;i<n.length;i+=1)for(var o=0;o<n[i].length;o+=1)t.push(n[i][o]);return t},this.getSourceData=function(e,t,n,r){return void 0===e?i.getData():i.getByRange(_._createCellCoords(e,t),_._createCellCoords(n,r))},this.getSourceDataArray=function(e,t,n,r){return void 0===e?i.getData(!0):i.getByRange(_._createCellCoords(e,t),_._createCellCoords(n,r),!0)},this.getSourceDataAtCol=function(e){return i.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,n,r){var s=Y(e,t,n),a=this.hasHook("afterSetSourceDataAtCell"),l=[];a&&(0,g.Bk)(s,(function(e){var t=(0,o.Z)(e,3),n=t[0],r=t[1],s=t[2];l.push([n,r,i.getAtCell(n,r),s])})),(0,g.Bk)(s,(function(e){var t=(0,o.Z)(e,3),n=t[0],r=t[1],s=t[2];i.setAtCell(n,r,s)})),a&&this.runHooks("afterSetSourceDataAtCell",l,r),this.render();var c=_.getActiveEditor();c&&(0,u.$K)(c.refreshValue)&&c.refreshValue()},this.getSourceDataAtRow=function(e){return i.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return i.getAtCell(e,t)},this.getDataAtRow=function(e){return r.getRange(_._createCellCoords(e,0),_._createCellCoords(e,this.countCols()-1),r.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,n,r){var i=this,o=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,n,r],s=o[0],a=o[1],l=o[2],u=o[3],c=null,h=null;void 0===l&&(l=s),void 0===u&&(u=a);var d="mixed";return(0,b.q4)(Math.max(Math.min(s,l),0),Math.max(s,l),(function(e){var t=!0;return(0,b.q4)(Math.max(Math.min(a,u),0),Math.max(a,u),(function(n){var r=i.getCellMeta(e,n);return h=r.type,c?t=c===h:c=h,t})),d=t?h:"mixed",t})),d},this.removeCellMeta=function(e,t,n){var r=[this.toPhysicalRow(e),this.toPhysicalColumn(t)],i=r[0],o=r[1],s=I.getCellMetaKeyValue(i,o,n);!1!==_.runHooks("beforeRemoveCellMeta",e,t,n,s)&&(I.removeCellMeta(i,o,n),_.runHooks("afterRemoveCellMeta",e,t,n,s)),s=null},this.spliceCellsMeta=function(e){for(var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];if(i.length>0&&!Array.isArray(i[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");n>0&&I.removeRow(this.toPhysicalRow(e),n),i.length>0&&(0,g.Bk)(i.reverse(),(function(n){I.createRow(t.toPhysicalRow(e)),(0,g.Bk)(n,(function(n,r){return t.setCellMetaObject(e,r,n)}))})),_.render()},this.setCellMetaObject=function(e,t,n){var r=this;"object"===typeof n&&(0,f._l)(n,(function(n,i){r.setCellMeta(e,t,i,n)}))},this.setCellMeta=function(e,t,n,r){if(!1!==_.runHooks("beforeSetCellMeta",e,t,n,r)){var i=e,o=t;e<this.countRows()&&(i=this.toPhysicalRow(e)),t<this.countCols()&&(o=this.toPhysicalColumn(t)),I.setCellMeta(i,o,n,r),_.runHooks("afterSetCellMeta",e,t,n,r)}},this.getCellsMeta=function(){return I.getCellsMeta()},this.getCellMeta=function(e,t){var n=this.toPhysicalRow(e),r=this.toPhysicalColumn(t);return null===n&&(n=e),null===r&&(r=t),I.getCellMeta(n,r,{visualRow:e,visualColumn:t})},this.getCellMetaAtRow=function(e){return I.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===_.dataType||D.columns)},this.getCellRenderer=function(e,t){var n="number"===typeof e?_.getCellMeta(e,t).renderer:e.renderer;return"string"===typeof n?(0,p.Bp)(n):(0,u.o8)(n)?(0,p.Bp)("text"):n},this.getCellEditor=function(e,t){var n="number"===typeof e?_.getCellMeta(e,t).editor:e.editor;return"string"===typeof n?(0,y.y$)(n):(0,u.o8)(n)?(0,y.y$)("text"):n},this.getCellValidator=function(e,t){var n="number"===typeof e?_.getCellMeta(e,t).validator:e.validator;return"string"===typeof n?(0,w.Te)(n):n},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,n){var r=new B;e&&(r.onQueueEmpty=e);for(var i=_.countRows()-1;i>=0;)if(void 0===t||-1!==t.indexOf(i)){for(var o=_.countCols()-1;o>=0;)void 0===n||-1!==n.indexOf(o)?(r.addValidatorToQueue(),_.validateCell(_.getDataAtCell(i,o),_.getCellMeta(i,o),(function(e){if("boolean"!==typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(r.valid=!1),r.removeValidatorFormQueue()}),"validateCells"),o-=1):o-=1;i-=1}else i-=1;r.checkIfQueueIsEmpty()},this.getRowHeader=function(e){var t=D.rowHeaders,n=e;return void 0!==n&&(n=_.runHooks("modifyRowHeader",n)),void 0===n?(t=[],(0,b.q4)(_.countRows()-1,(function(e){t.push(_.getRowHeader(e))}))):Array.isArray(t)&&void 0!==t[n]?t=t[n]:(0,l.mf)(t)?t=t(n):t&&"string"!==typeof t&&"number"!==typeof t&&(t=n+1),t},this.hasRowHeaders=function(){return!!D.rowHeaders},this.hasColHeaders=function(){if(void 0!==D.colHeaders&&null!==D.colHeaders)return!!D.colHeaders;for(var e=0,t=_.countCols();e<t;e++)if(_.getColHeader(e))return!0;return!1},this.getColHeader=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=_.runHooks("modifyColHeader",e);if(void 0===n){for(var r=[],i=_.countCols(),o=0;o<i;o++)r.push(_.getColHeader(o));return r}var s=D.colHeaders,a=_.toPhysicalColumn(n),u=function(e){for(var t=[],n=_.countCols(),r=0;r<n;r++)(0,l.mf)(D.columns)&&D.columns(r)&&t.push(r);return t[e]}(a);return!1===D.colHeaders?s=null:D.columns&&(0,l.mf)(D.columns)&&D.columns(u)&&D.columns(u).title?s=D.columns(u).title:D.columns&&D.columns[a]&&D.columns[a].title?s=D.columns[a].title:Array.isArray(D.colHeaders)&&void 0!==D.colHeaders[a]?s=D.colHeaders[a]:(0,l.mf)(D.colHeaders)?s=D.colHeaders(a):D.colHeaders&&"string"!==typeof D.colHeaders&&"number"!==typeof D.colHeaders&&(s=Yt(n)),s=_.runHooks("modifyColumnHeaderValue",s,e,t)},this._getColWidthFromSettings=function(e){var t;e>=0&&(t=_.getCellMeta(0,e).width);if(void 0!==t&&t!==D.width||(t=D.colWidths),void 0!==t&&null!==t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"===typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e){var t=_._getColWidthFromSettings(e);return void 0===(t=_.runHooks("modifyColWidth",t,e))&&(t=St.DEFAULT_WIDTH),t},this._getRowHeightFromSettings=function(e){var t=D.rowHeights;if(void 0!==t&&null!==t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"===typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=_._getRowHeightFromSettings(e);return t=_.runHooks("modifyRowHeight",t,e)},this.countSourceRows=function(){return i.countRows()},this.countSourceCols=function(){return i.countFirstRowKeys()},this.countRows=function(){return r.getLength()},this.countCols=function(){var e=D.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return _.view._wt.drawn?_.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return _.view._wt.drawn?_.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return _.view._wt.drawn?_.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return _.view._wt.drawn?_.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return(0,b.yh)(_.countRows()-1,(function(n){if(_.isEmptyRow(n))t+=1;else if(!0===e)return!1})),t},this.countEmptyCols=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return(0,b.yh)(_.countCols()-1,(function(n){if(_.isEmptyCol(n))t+=1;else if(!0===e)return!1})),t},this.isEmptyRow=function(e){return D.isEmptyRow.call(_,e)},this.isEmptyCol=function(e){return D.isEmptyCol.call(_,e)},this.selectCell=function(e,t,n,r){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!(0,u.o8)(e)&&!(0,u.o8)(t)&&this.selectCells([[e,t,n,r]],i,o)},this.selectCells=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(k=!0);var n=P.selectCells(e);return n&&t&&_.listen(),k=!1,n},this.selectColumns=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return P.selectColumns(e,t)},this.selectRows=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return P.selectRows(e,t)},this.deselectCell=function(){P.deselect()},this.selectAll=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=e&&this.hasRowHeaders(),n=e&&this.hasColHeaders();k=!0,P.selectAll(t,n),k=!1};var G=function(e,t){return e.getNearestNotHiddenIndex(t,1,!0)};this.scrollViewportTo=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=!n,o=!r,s=e,a=t;if(!(arguments.length>4&&void 0!==arguments[4])||arguments[4]){var l=Number.isInteger(e),u=Number.isInteger(t),c=l?G(this.rowIndexMapper,e):void 0,h=u?G(this.columnIndexMapper,t):void 0;if(null===c||null===h)return!1;s=l?_.rowIndexMapper.getRenderableFromVisualIndex(c):void 0,a=u?_.columnIndexMapper.getRenderableFromVisualIndex(h):void 0}var d=Number.isInteger(s),f=Number.isInteger(a);return d&&f?_.view.scrollViewport(_._createCellCoords(s,a),i,r,n,o):d&&!1===f?_.view.scrollViewportVertically(s,i,n):!(!f||!1!==d)&&_.view.scrollViewportHorizontally(a,r,o)},this.destroy=function(){if(_._clearTimeouts(),_._clearImmediates(),_.view&&_.view.destroy(),i&&i.destroy(),i=null,this.getShortcutManager().destroy(),I.clearCache(),Dt(_)){var e=this.rootDocument.querySelector(".hot-display-license-info");e&&e.parentNode.removeChild(e)}(0,a.cS)(_.rootElement),O.destroy(),T&&T.destroy(),_.batchExecution((function(){_.rowIndexMapper.unregisterAll(),_.columnIndexMapper.unregisterAll(),A.getItems().forEach((function(e){(0,o.Z)(e,2)[1].destroy()})),A.clear(),_.runHooks("afterDestroy")}),!0),Dn.Z.getSingleton().destroy(_),(0,f._l)(_,(function(e,t,n){var r;(0,l.mf)(e)?n[t]=(r=t,function(){throw new Error('The "'.concat(r,'" method cannot be called because this Handsontable instance has been destroyed'))}):"guid"!==t&&(n[t]=null)})),_.isDestroyed=!0,r&&r.destroy(),r=null,S=null,P=null,T=null,_=null},this.getActiveEditor=function(){return T.getActiveEditor()},this.getPlugin=function(e){var t=(0,C.ct)(e);return"UndoRedo"===t?this.undoRedo:A.getItem(t)},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:A.getId(e)},this.getInstance=function(){return _},this.addHook=function(e,t){Dn.Z.getSingleton().add(e,t,_)},this.hasHook=function(e){return Dn.Z.getSingleton().has(e,_)||Dn.Z.getSingleton().has(e)},this.addHookOnce=function(e,t){Dn.Z.getSingleton().once(e,t,_)},this.removeHook=function(e,t){Dn.Z.getSingleton().remove(e,t,_)},this.runHooks=function(e,t,n,r,i,o,s){return Dn.Z.getSingleton().run(_,e,t,n,r,i,o,s)},this.getTranslatedPhrase=function(e,t){return er(D.language,e,t)},this.toHTML=function(){return(0,m.vo)(E)},this.toTableElement=function(){var e=E.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",(0,m.vo)(E)),e.firstElementChild},this.timeouts=[],this._registerTimeout=function(e){var t=e;"function"===typeof t&&(t=setTimeout(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(t)},this._clearTimeouts=function(){(0,g.Bk)(this.timeouts,(function(e){clearTimeout(e)}))},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){(0,g.Bk)(this.immediates,(function(e){clearImmediate(e)}))},this._refreshBorders=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];T.destroyEditor(e),_.view.render(),t&&P.isSelected()&&T.prepareEditor()},this.isRtl=function(){return"rtl"===_.rootWindow.getComputedStyle(_.rootElement).direction},this.isLtr=function(){return!_.isRtl()},this.getDirectionFactor=function(){return _.isLtr()?1:-1};var X=Ti({handleEvent:function(e){var t=_.isListening(),n=void 0!==(null===e||void 0===e?void 0:e.key);return t&&n},beforeKeyDown:function(e){return E.runHooks("beforeKeyDown",e)},afterKeyDown:function(e){E.isDestroyed||_.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",(function(e){!1===e.ctrlKey&&!1===e.metaKey&&X.releasePressedKeys()})),this.getShortcutManager=function(){return X};var K=X.addContext("grid"),q={runOnlyIf:function(){return(0,u.$K)(_.getSelected())&&_.countRenderedRows()>0&&_.countRenderedCols()>0},group:Ei};X.setActiveContextName("grid"),K.addShortcuts([{keys:[["Control/Meta","A"]],callback:function(){_.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:function(){for(var e=_.getSelectedRange(),t=e[e.length-1].highlight,n=t.row,r=t.col,i=_.getDataAtCell(n,r),o=new Map,s=0;s<e.length;s++)e[s].forAll((function(e,t){e>=0&&t>=0&&(e!==n||t!==r)&&(_.getCellMeta(e,t).readOnly||o.set("".concat(e,"x").concat(t),[e,t,i]))}));_.setDataAtCell(Array.from(o.values()))},runOnlyIf:function(){return _.getSelectedRangeLast().getCellsCount()>1}},{keys:[["ArrowUp"]],callback:function(){P.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:function(){P.setRangeStart(_._createCellCoords(_.rowIndexMapper.getNearestNotHiddenIndex(0,1),_.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:function(){P.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e=_.getSelectedRangeLast(),t=e.from,n=e.to,r=_.rowIndexMapper.getNearestNotHiddenIndex(0,1);P.setRangeStart(t.clone()),P.setRangeEnd(_._createCellCoords(r,n.col))},runOnlyIf:function(){return!(_.selection.isSelectedByCorner()||_.selection.isSelectedByColumnHeader())}},{keys:[["ArrowDown"]],callback:function(){P.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:function(){P.setRangeStart(_._createCellCoords(_.rowIndexMapper.getNearestNotHiddenIndex(_.countRows()-1,-1),_.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:function(){P.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e=_.getSelectedRangeLast(),t=e.from,n=e.to,r=_.rowIndexMapper.getNearestNotHiddenIndex(_.countRows()-1,-1);P.setRangeStart(t.clone()),P.setRangeEnd(_._createCellCoords(r,n.col))},runOnlyIf:function(){return!(_.selection.isSelectedByCorner()||_.selection.isSelectedByColumnHeader())}},{keys:[["ArrowLeft"]],callback:function(){P.transformStart(0,-1*_.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=_.getSelectedRangeLast().highlight.row,n=(e=_.columnIndexMapper).getNearestNotHiddenIndex.apply(e,(0,s.Z)(_.isRtl()?[_.countCols()-1,-1]:[0,1]));P.setRangeStart(_._createCellCoords(t,n))}},{keys:[["ArrowLeft","Shift"]],callback:function(){P.transformEnd(0,-1*_.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=_.getSelectedRangeLast(),n=t.from,r=t.to,i=(e=_.columnIndexMapper).getNearestNotHiddenIndex.apply(e,(0,s.Z)(_.isRtl()?[_.countCols()-1,-1]:[0,1]));P.setRangeStart(n.clone()),P.setRangeEnd(_._createCellCoords(r.row,i))},runOnlyIf:function(){return!(_.selection.isSelectedByCorner()||_.selection.isSelectedByRowHeader())}},{keys:[["ArrowRight"]],callback:function(){P.transformStart(0,_.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=_.getSelectedRangeLast().highlight.row,n=(e=_.columnIndexMapper).getNearestNotHiddenIndex.apply(e,(0,s.Z)(_.isRtl()?[0,1]:[_.countCols()-1,-1]));P.setRangeStart(_._createCellCoords(t,n))}},{keys:[["ArrowRight","Shift"]],callback:function(){P.transformEnd(0,_.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:function(){var e,t=_.getSelectedRangeLast(),n=t.from,r=t.to,i=(e=_.columnIndexMapper).getNearestNotHiddenIndex.apply(e,(0,s.Z)(_.isRtl()?[0,1]:[_.countCols()-1,-1]));P.setRangeStart(n.clone()),P.setRangeEnd(_._createCellCoords(r.row,i))},runOnlyIf:function(){return!(_.selection.isSelectedByCorner()||_.selection.isSelectedByRowHeader())}},{keys:[["Home"]],captureCtrl:!0,callback:function(){var e=parseInt(_.getSettings().fixedColumnsStart,10),t=_.getSelectedRangeLast().highlight.row,n=_.columnIndexMapper.getNearestNotHiddenIndex(e,1);P.setRangeStart(_._createCellCoords(t,n))},runOnlyIf:function(){return _.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["Home","Shift"]],callback:function(){P.setRangeEnd(_._createCellCoords(P.selectedRange.current().from.row,_.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:function(){var e=parseInt(_.getSettings().fixedRowsTop,10),t=parseInt(_.getSettings().fixedColumnsStart,10),n=_.rowIndexMapper.getNearestNotHiddenIndex(e,1),r=_.columnIndexMapper.getNearestNotHiddenIndex(t,1);P.setRangeStart(_._createCellCoords(n,r))},runOnlyIf:function(){return _.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End"]],captureCtrl:!0,callback:function(){P.setRangeStart(_._createCellCoords(_.getSelectedRangeLast().highlight.row,_.columnIndexMapper.getNearestNotHiddenIndex(_.countCols()-1,-1)))},runOnlyIf:function(){return _.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["End","Shift"]],callback:function(){P.setRangeEnd(_._createCellCoords(P.selectedRange.current().from.row,_.columnIndexMapper.getNearestNotHiddenIndex(_.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:function(){var e=parseInt(_.getSettings().fixedRowsBottom,10),t=_.rowIndexMapper.getNearestNotHiddenIndex(_.countRows()-e-1,-1),n=_.columnIndexMapper.getNearestNotHiddenIndex(_.countCols()-1,-1);P.setRangeStart(_._createCellCoords(t,n))},runOnlyIf:function(){return _.view.isMainTableNotFullyCoveredByOverlays()}},{keys:[["PageUp"]],callback:function(){P.transformStart(-_.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:function(){var e=_.getSelectedRangeLast().to,t=Math.max(e.row-_.countVisibleRows(),0),n=_.rowIndexMapper.getNearestNotHiddenIndex(t,1);if(null!==n){var r=_._createCellCoords(n,e.col),i=e.row-_.view.getFirstFullyVisibleRow(),o=Math.max(r.row-i,0);P.setRangeEnd(r),_.scrollViewportTo(o)}}},{keys:[["PageDown"]],callback:function(){P.transformStart(_.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:function(){var e=_.getSelectedRangeLast().to,t=Math.min(e.row+_.countVisibleRows(),_.countRows()-1),n=_.rowIndexMapper.getNearestNotHiddenIndex(t,-1);if(null!==n){var r=_._createCellCoords(n,e.col),i=e.row-_.view.getFirstFullyVisibleRow(),o=Math.min(r.row-i,_.countRows()-1);P.setRangeEnd(r),_.scrollViewportTo(o)}}},{keys:[["Tab"]],callback:function(e){var t="function"===typeof D.tabMoves?D.tabMoves(e):D.tabMoves;P.transformStart(t.row,t.col,!0)}},{keys:[["Shift","Tab"]],callback:function(e){var t="function"===typeof D.tabMoves?D.tabMoves(e):D.tabMoves;P.transformStart(-t.row,-t.col)}}],q),(0,v.a9)().forEach((function(e){var t=(0,v.s3)(e);A.addItem(e,new t(E))})),Dn.Z.getSingleton().run(_,"construct")}var _i=n(1),Oi=n(174),Mi={CELL_TYPE:"text",editor:_i.H,renderer:Oi.V},xi=n(8579);function Ni(e,t){var n=new ki(e,t||{},Nt);return n.init(),n}(0,$r.xN)(Mi),Ni.editors={BaseEditor:xi.Hf},Ni.Core=function(e){return new ki(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},Nt)},Ni.DefaultSettings=ni(),Ni.hooks=Dn.Z.getSingleton(),Ni.CellCoords=_e,Ni.CellRange=Ae,Ni.packageName="handsontable",Ni.buildDate="31/08/2023 08:23:33",Ni.version="13.1.0",Ni.languages={dictionaryKeys:Un,getLanguageDictionary:Qn,getLanguagesDictionaries:function(){return qn()},registerLanguageDictionary:$n,getTranslatedPhrase:er};var Ii=Ni;function Di(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hi(e){return Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hi(e)}function Ai(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Li(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,zi(r.key),r)}}function Pi(e,t,n){return t&&Li(e.prototype,t),n&&Li(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vi(e,t,n){return(t=zi(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wi(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bi(e,t)}function Fi(e){return Fi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Fi(e)}function Bi(e,t){return Bi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Bi(e,t)}function Zi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ji(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(lo){return!1}}();return function(){var n,r=Fi(e);if(t){var i=Fi(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Zi(e)}(this,n)}}function Ui(e){return function(e){if(Array.isArray(e))return Yi(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return Yi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yi(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zi(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}var Gi=null,Xi="global";function Ki(e,t){var n=r.Children.toArray(e),i=r.Children.count(e),o=null;return 0!==i&&(o=1===i&&n[0].props[t]?n[0]:n.find((function(e){return void 0!==e.props[t]}))),o||null}function qi(e){return e?e.type.WrappedComponent?e.type.WrappedComponent:e.type:null}function $i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1?arguments[1]:void 0;if(null===t)return null;var n=eo(t.props,!1);return n.className="".concat("hot-wrapper-editor-container"," ").concat(n.className),i.createPortal(r.createElement("div",Object.assign({},n),t),e.body)}function Qi(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xi,i=Ki(e,"hot-editor"),o=qi(i);return i?r.cloneElement(i,{emitEditorInstance:function(e,n){t.get(o)||t.set(o,new Map),t.get(o).set(null!==n&&void 0!==n?n:Xi,e)},editorColumnScope:n,isEditor:!0}):null}function Ji(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document;n||(n=document),Gi||(Gi=n.createDocumentFragment());var o=n.createElement("DIV");Gi.appendChild(o);var s=r.cloneElement(e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Di(Object(n),!0).forEach((function(t){Vi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Di(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({key:"".concat(t.row,"-").concat(t.col)},t));return{portal:i.createPortal(s,o,"".concat(t.row,"-").concat(t.col,"-").concat(Math.random())),portalContainer:o}}function eo(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{id:e.id||(t?"hot-"+Math.random().toString(36).substring(5):void 0),className:e.className||"",style:e.style||{}}}var to=function(){function e(){Ai(this,e)}return Pi(e,null,[{key:"getSettings",value:function(e){var t={};if(e.settings){var n=e.settings;for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}for(var i in e)"settings"!==i&&"children"!==i&&e.hasOwnProperty(i)&&(t[i]=e[i]);return t}}]),e}(),no=function(e){Wi(n,e);var t=ji(n);function n(){return Ai(this,n),t.apply(this,arguments)}return Pi(n,[{key:"getSettingsProps",value:function(){var e=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter((function(t){return!e.internalProps.includes(t)})).reduce((function(t,n){return t[n]=e.props[n],t}),{})}},{key:"getLocalEditorElement",value:function(){return Qi(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var e=this.props._getChildElementByType(this.props.children,"hot-renderer"),t=this.getLocalEditorElement();this.columnSettings=to.getSettings(this.getSettingsProps()),null!==e&&(this.columnSettings.renderer=this.props._getRendererWrapper(e),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),null!==t&&(this.columnSettings.editor=this.props._getEditorClass(t,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var e=$i(this.props._getOwnerDocument(),this.getLocalEditorElement());return r.createElement(r.Fragment,null,e)}}]),n}(r.Component),ro=function(e){Wi(n,e);var t=ji(n);function n(){var e;return Ai(this,n),(e=t.apply(this,arguments)).state={portals:[]},e}return Pi(n,[{key:"render",value:function(){return r.createElement(r.Fragment,null,this.state.portals)}}]),n}(r.Component);function io(e,t){return e(t={exports:{}},t.exports),t.exports}var oo="function"===typeof Symbol&&Symbol.for,so=oo?Symbol.for("react.element"):60103,ao=oo?Symbol.for("react.portal"):60106,lo=oo?Symbol.for("react.fragment"):60107,uo=oo?Symbol.for("react.strict_mode"):60108,co=oo?Symbol.for("react.profiler"):60114,ho=oo?Symbol.for("react.provider"):60109,fo=oo?Symbol.for("react.context"):60110,go=oo?Symbol.for("react.async_mode"):60111,mo=oo?Symbol.for("react.concurrent_mode"):60111,vo=oo?Symbol.for("react.forward_ref"):60112,po=oo?Symbol.for("react.suspense"):60113,yo=oo?Symbol.for("react.suspense_list"):60120,wo=oo?Symbol.for("react.memo"):60115,Co=oo?Symbol.for("react.lazy"):60116,bo=oo?Symbol.for("react.block"):60121,So=oo?Symbol.for("react.fundamental"):60117,To=oo?Symbol.for("react.responder"):60118,Eo=oo?Symbol.for("react.scope"):60119;function Ro(e){if("object"===Hi(e)&&null!==e){var t=e.$$typeof;switch(t){case so:switch(e=e.type){case go:case mo:case lo:case co:case uo:case po:return e;default:switch(e=e&&e.$$typeof){case fo:case vo:case Co:case wo:case ho:return e;default:return t}}case ao:return t}}}function ko(e){return Ro(e)===mo}var _o={AsyncMode:go,ConcurrentMode:mo,ContextConsumer:fo,ContextProvider:ho,Element:so,ForwardRef:vo,Fragment:lo,Lazy:Co,Memo:wo,Portal:ao,Profiler:co,StrictMode:uo,Suspense:po,isAsyncMode:function(e){return ko(e)||Ro(e)===go},isConcurrentMode:ko,isContextConsumer:function(e){return Ro(e)===fo},isContextProvider:function(e){return Ro(e)===ho},isElement:function(e){return"object"===Hi(e)&&null!==e&&e.$$typeof===so},isForwardRef:function(e){return Ro(e)===vo},isFragment:function(e){return Ro(e)===lo},isLazy:function(e){return Ro(e)===Co},isMemo:function(e){return Ro(e)===wo},isPortal:function(e){return Ro(e)===ao},isProfiler:function(e){return Ro(e)===co},isStrictMode:function(e){return Ro(e)===uo},isSuspense:function(e){return Ro(e)===po},isValidElementType:function(e){return"string"===typeof e||"function"===typeof e||e===lo||e===mo||e===co||e===uo||e===po||e===yo||"object"===Hi(e)&&null!==e&&(e.$$typeof===Co||e.$$typeof===wo||e.$$typeof===ho||e.$$typeof===fo||e.$$typeof===vo||e.$$typeof===So||e.$$typeof===To||e.$$typeof===Eo||e.$$typeof===bo)},typeOf:Ro},Oo=io((function(e,t){0}));Oo.AsyncMode,Oo.ConcurrentMode,Oo.ContextConsumer,Oo.ContextProvider,Oo.Element,Oo.ForwardRef,Oo.Fragment,Oo.Lazy,Oo.Memo,Oo.Portal,Oo.Profiler,Oo.StrictMode,Oo.Suspense,Oo.isAsyncMode,Oo.isConcurrentMode,Oo.isContextConsumer,Oo.isContextProvider,Oo.isElement,Oo.isForwardRef,Oo.isFragment,Oo.isLazy,Oo.isMemo,Oo.isPortal,Oo.isProfiler,Oo.isStrictMode,Oo.isSuspense,Oo.isValidElementType,Oo.typeOf;io((function(e){e.exports=_o}));var Mo=Object.getOwnPropertySymbols,xo=Object.prototype.hasOwnProperty,No=Object.prototype.propertyIsEnumerable;(function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var r=Object.getOwnPropertyNames(t).map((function(e){return t[e]}));if("0123456789"!==r.join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(e){i[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(o){return!1}})()&&Object.assign;var Io="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";Function.call.bind(Object.prototype.hasOwnProperty);function Do(e,t,n,r,i){}Do.resetWarningCache=function(){0};function Ho(){}function Ao(){}Ao.resetWarningCache=Ho;var Lo=io((function(e){e.exports=function(){function e(e,t,n,r,i,o){if(o!==Io){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Ao,resetWarningCache:Ho};return n.PropTypes=n,n}()})),Po=function(e){Wi(n,e);var t=ji(n);function n(){var e;return Ai(this,n),(e=t.apply(this,arguments)).id=null,e.__hotInstance=null,e.hotElementRef=null,e.columnSettings=[],e.renderersPortalManager=null,e.portalCacheArray=[],e.renderedCellCache=new Map,e.editorCache=new Map,e.componentRendererColumns=new Map,e}return Pi(n,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null)},set:function(e){this.__hotInstance=e}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return this.hotElementRef?this.hotElementRef.ownerDocument:document}},{key:"setHotElementRef",value:function(e){this.hotElementRef=e}},{key:"getRendererWrapper",value:function(e){var t=this;return function(n,r,i,o,s,a,l){var u=t.getRenderedCellCache();if(u.has("".concat(i,"-").concat(o))&&(r.innerHTML=u.get("".concat(i,"-").concat(o)).innerHTML),r&&!r.getAttribute("ghost-table")){for(var c=Ji(e,{TD:r,row:i,col:o,prop:s,value:a,cellProperties:l,isRenderer:!0},r.ownerDocument),h=c.portal,d=c.portalContainer;r.firstChild;)r.removeChild(r.firstChild);r.appendChild(d),t.portalCacheArray.push(h)}return u.set("".concat(i,"-").concat(o),r),r}}},{key:"getEditorClass",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xi,r=qi(e),i=null===(t=this.getEditorCache().get(r))||void 0===t?void 0:t.get(n);return this.makeEditorClass(i)}},{key:"makeEditorClass",value:function(e){var t=function(t){Wi(r,t);var n=ji(r);function r(t){var i;return Ai(this,r),i=n.call(this,t),e.hotCustomEditorInstance=Zi(i),i.editorComponent=e,i}return Pi(r,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),r}(Ii.editors.BaseEditor);return Object.getOwnPropertyNames(Ii.editors.BaseEditor.prototype).forEach((function(n){"constructor"!==n&&(t.prototype[n]=function(){for(var t,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(t=e[n]).call.apply(t,[e].concat(i))})})),t}},{key:"getGlobalRendererElement",value:function(){return Ki(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return Qi(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var e=to.getSettings(this.props),t=this.getGlobalRendererElement(),n=this.getGlobalEditorElement();return e.columns=this.columnSettings.length?this.columnSettings:e.columns,e.editor=n?this.getEditorClass(n,Xi):this.props.editor||(this.props.settings?this.props.settings.editor:void 0),t?(e.renderer=this.getRendererWrapper(t),this.componentRendererColumns.set("global",!0)):e.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),e}},{key:"displayAutoSizeWarning",value:function(e){var t,n;this.hotInstance&&(null!==(t=this.hotInstance.getPlugin("autoRowSize"))&&void 0!==t&&t.enabled||null!==(n=this.hotInstance.getPlugin("autoColumnSize"))&&void 0!==n&&n.enabled)&&this.componentRendererColumns.size>0&&function(){var e;"undefined"!==typeof console&&(e=console).warn.apply(e,arguments)}("Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.")}},{key:"setHotColumnSettings",value:function(e,t){this.columnSettings[t]=e}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var e=this;this.renderersPortalManager.setState({portals:Ui(this.portalCacheArray)},(function(){e.portalCacheArray=[]}))}},{key:"updateHot",value:function(e){this.hotInstance&&this.hotInstance.updateSettings(e,!1)}},{key:"setRenderersPortalManagerRef",value:function(e){this.renderersPortalManager=e}},{key:"componentDidMount",value:function(){var e=this,t=this.createNewGlobalSettings();this.hotInstance=new Ii.Core(this.hotElementRef,t),this.hotInstance.addHook("beforeViewRender",(function(){return e.handsontableBeforeViewRender()})),this.hotInstance.addHook("afterViewRender",(function(){return e.handsontableAfterViewRender()})),this.hotInstance.init(),this.displayAutoSizeWarning(t)}},{key:"componentDidUpdate",value:function(){this.clearCache();var e=this.createNewGlobalSettings();this.updateHot(e),this.displayAutoSizeWarning(e)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var e=this,t=eo(this.props),n=r.Children.toArray(this.props.children).filter((function(e){return function(e){return e.type===no}(e)})).map((function(t,n){return r.cloneElement(t,{_componentRendererColumns:e.componentRendererColumns,_emitColumnSettings:e.setHotColumnSettings.bind(e),_columnIndex:n,_getChildElementByType:Ki.bind(e),_getRendererWrapper:e.getRendererWrapper.bind(e),_getEditorClass:e.getEditorClass.bind(e),_getOwnerDocument:e.getOwnerDocument.bind(e),_getEditorCache:e.getEditorCache.bind(e),children:t.props.children})})),i=$i(this.getOwnerDocument(),this.getGlobalEditorElement());return r.createElement(r.Fragment,null,r.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},t),n),r.createElement(ro,{ref:this.setRenderersPortalManagerRef.bind(this)}),i)}}],[{key:"version",get:function(){return"13.1.0"}}]),n}(r.Component);Po.propTypes={style:Lo.object,id:Lo.string,className:Lo.string};r.Component},4128:function(e,t,n){"use strict";n.d(t,{P:function(){return a},Q:function(){return s}});var r=/^(\r\n|\n\r|\r|\n)/,i=/^[^\t\r\n]+/,o=/^\t/;function s(e){var t=[[""]];if(0===e.length)return t;for(var n,s=0,a=0;e.length>0&&n!==e.length;)if(n=e.length,e.match(o))e=e.replace(o,""),s+=1,t[a][s]="";else if(e.match(r))e=e.replace(r,""),s=0,t[a+=1]=[""];else{var l="";if(e.startsWith('"')){for(var u=0,c=!0;c;){var h=e.slice(0,1);'"'===h&&(u+=1),l+=h,(0===(e=e.slice(1)).length||e.match(/^[\t\r\n]/)&&u%2===0)&&(c=!1)}l=l.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(function(e){return new Array(Math.floor(e.length/2)).fill('"').join("")}))}else{var d=e.match(i);l=d?d[0]:"",e=e.slice(l.length)}t[a][s]=l}return t}function a(e){var t,n,r,i,o,s="";for(t=0,n=e.length;t<n;t+=1){for(i=e[t].length,r=0;r<i;r+=1)r>0&&(s+="\t"),"string"===typeof(o=e[t][r])?o.indexOf("\n")>-1?s+='"'.concat(o.replace(/"/g,'""'),'"'):s+=o:s+=null===o||void 0===o?"":o;t!==n-1&&(s+="\n")}return s}},7382:function(e,t,n){"use strict";n.d(t,{f:function(){return S}});var r=n(5671),i=n(3144),o=n(1752),s=n(1120),a=n(136),l=n(7277),u=n(2426),c=n(2285),h=n(1),d=n(3713),f=n(8492),g=n(4170),m=n(5941),v="date",p="dateEditor",y=function(e){(0,a.Z)(n,e);var t=(0,l.Z)(n);function n(e){var i;return(0,r.Z)(this,n),(i=t.call(this,e)).defaultDateFormat="DD/MM/YYYY",i.isCellEdited=!1,i.parentDestroyed=!1,i.$datePicker=null,i}return(0,i.Z)(n,[{key:"init",value:function(){var e=this;if("function"!==typeof u)throw new Error("You need to include moment.js to your project.");if("function"!==typeof c)throw new Error("You need to include Pikaday to your project.");(0,o.Z)((0,s.Z)(n.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",(function(){e.parentDestroyed=!0,e.destroyElements()}))}},{key:"createElements",value:function(){(0,o.Z)((0,s.Z)(n.prototype),"createElements",this).call(this),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),(0,f.cn)(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),new d.Z(this).addEventListener(this.datePicker,"mousedown",(function(e){return e.stopPropagation()}))}},{key:"destroyElements",value:function(){var e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}},{key:"prepare",value:function(e,t,r,i,a,l){(0,o.Z)((0,s.Z)(n.prototype),"prepare",this).call(this,e,t,r,i,a,l)}},{key:"open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.hot.getShortcutManager().getContext("editor");(0,o.Z)((0,s.Z)(n.prototype),"open",this).call(this),this.showDatepicker(e),t.addShortcut({keys:[["Enter"]],callback:function(e){e.stopPropagation()},group:p})}},{key:"close",value:function(){var e,t=this;this._opened=!1,null!==(e=this.$datePicker)&&void 0!==e&&e.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout((function(){t.instance._refreshBorders()})),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(p),(0,o.Z)((0,s.Z)(n.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var r=this.originalValue;void 0!==r&&this.setValue(r)}(0,o.Z)((0,s.Z)(n.prototype),"finishEditing",this).call(this,e,t)}},{key:"showDatepicker",value:function(e){var t,n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.instance.view.isMouseDown(),o=!!e&&(0,m.DC)(e.keyCode);this.datePicker.style.display="block",this.$datePicker=new c(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top="".concat(this.hot.rootWindow.pageYOffset+n.top+(0,f.Pb)(this.TD),"px");var s=this.hot.rootWindow.pageXOffset;s=this.hot.isRtl()?n.right-(0,f.iO)(this.datePicker):n.left,this.datePickerStyle.left="".concat(s,"px"),this.originalValue?(t=this.originalValue,u(t,r,!0).isValid()&&this.$datePicker.setMoment(u(t,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),o||i||this.setValue("")):this.cellProperties.defaultDate?(t=this.cellProperties.defaultDate,u(t,r,!0).isValid()&&this.$datePicker.setMoment(u(t,r),!0),o||i||this.setValue("")):this.$datePicker.gotoToday()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var e=this,t=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&(0,g.ZB)(n,this.cellProperties.datePickerConfig);var r=n.onSelect,i=n.onClose;return n.field=t,n.trigger=t,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=function(t){var n=t;isNaN(n.getTime())||(n=u(n).format(e.cellProperties.dateFormat||e.defaultDateFormat)),e.setValue(n),e.hideDatepicker(),r&&r()},n.onClose=function(){e.parentDestroyed||e.finishEditing(!1),i&&i()},n}}],[{key:"EDITOR_TYPE",get:function(){return v}}]),n}(h.H),w=n(6067),C=n(4699);function b(e,t){var n=(0,C.Jq)(v,this.instance),r=e,i=!0;null!==r&&void 0!==r||(r="");var o=u(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=u(new Date(r)).isValid()||o;if(this.allowEmpty&&""===r&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(!0===this.correctFormat){var a=function(e,t){var n,r=u(function(e){var t=new Date(e);return isNaN(new Date("".concat(e,"T00:00")).getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}(e)),i=u(e,t),o=e.search(/[A-z]/g)>-1;n=r.isValid()&&r.format("x")===i.format("x")||!i.isValid()||o?r:i;return n.format(t)}(r,this.dateFormat),l=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,c,a,"dateValidator"),i=!0}else i=!1;t(i)}b.VALIDATOR_TYPE="date";var S={CELL_TYPE:"date",editor:y,renderer:w.A,validator:b}},7214:function(e,t,n){"use strict";n.d(t,{g:function(){return x}});var r=n(5671),i=n(3144),o=n(1752),s=n(1120),a=n(136),l=n(7277),u=n(7326),c=n(1),h=n(8492),d=n(1528),f=n(4170),g=n(1643),m="handsontableEditor",v=function(e){(0,a.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"open",value:function(){(0,o.Z)((0,s.Z)(n.prototype),"open",this).call(this),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),(0,h.Mq)(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}},{key:"close",value:function(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),(0,o.Z)((0,s.Z)(n.prototype),"close",this).call(this)}},{key:"prepare",value:function(e,t,r,i,a,l){(0,o.Z)((0,s.Z)(n.prototype),"prepare",this).call(this,e,t,r,i,a,l);var u=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown:function(e,t){var n=this.getSourceData(t.row,t.col);void 0!==n&&u.setValue(n),u.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&(0,f.l7)(c,l.handsontable),this.htOptions=c}},{key:"beginEditing",value:function(e,t){var r=this.hot.getSettings().onBeginEditing;r&&!1===r()||(0,o.Z)((0,s.Z)(n.prototype),"beginEditing",this).call(this,e,t)}},{key:"createElements",value:function(){(0,o.Z)((0,s.Z)(n.prototype),"createElements",this).call(this);var e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}},{key:"finishEditing",value:function(e,t,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){var i=this.htEditor.getInstance().getValue();void 0!==i&&this.setValue(i)}(0,o.Z)((0,s.Z)(n.prototype),"finishEditing",this).call(this,e,t,r)}},{key:"assignHooks",value:function(){var e=this;this.hot.addHook("afterDestroy",(function(){e.htEditor&&e.htEditor.destroy()}))}},{key:"registerShortcuts",value:function(){var e=this,t=this.hot.getShortcutManager().getContext("editor");(0,o.Z)((0,s.Z)(n.prototype),"registerShortcuts",this).call(this);var r={group:m,relativeToGroup:g.HJ,position:"before"},i=function(t,n){var r=e.htEditor.getInstance();if(void 0!==t&&(t<0||r.flipped&&t>r.countRows()-1?r.deselectCell():r.selectCell(t,0),r.getData().length))return n.preventDefault(),(0,d.mM)(n),e.hot.listen(),e.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:function(t){var n,r,o=e.htEditor.getInstance();return!o.getSelectedLast()&&o.flipped?n=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(r=o.getSelectedLast()[0],n=Math.max(0,r-1)):n=(r=o.getSelectedLast()[0])-1),i(n,t)},preventDefault:!1},{keys:[["ArrowDown"]],callback:function(t){var n,r,o=e.htEditor.getInstance();if(o.getSelectedLast()||o.flipped){if(o.getSelectedLast())if(o.flipped)n=o.getSelectedLast()[0]+1;else if(!o.flipped){var s=o.countRows()-1;r=o.getSelectedLast()[0],n=Math.min(s,r+1)}}else n=0;return i(n,t)},preventDefault:!1}],r)}},{key:"unregisterShortcuts",value:function(){(0,o.Z)((0,s.Z)(n.prototype),"unregisterShortcuts",this).call(this),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(m)}}],[{key:"EDITOR_TYPE",get:function(){return"handsontable"}}]),n}(c.H),p=n(2063),y=n(7117),w=n(4638),C=n(5941),b=n(174);function S(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var T=new WeakMap,E=function(e){(0,a.Z)(n,e);var t=(0,l.Z)(n);function n(e){var i;return(0,r.Z)(this,n),i=t.call(this,e),S((0,u.Z)(i),"sortByRelevance",(function(e,t,n){var r,i,o,s,a=[],l=[],u=e.length,c=t.length;if(0===u){for(o=0;o<c;o++)l.push(o);return l}for(o=0;o<c;o++){if(i=(0,w.oN)((0,y.Pz)(t[o])),n)s=i.indexOf(e);else{var h=this.cellProperties.locale;s=i.toLocaleLowerCase(h).indexOf(e.toLocaleLowerCase(h))}-1!==s&&(r=i.length-s-u,a.push({baseIndex:o,index:s,charsLeft:r,value:i}))}for(a.sort((function(e,t){if(-1===t.index)return-1;if(-1===e.index)return 1;if(e.index<t.index)return-1;if(t.index<e.index)return 1;if(e.index===t.index){if(e.charsLeft<t.charsLeft)return-1;if(e.charsLeft>t.charsLeft)return 1}return 0})),o=0,c=a.length;o<c;o++)l.push(a[o].baseIndex);return l})),i.query=null,i.strippedChoices=[],i.rawChoices=[],T.set((0,u.Z)(i),{skipOne:!1,isMacOS:i.hot.rootWindow.navigator.platform.indexOf("Mac")>-1}),i}return(0,i.Z)(n,[{key:"getValue",value:function(){var e=this,t=this.rawChoices.find((function(t){return e.stripValueIfNeeded(t)===e.TEXTAREA.value}));return(0,y.$K)(t)?t:this.TEXTAREA.value}},{key:"createElements",value:function(){(0,o.Z)((0,s.Z)(n.prototype),"createElements",this).call(this),(0,h.cn)(this.htContainer,"autocompleteEditor"),(0,h.cn)(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll")}},{key:"open",value:function(){var e=this,t=T.get(this);(0,o.Z)((0,s.Z)(n.prototype),"open",this).call(this);var r=this.htEditor.getInstance(),i=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();var a=(0,h.np)();0===a&&t.isMacOS&&(a+=15),this.addHook("beforeKeyDown",(function(t){return e.onBeforeKeyDown(t)})),r.updateSettings({colWidths:i?[(0,h.iO)(this.TEXTAREA)-2]:void 0,width:i?(0,h.iO)(this.TEXTAREA)+a:void 0,renderer:function(t,n,r,i,o,s,a){(0,b.V)(t,n,r,i,o,s,a);var l,u,c=e.cellProperties,h=c.filteringCaseSensitive,d=c.allowHtml,f=c.locale,g=e.query,m=(0,y.Pz)(s);m&&!d&&-1!==(l=!0===h?m.indexOf(g):m.toLocaleLowerCase(f).indexOf(g.toLocaleLowerCase(f)))&&(u=m.substr(l,g.length),m=m.replace(u,"<strong>".concat(u,"</strong>"))),n.innerHTML=m},autoColumnSize:!0}),t.skipOne&&(t.skipOne=!1),this.hot._registerTimeout((function(){e.queryChoices(e.TEXTAREA.value)}))}},{key:"close",value:function(){this.removeHooksByKey("beforeKeyDown"),(0,o.Z)((0,s.Z)(n.prototype),"close",this).call(this)}},{key:"discardEditor",value:function(e){(0,o.Z)((0,s.Z)(n.prototype),"discardEditor",this).call(this,e),this.hot.view.render()}},{key:"queryChoices",value:function(e){var t=this,n=this.cellProperties.source;this.query=e,"function"===typeof n?n.call(this.cellProperties,e,(function(e){t.rawChoices=e,t.updateChoicesList(t.stripValuesIfNeeded(e))})):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}},{key:"updateChoicesList",value:function(e){var t=(0,h.qK)(this.TEXTAREA),n=(0,h.kg)(this.TEXTAREA),r=this.cellProperties.sortByRelevance,i=this.cellProperties.filter,o=null,s=null,a=e;r&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),a,this.cellProperties.filteringCaseSensitive));var l=Array.isArray(o)?o.length:0;if(!1===i)l&&(s=o[0]);else{for(var u=[],c=0,d=a.length;c<d&&!(r&&l<=c);c++)l?u.push(a[o[c]]):u.push(a[c]);s=0,a=u}this.strippedChoices=a,this.htEditor.loadData((0,p.jz)([a])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(s),this.hot.listen(),(0,h.Mq)(this.TEXTAREA,t,t===n?void 0:n)}},{key:"flipDropdownIfNeeded",value:function(){var e=(0,h.$g)(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(t||!t&&(n||"horizontal"===n))return!1;var r=(0,h.cv)(this.TEXTAREA),i=(0,h.Pb)(this.TEXTAREA),o=this.getDropdownHeight(),s=e.scrollTop,a=(0,h.Pb)(this.hot.view._wt.wtTable.THEAD),l=(0,h.cv)(e),u=r.top-l.top-a+s,c=e.scrollHeight-u-a-i,d=o>c&&u>c;return d?this.flipDropdown(o):this.unflipDropdown(),this.limitDropdownIfNeeded(d?u:c,o),d}},{key:"limitDropdownIfNeeded",value:function(e,t){if(t>e){var n,r=0,i=0,o=0;do{r+=o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),i+=1}while(r<e);n=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top="".concat(parseInt(this.htEditor.rootElement.style.top,10)+t-n,"px")),this.setDropdownHeight(r-o)}}},{key:"flipDropdown",value:function(e){var t=this.htEditor.rootElement.style;t.position="absolute",t.top="".concat(-e,"px"),this.htEditor.flipped=!0}},{key:"unflipDropdown",value:function(){var e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}},{key:"updateDropdownHeight",value:function(){var e=this.htEditor.getColWidth(0)+(0,h.np)(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}},{key:"setDropdownHeight",value:function(e){this.htEditor.updateSettings({height:e})}},{key:"highlightBestMatchingChoice",value:function(e){"number"===typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}},{key:"getDropdownHeight",value:function(){var e=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}},{key:"stripValueIfNeeded",value:function(e){return this.stripValuesIfNeeded([e])[0]}},{key:"stripValuesIfNeeded",value:function(e){var t=this.cellProperties.allowHtml,n=(0,p.Sc)(e,(function(e){return(0,y.Pz)(e)}));return(0,p.Sc)(n,(function(e){return t?e:(0,w.oN)(e)}))}},{key:"allowKeyEventPropagation",value:function(e){var t=this.htEditor.getSelectedRangeLast(),n=t?t.from.row:-1,r=!1;return e===C.nx.ARROW_DOWN&&n>0&&n<this.htEditor.countRows()-1&&(r=!0),e===C.nx.ARROW_UP&&n>-1&&(r=!0),r}},{key:"onBeforeKeyDown",value:function(e){var t=this,n=T.get(this);if(n.skipOne=!1,(0,C.EA)(e.keyCode)||e.keyCode===C.nx.BACKSPACE||e.keyCode===C.nx.DELETE||e.keyCode===C.nx.INSERT){var r=10;if(e.keyCode===C.nx.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout((function(){t.queryChoices(t.TEXTAREA.value),n.skipOne=!0}),r)}}}],[{key:"EDITOR_TYPE",get:function(){return"autocomplete"}}]),n}(v),R=n(1131),k=function(e){(0,a.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"prepare",value:function(e,t,r,i,a,l){(0,o.Z)((0,s.Z)(n.prototype),"prepare",this).call(this,e,t,r,i,a,l),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}],[{key:"EDITOR_TYPE",get:function(){return"dropdown"}}]),n}(E);R.Z.getSingleton().add("beforeValidate",(function(e,t,n){var r=this.getCellMeta(t,this.propToCol(n));r.editor===k&&void 0===r.strict&&(r.filter=!1,r.strict=!0)}));var _=n(6067);function O(e,t){var n=e;null!==n&&void 0!==n||(n=""),this.allowEmpty&&""===n?t(!0):this.strict&&this.source?"function"===typeof this.source?this.source(n,M(n,t)):M(n,t)(this.source):t(!0)}function M(e,t){var n=e;return function(e){for(var r=!1,i=0,o=e.length;i<o;i++)if(n===e[i]){r=!0;break}t(r)}}O.VALIDATOR_TYPE="autocomplete";var x={CELL_TYPE:"dropdown",editor:k,renderer:_.A,validator:O}},9679:function(e,t,n){"use strict";n.d(t,{DA:function(){return h},V1:function(){return c},xN:function(){return d}});var r=n(3107),i=n(4699),o=n(7872),s=n(9115),a=(0,r.Z)("cellTypes"),l=a.register,u=a.getItem,c=a.hasItem;a.getNames,a.getValues;function h(e){if(!c(e))throw Error('You declared cell type "'.concat(e,'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method'));return u(e)}function d(e,t){"string"!==typeof e&&(e=(t=e).CELL_TYPE);var n=t,r=n.editor,a=n.renderer,u=n.validator;r&&(0,i.qm)(e,r),a&&(0,o.zn)(e,a),u&&(0,s.Ie)(e,u),l(e,t)}},63:function(e,t,n){"use strict";n.d(t,{L:function(){return v}});var r=n(5671),i=n(3144),o=n(1752),s=n(1120),a=n(136),l=n(7277),u=n(1),c=function(e){(0,a.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"prepare",value:function(e,t,r,i,a,l){(0,o.Z)((0,s.Z)(n.prototype),"prepare",this).call(this,e,t,r,i,a,l),this.TEXTAREA.dir="ltr"}}],[{key:"EDITOR_TYPE",get:function(){return"time"}}]),n}(u.H),h=n(174);function d(e,t,n,r,i,o,s){h.V.apply(this,[e,t,n,r,i,o,s]),t.dir="ltr"}d.RENDERER_TYPE="time";var f=n(2426),g=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function m(e,t){var n=this.timeFormat||"h:mm:ss a",r=!0,i=e;null===i&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;var o=/^\d{1,2}$/.test(i);o&&(i+=":00");var s=f(i,g,!0).isValid()?f(i):f(i,n),a=s.isValid(),l=f(i,n,!0).isValid()&&!o;if(this.allowEmpty&&""===i&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(!0===this.correctFormat){var u=s.format(n),c=this.instance.toVisualRow(this.row),h=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,h,u,"timeValidator"),r=!0}else r=!1;t(r)}m.VALIDATOR_TYPE="time";var v={CELL_TYPE:"time",editor:c,renderer:d,validator:m}},1643:function(e,t,n){"use strict";n.d(t,{HJ:function(){return f},PP:function(){return g}});var r=n(9439),i=n(1413),o=n(5671),s=n(3144),a=n(5941),l=n(1528),u=n(8492),c=n(4699),h=n(3713),d=n(7117),f="editorManager.navigation",g="editorManager.handlingEditor",m=function(){function e(t,n,r){var i=this;(0,o.Z)(this,e),this.instance=t,this.tableMeta=n,this.selection=r,this.eventManager=new h.Z(t),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.instance.getShortcutManager().addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",(function(e){return i.onAfterDocumentKeyDown(e)})),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",(function(e){!i.destroyed&&i.instance.isListening()&&i.openEditor("",e)})),this.instance.view._wt.update("onCellDblClick",(function(e,t,n){return i.onCellDblClick(e,t,n)}))}return(0,s.Z)(e,[{key:"registerShortcuts",value:function(){var e=this,t=this.instance.getShortcutManager(),n=t.getContext("grid"),r=t.getContext("editor"),o={group:g};r.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:function(n,r){e.closeEditorAndSaveChanges(t.isCtrlPressed()),e.moveSelectionAfterEnter(r.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:function(){e.closeEditorAndRestoreOriginalValue(t.isCtrlPressed()),e.activeEditor.focus()}}],o),n.addShortcuts([{keys:[["F2"]],callback:function(t){e.openEditor(null,t,!0)}},{keys:[["Backspace"],["Delete"]],callback:function(){e.instance.emptySelectedCells(),e.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:function(t,n){e.instance.getSettings().enterBeginsEditing?e.cellProperties.readOnly?e.moveSelectionAfterEnter():e.openEditor(null,t,!0):e.moveSelectionAfterEnter(n.includes("shift")),(0,l.mM)(t)}}],(0,i.Z)((0,i.Z)({},o),{},{runOnlyIf:function(){return(0,d.$K)(e.instance.getSelected())}}))}},{key:"lockEditor",value:function(){this.lock=!0}},{key:"unlockEditor",value:function(){this.lock=!1}},{key:"destroyEditor",value:function(e){this.lock||this.closeEditor(e)}},{key:"getActiveEditor",value:function(){return this.activeEditor}},{key:"prepareEditor",value:function(){var e=this;if(!this.lock)if(this.activeEditor&&this.activeEditor.isWaiting())this.closeEditor(!1,!1,(function(t){t&&e.prepareEditor()}));else{var t=this.instance.getSelectedRangeLast().highlight,n=t.row,i=t.col,o=this.instance.runHooks("modifyGetCellCoords",n,i),s=n,a=i;if(Array.isArray(o)){var l=(0,r.Z)(o,2);s=l[0],a=l[1]}this.cellProperties=this.instance.getCellMeta(s,a);var h=this.instance.rootDocument.activeElement;if(h&&(0,u.pV)(h)&&h.blur(),this.isCellEditable()){var d=this.instance.getCell(n,i,!0);if(d){var f=this.instance.getCellEditor(this.cellProperties),g=this.instance.colToProp(a),m=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(s),a);this.activeEditor=(0,c.Jq)(f,this.instance),this.activeEditor.prepare(n,i,g,d,m,this.cellProperties)}}else this.clearActiveEditor()}}},{key:"isEditorOpened",value:function(){return this.activeEditor&&this.activeEditor.isOpened()}},{key:"openEditor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.isCellEditable()){if(!this.activeEditor){var r=this.instance.getSelectedRangeLast().highlight,i=r.row,o=r.col,s=this.instance.rowIndexMapper.getRenderableFromVisualIndex(i),a=this.instance.columnIndexMapper.getRenderableFromVisualIndex(o);this.instance.view.scrollViewport(this.instance._createCellCoords(s,a)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}else this.clearActiveEditor()}},{key:"closeEditor",value:function(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}},{key:"closeEditorAndSaveChanges",value:function(e){this.closeEditor(!1,e)}},{key:"closeEditorAndRestoreOriginalValue",value:function(e){this.closeEditor(!0,e)}},{key:"clearActiveEditor",value:function(){this.activeEditor=void 0}},{key:"isCellEditable",value:function(){var e=this.instance.getCellEditor(this.cellProperties),t=this.instance.getSelectedRangeLast().highlight,n=t.row,r=t.col,i=this.instance,o=i.rowIndexMapper,s=i.columnIndexMapper,a=o.isHidden(this.instance.toPhysicalRow(n))||s.isHidden(this.instance.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!e||a)}},{key:"moveSelectionAfterEnter",value:function(e){var t="function"===typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}},{key:"onAfterDocumentKeyDown",value:function(e){var t=this;if(this.instance.isListening()){var n=e.keyCode;if(this.selection.isSelected()){var r=(e.ctrlKey||e.metaKey)&&!e.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!(0,a.DC)(n)&&!(0,a.T2)(n)&&!r&&!this.isEditorOpened()){var i=this.instance.getShortcutManager().getContext("editor"),o={runOnlyIf:function(){return(0,d.$K)(t.instance.getSelected())},group:f};i.addShortcuts([{keys:[["ArrowUp"]],callback:function(){t.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){t.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){t.instance.selection.transformStart(0,-1*t.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){t.instance.selection.transformStart(0,t.instance.getDirectionFactor())}}],o),this.openEditor("",e)}}}}},{key:"onCellDblClick",value:function(e,t,n){"TD"===n.nodeName&&this.openEditor(null,e,!0)}},{key:"destroy",value:function(){this.destroyed=!0,this.eventManager.destroy()}}]),e}(),v=new WeakMap;m.getInstance=function(e,t,n){var r=v.get(e);return r||(r=new m(e,t,n),v.set(e,r)),r},t.ZP=m},8579:function(e,t,n){"use strict";n.d(t,{Hf:function(){return p},ed:function(){return m},PP:function(){return v}});var r=n(9439),i=n(136),o=n(7277),s=n(5671),a=n(3144),l=n(7117),u=n(4170),c=n(1643),h=n(2063),d={_hooksStorage:Object.create(null),addHook:function(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey:function(e){var t=this;(0,h.Bk)(this._hooksStorage[e]||[],(function(n){t.hot.removeHook(e,n)}))},clearHooks:function(){var e=this;(0,u._l)(this._hooksStorage,(function(t,n){return e.removeHooksByKey(n)})),this._hooksStorage={}}};(0,u.jW)(d,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var f=d,g=n(8492),m=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),v="baseEditor",p=function(){function e(t){(0,s.Z)(this,e),this.hot=t,this.instance=t,this.state=m.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}return(0,a.Z)(e,[{key:"_fireCallbacks",value:function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}},{key:"init",value:function(){}},{key:"getValue",value:function(){throw Error("Editor getValue() method unimplemented")}},{key:"setValue",value:function(){throw Error("Editor setValue() method unimplemented")}},{key:"open",value:function(){throw Error("Editor open() method unimplemented")}},{key:"close",value:function(){throw Error("Editor close() method unimplemented")}},{key:"prepare",value:function(e,t,n,r,i,o){this.TD=r,this.row=e,this.col=t,this.prop=n,this.originalValue=i,this.cellProperties=o,this.state=m.VIRGIN}},{key:"extend",value:function(){return function(e){(0,i.Z)(n,e);var t=(0,o.Z)(n);function n(){return(0,s.Z)(this,n),t.apply(this,arguments)}return(0,a.Z)(n)}(this.constructor)}},{key:"saveValue",value:function(e,t){var n,i,o,s,a=this;if(t){var u=this.hot.getSelectedLast();n=Math.max(Math.min(u[0],u[2]),0),i=Math.max(Math.min(u[1],u[3]),0),o=Math.max(u[0],u[2]),s=Math.max(u[1],u[3])}else{var c=[this.row,this.col,null,null];n=c[0],i=c[1],o=c[2],s=c[3]}var h=this.hot.runHooks("modifyGetCellCoords",n,i);if(Array.isArray(h)){var d=(0,r.Z)(h,2);n=d[0],i=d[1]}var f=this.hot.getShortcutManager().getContext("editor"),g={runOnlyIf:function(){return(0,l.$K)(a.hot.getSelected())},group:v};this.isInFullEditMode()&&f.addShortcuts([{keys:[["ArrowUp"]],callback:function(){a.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:function(){a.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:function(){a.hot.selection.transformStart(0,-1*a.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:function(){a.hot.selection.transformStart(0,a.hot.getDirectionFactor())}}],g),this.hot.populateFromArray(n,i,e,o,s,"edit")}},{key:"beginEditing",value:function(e,t){if(this.state===m.VIRGIN){var n=this.hot,r=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(r,i)),this.state=m.EDITING,this.isInFullEditMode()){var o="string"===typeof e?e:(0,l.Pz)(this.originalValue);this.setValue(o)}this.open(t),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}}},{key:"finishEditing",value:function(e,t,n){var r,i=this;if(n){var o=this._closeCallback;this._closeCallback=function(e){o&&o(e),n(e),i.hot.view.render()}}if(!this.isWaiting()){var s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(v),s.removeShortcutsByGroup(c.HJ),this.state!==m.VIRGIN){if(this.state===m.EDITING){if(e)return this.cancelChanges(),void this.hot.view.render();var a=this.getValue();r=this.cellProperties.trimWhitespace?[["string"===typeof a?String.prototype.trim.call(a||""):a]]:[[a]],this.state=m.WAITING,this.saveValue(r,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(function(e){i.state=m.FINISHED,i.discardEditor(e)})):(this.state=m.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((function(){i._fireCallbacks(!0)}))}}},{key:"cancelChanges",value:function(){this.state=m.FINISHED,this.discardEditor()}},{key:"discardEditor",value:function(e){this.state===m.FINISHED&&(!1===e&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=m.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=m.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}},{key:"enableFullEditMode",value:function(){this._fullEditMode=!0}},{key:"isInFullEditMode",value:function(){return this._fullEditMode}},{key:"isOpened",value:function(){return this._opened}},{key:"isWaiting",value:function(){return this.state===m.WAITING}},{key:"getEditedCellRect",value:function(){var e,t=this.getEditedCell();if(t){var n=this.hot.view._wt,r=n.wtOverlays,i=n.wtViewport,o=this.hot.rootWindow,s=(0,g.cv)(t),a=(0,g.iO)(t),l=(0,g.cv)(this.hot.rootElement),u=(0,g.iO)(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,m=o.innerWidth-l.left-u,v=(null!==(e=r.getParentOverlay(t))&&void 0!==e?e:this.hot.view._wt).wtTable,p=v.name,y=["master","inline_start"].includes(p)?d:0,w=["master","top","bottom"].includes(p)?f:0,C=s.top===l.top?0:1,b=s.top-l.top-C-y,S=0;S=this.hot.isRtl()?o.innerWidth-s.left-a-m-1+w:s.left-l.left-1-w,["top","top_inline_start_corner"].includes(p)&&(b+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(p)&&(S+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));var T=this.hot.hasColHeaders(),E=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),R=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),k=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(T&&E<=0||E===k)&&(b+=1),R<=0&&(S+=1);var _=i.rowsRenderCalculator.startPosition,O=i.columnsRenderCalculator.startPosition,M=Math.abs(r.inlineStartOverlay.getScrollPosition()),x=r.topOverlay.getScrollPosition(),N=(0,g.np)(this.hot.rootDocument),I=t.offsetTop+_-x,D=0;if(this.hot.isRtl()){var H=t.offsetLeft;D=H>=0?v.getWidth()-t.offsetLeft:Math.abs(H),D+=O-M-a}else D=t.offsetLeft+O-M;var A=(0,g.Dx)(this.TD,this.hot.rootWindow),L=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",P=parseInt(A[L],10)>0?0:1,V=parseInt(A.borderTopWidth,10)>0?0:1,W=(0,g.iO)(t)+P,F=(0,g.Pb)(t)+V,B=(0,g.do)(c)?N:0,Z=(0,g.vw)(h)?N:0,j=this.hot.view.maximumVisibleElementWidth(D)-B+P;return{top:b,start:S,height:F,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(I)-Z+V,23),width:W,maxWidth:j}}}},{key:"getEditedCellsLayerClass",value:function(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}},{key:"getEditedCell",value:function(){return this.hot.getCell(this.row,this.col,!0)}},{key:"checkEditorSection",value:function(){var e=this.hot.countRows(),t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}],[{key:"EDITOR_TYPE",get:function(){return"base"}}]),e}();(0,u.jB)(p,f)},4699:function(e,t,n){"use strict";n.d(t,{Jq:function(){return h},Wu:function(){return u},qm:function(){return f},y$:function(){return d}});var r=n(1131),i=n(3107),o=new WeakMap,s=(0,i.Z)("editors"),a=s.register,l=s.getItem,u=s.hasItem;s.getNames,s.getValues;function c(e){var t={},n=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new n(e)),t[e.guid]},r.Z.getSingleton().add("afterDestroy",(function(){t[this.guid]=null}))}function h(e,t){var n;if("function"===typeof e)o.get(e)||f(null,e),n=o.get(e);else{if("string"!==typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');n=l(e)}if(!n)throw Error('No editor registered under name "'.concat(e,'"'));return n.getInstance(t)}function d(e){if("function"===typeof e)return e;if(!u(e))throw Error('No registered editor found under "'.concat(e,'" name'));return l(e).getConstructor()}function f(e,t){e&&"string"!==typeof e&&(e=(t=e).EDITOR_TYPE);var n=new c(t);"string"===typeof e&&a(e,n),o.set(t,n)}},1:function(e,t,n){"use strict";n.d(t,{H:function(){return T}});var r=n(9439),i=n(5671),o=n(3144),s=n(7326),a=n(1752),l=n(1120),u=n(136),c=n(7277),h=n(8579),d=n(3713),f=n(2486),g=n(8492),m=n(9373),v=n(5941);function p(){var e,t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=document.body,r=document.createTextNode(""),i=document.createElement("SPAN"),o=function(e,t,n){e.addEventListener(t,n,!1)},s=function(e,t,n){e.removeEventListener(t,n,!1)},a=function(o){var s,a;o?/^[a-zA-Z \.,\\\/\|0-9]$/.test(o)||(o="."):o="",void 0!==r.textContent?r.textContent=e.value+o:r.data=e.value+o,i.style.position="absolute",i.style.fontSize=c(e).fontSize,i.style.fontFamily=c(e).fontFamily,i.style.whiteSpace="pre",n.appendChild(i),s=i.clientWidth+2,n.removeChild(i),e.style.height=t.minHeight+"px",t.minWidth>s?e.style.width=t.minWidth+"px":s>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=s+"px",a=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>a?e.style.height=t.minHeight+"px":t.maxHeight<a?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=a+"px"},l=function(){window.setTimeout(a,0)},u=function(n,s,u){e=n,function(n){if(n&&n.minHeight)if("inherit"==n.minHeight)t.minHeight=e.clientHeight;else{var o=parseInt(n.minHeight);isNaN(o)||(t.minHeight=o)}if(n&&n.maxHeight)if("inherit"==n.maxHeight)t.maxHeight=e.clientHeight;else{var s=parseInt(n.maxHeight);isNaN(s)||(t.maxHeight=s)}if(n&&n.minWidth)if("inherit"==n.minWidth)t.minWidth=e.clientWidth;else{var a=parseInt(n.minWidth);isNaN(a)||(t.minWidth=a)}if(n&&n.maxWidth)if("inherit"==n.maxWidth)t.maxWidth=e.clientWidth;else{var l=parseInt(n.maxWidth);isNaN(l)||(t.maxWidth=l)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}(s),"TEXTAREA"==e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),u&&(o(e,"change",a),o(e,"cut",l),o(e,"paste",l),o(e,"drop",l),o(e,"keydown",l),o(e,"focus",a),o(e,"compositionstart",l),o(e,"compositionupdate",l),o(e,"compositionend",l)),a()};function c(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}return{init:function(e,t,n){u(e,t,n)},unObserve:function(){s(e,"change",a),s(e,"cut",l),s(e,"paste",l),s(e,"drop",l),s(e,"keydown",l),s(e,"focus",a),s(e,"compositionstart",l),s(e,"compositionupdate",l),s(e,"compositionend",l)},resize:a}}var y=n(7117),w=n(1643);function C(e,t){for(var n=(0,g.qK)(t),r=t.value.split("\n"),i=n,o=0,s=0;s<r.length;s++){var a=r[s];0!==s&&(o+=r[s-1].length+1);var l=o+a.length;if("home"===e?i=o:"end"===e&&(i=l),n<=l)break}(0,g.Mq)(t,i)}var b="ht_editor_hidden",S="textEditor",T=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this,e)).eventManager=new d.Z((0,s.Z)(r)),r.autoResize=p(),r.TEXTAREA=void 0,r.textareaStyle=void 0,r.TEXTAREA_PARENT=void 0,r.textareaParentStyle=void 0,r.layerClass=void 0,r.createElements(),r.bindEvents(),r.hot.addHookOnce("afterDestroy",(function(){return r.destroy()})),r}return(0,o.Z)(n,[{key:"getValue",value:function(){return this.TEXTAREA.value}},{key:"setValue",value:function(e){this.TEXTAREA.value=e}},{key:"open",value:function(){var e=this;this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",(function(t){return e.onAfterDocumentKeyDown(t)})),this.registerShortcuts()}},{key:"close",value:function(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}},{key:"prepare",value:function(e,t,r,i,o,s){var u=this.state;if((0,a.Z)((0,l.Z)(n.prototype),"prepare",this).call(this,e,t,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);var c=s.allowInvalid,d=s.fragmentSelection;c&&(this.TEXTAREA.value=""),u!==h.ed.FINISHED&&this.hideEditableElement(),!d&&!(0,f.K1)()&&this.focus()}}},{key:"beginEditing",value:function(e,t){this.state===h.ed.VIRGIN&&(this.TEXTAREA.value="",(0,a.Z)((0,l.Z)(n.prototype),"beginEditing",this).call(this,e,t))}},{key:"focus",value:function(){this.TEXTAREA.select(),(0,g.Mq)(this.TEXTAREA,this.TEXTAREA.value.length)}},{key:"createElements",value:function(){var e=this.hot.rootDocument;this.TEXTAREA=e.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,(0,g.cn)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),(0,g.cn)(this.TEXTAREA_PARENT,"handsontableInputHolder"),(0,g.pv)(this.TEXTAREA_PARENT,this.layerClass)&&(0,g.IV)(this.TEXTAREA_PARENT,this.layerClass),(0,g.cn)(this.TEXTAREA_PARENT,b),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}},{key:"hideEditableElement",value:function(){(0,f.un)()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",(0,g.IV)(this.TEXTAREA_PARENT,this.layerClass),(0,g.cn)(this.TEXTAREA_PARENT,b)}},{key:"showEditableElement",value:function(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";var e=this.TEXTAREA_PARENT.childNodes,t=!1;(0,m.q4)(e.length-1,(function(n){var r=e[n];if((0,g.pv)(r,"handsontableEditor"))return t=!0,!1})),(0,g.pv)(this.TEXTAREA_PARENT,b)&&(0,g.IV)(this.TEXTAREA_PARENT,b),t?(this.layerClass="ht_editor_visible",(0,g.cn)(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),(0,g.cn)(this.TEXTAREA_PARENT,this.layerClass))}},{key:"refreshValue",value:function(){var e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}},{key:"refreshDimensions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state===h.ed.EDITING||e)if(this.TD=this.getEditedCell(),this.TD){var t=this.getEditedCellRect(),n=t.top,r=t.start,i=t.width,o=t.maxWidth,s=t.height,a=t.maxHeight;this.textareaParentStyle.top="".concat(n,"px"),this.textareaParentStyle[this.hot.isRtl()?"right":"left"]="".concat(r,"px"),this.showEditableElement();var l=(0,g.Dx)(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;var u=(0,g.Dx)(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),d=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),f=i-c,m=s-d,v=o-c,p=a-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(f,v),minHeight:Math.min(m,p),maxWidth:v,maxHeight:p},!0)}else e||this.close()}},{key:"bindEvents",value:function(){var e=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",(function(e){return e.stopPropagation()})),this.eventManager.addEventListener(this.TEXTAREA,"paste",(function(e){return e.stopPropagation()})),(0,f.gn)()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(function(){return e.finishEditing(!1)})),this.addHook("afterScrollHorizontally",(function(){return e.refreshDimensions()})),this.addHook("afterScrollVertically",(function(){return e.refreshDimensions()})),this.addHook("afterColumnResize",(function(){e.refreshDimensions(),e.focus()})),this.addHook("afterRowResize",(function(){e.refreshDimensions(),e.focus()}))}},{key:"allowKeyEventPropagation",value:function(){}},{key:"destroy",value:function(){this.eventManager.destroy(),this.clearHooks()}},{key:"registerShortcuts",value:function(){var e=this,t=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:function(){return(0,y.$K)(e.hot.getSelected())},group:S},i=function(){e.hot.rootDocument.execCommand("insertText",!1,"\n")};t.addShortcuts([{keys:[["Tab"]],callback:function(t){var n=e.hot.getSettings(),r="function"===typeof n.tabMoves?n.tabMoves(t):n.tabMoves;e.hot.selection.transformStart(r.row,r.col,!0)}},{keys:[["Shift","Tab"]],callback:function(t){var n=e.hot.getSettings(),r="function"===typeof n.tabMoves?n.tabMoves(t):n.tabMoves;e.hot.selection.transformStart(-r.row,-r.col)}},{keys:[["Control","Enter"]],callback:function(){return i(),!1},runOnlyIf:function(t){return!e.hot.selection.isMultiple()&&!t.altKey},relativeToGroup:w.PP,position:"before"},{keys:[["Meta","Enter"]],callback:function(){return i(),!1},runOnlyIf:function(){return!e.hot.selection.isMultiple()},relativeToGroup:w.PP,position:"before"},{keys:[["Alt","Enter"]],callback:function(){return i(),!1},relativeToGroup:w.PP,position:"before"},{keys:[["PageUp"]],callback:function(){e.hot.selection.transformStart(-e.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:function(){e.hot.selection.transformStart(e.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:function(t,n){C((0,r.Z)(n,1)[0],e.TEXTAREA)}},{keys:[["End"]],callback:function(t,n){C((0,r.Z)(n,1)[0],e.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:function(){e.hot._registerTimeout((function(){e.autoResize.resize()}),10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:function(){e.hot._registerTimeout((function(){e.autoResize.resize()}),10)}}],n)}},{key:"unregisterShortcuts",value:function(){var e=this.hot.getShortcutManager().getContext("editor");e.removeShortcutsByGroup(w.HJ),e.removeShortcutsByGroup(S),e.removeShortcutsByGroup(h.PP)}},{key:"onAfterDocumentKeyDown",value:function(e){-1===[v.nx.ARROW_UP,v.nx.ARROW_RIGHT,v.nx.ARROW_DOWN,v.nx.ARROW_LEFT].indexOf(e.keyCode)&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}],[{key:"EDITOR_TYPE",get:function(){return"text"}}]),n}(h.Hf)},3713:function(e,t,n){"use strict";var r=n(5671),i=n(3144),o=n(1528),s=function(){function e(){(0,r.Z)(this,e);var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return(0,i.Z)(e,[{key:"addEventListener",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function s(e){n.call(this,function(e){var t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),(0,o.mM)(this)},e}(e))}return this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:s,options:i,eventManager:this}),e.addEventListener(t,s,i),1,function(){r.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){for(var r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.context.eventListeners.length;o;)if(o-=1,(r=this.context.eventListeners[o]).event===t&&r.element===e){if(n&&n!==r.callback)continue;if(i&&r.eventManager!==this)continue;this.context.eventListeners.splice(o,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),1}}},{key:"clearEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.context)for(var t=this.context.eventListeners.length;t;){t-=1;var n=this.context.eventListeners[t];e&&n.eventManager!==this||(this.context.eventListeners.splice(t,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),1)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"destroyWithOwnEventsOnly",value:function(){this.clearEvents(!0),this.context=null}},{key:"fireEvent",value:function(e,t){var n=e.document,r=e;n||(r=(n=e.ownerDocument?e.ownerDocument:e).defaultView);var i,o={bubbles:!0,cancelable:"mousemove"!==t,view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};n.createEvent?(i=n.createEvent("MouseEvents")).initMouseEvent(t,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget||n.body.parentNode):i=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(i):e.fireEvent("on".concat(t),i)}}]),e}();t.Z=s},2063:function(e,t,n){"use strict";function r(e){for(var t=e.length,n=0;n<t;)e[n]=[e[n]],n+=1}function i(e,t){for(var n=t.length,r=0;r<n;)e.push(t[r]),r+=1}function o(e){var t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;for(var n=e.length,r=e[0].length,i=0;i<n;i++)for(var o=0;o<r;o++)t[o]||(t[o]=[]),t[o][i]=e[i][o];return t}function s(e,t,n,r){var i=-1,o=e,s=n;Array.isArray(e)||(o=Array.from(e));var a=o.length;for(r&&a&&(s=o[i+=1]),i+=1;i<a;)s=t(s,o[i],i,o),i+=1;return s}function a(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));for(var i=r.length,o=[],s=-1;n<i;){var a=r[n];t(a,n,r)&&(o[s+=1]=a),n+=1}return o}function l(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));for(var i=r.length,o=[],s=-1;n<i;){var a=r[n];o[s+=1]=t(a,n,r),n+=1}return o}function u(e,t){var n=0,r=e;Array.isArray(e)||(r=Array.from(e));for(var i=r.length;n<i&&!1!==t(r[n],n,r);)n+=1;return e}function c(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=[].concat(t),i=r[0],o=r.slice(1),s=i;return u(o,(function(e){s=s.filter((function(t){return!e.includes(t)}))})),s}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)}n.d(t,{Bk:function(){return u},PI:function(){return r},Sc:function(){return l},W7:function(){return h},g9:function(){return i},jz:function(){return o},k$:function(){return s},o0:function(){return c},w7:function(){return a}})},2486:function(e,t,n){"use strict";n.d(t,{E6:function(){return l},K1:function(){return d},L:function(){return g},eE:function(){return m},gn:function(){return f},i7:function(){return a},iF:function(){return c},un:function(){return h},vU:function(){return u}});var r=n(4170),i=function(e){var t={value:!1,test:function(n,r){t.value=e(n,r)}};return t},o={chrome:i((function(e,t){return/Chrome/.test(e)&&/Google/.test(t)})),chromeWebKit:i((function(e){return/CriOS/.test(e)})),edge:i((function(e){return/Edge/.test(e)})),edgeWebKit:i((function(e){return/EdgiOS/.test(e)})),firefox:i((function(e){return/Firefox/.test(e)})),firefoxWebKit:i((function(e){return/FxiOS/.test(e)})),mobile:i((function(e){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)})),safari:i((function(e,t){return/Safari/.test(e)&&/Apple Computer/.test(t)}))},s={mac:i((function(e){return/^Mac/.test(e)})),win:i((function(e){return/^Win/.test(e)})),linux:i((function(e){return/^Linux/.test(e)})),ios:i((function(e){return/iPhone|iPad|iPod/i.test(e)}))};function a(){return o.chrome.value}function l(){return o.chromeWebKit.value}function u(){return o.firefox.value}function c(){return o.firefoxWebKit.value}function h(){return o.edge.value}function d(){return o.mobile.value}function f(){return s.ios.value}function g(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator).maxTouchPoints>2&&s.mac.value}function m(){return s.mac.value}!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userAgent,n=void 0===t?navigator.userAgent:t,i=e.vendor,s=void 0===i?navigator.vendor:i;(0,r._l)(o,(function(e){(0,e.test)(n,s)}))}(),function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).platform,t=void 0===e?navigator.platform:e;(0,r._l)(s,(function(e){(0,e.test)(t)}))}()},1734:function(e,t,n){"use strict";n.d(t,{ZK:function(){return i},vU:function(){return o}});var r=n(7117);function i(){var e;(0,r.$K)(console)&&(e=console).warn.apply(e,arguments)}function o(){var e;(0,r.$K)(console)&&(e=console).error.apply(e,arguments)}},8492:function(e,t,n){"use strict";n.d(t,{$g:function(){return M},AQ:function(){return E},C2:function(){return x},DZ:function(){return R},Dx:function(){return N},G_:function(){return o},I2:function(){return U},IV:function(){return m},Kz:function(){return c},MO:function(){return u},Mq:function(){return F},Pb:function(){return D},TT:function(){return K},W6:function(){return l},WH:function(){return Y},WS:function(){return H},Wu:function(){return v},a7:function(){return W},cS:function(){return p},cn:function(){return g},cv:function(){return T},cx:function(){return k},dD:function(){return O},do:function(){return Z},f5:function(){return s},hd:function(){return X},iO:function(){return I},kg:function(){return P},mK:function(){return h},mR:function(){return V},np:function(){return B},oq:function(){return a},pV:function(){return G},pn:function(){return S},pv:function(){return f},qK:function(){return L},tT:function(){return b},u7:function(){return z},uS:function(){return C},vj:function(){return _},vw:function(){return j},x9:function(){return A}});var r=n(3433),i=n(4638);function o(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,r=null,i=e;null!==i;){if(n===t){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function s(e){return function(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}(e)&&e.parent}function a(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=Node,i=r.ELEMENT_NODE,o=r.DOCUMENT_FRAGMENT_NODE,s=e;null!==s&&void 0!==s&&s!==n;){var a=s,l=a.nodeType,u=a.nodeName;if(l===i&&(t.includes(u)||t.includes(s)))return s;var c=s.host;s=c&&l===o?c:s.parentNode}return null}function l(e,t,n){for(var r=[],i=e;i&&(i=a(i,t,n))&&(!n||n.contains(i));)r.push(i),i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode;var o=r.length;return o?r[o-1]:null}function u(e,t){var n=e.parentNode,r=[];for("string"===typeof t?r=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):r.push(t);null!==n;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function c(e){var t=0,n=e;if(n.previousSibling)for(;n=n.previousSibling;)t+=1;return t}function h(e,t,n){var r=n.parentElement.querySelector(".ht_clone_".concat(e));return r?r.contains(t):null}function d(e){return e&&e.length?e.filter((function(e){return!!e})):[]}function f(e,t){return void 0!==e.classList&&"string"===typeof t&&""!==t&&e.classList.contains(t)}function g(e,t){var n;("string"===typeof t&&(t=t.split(" ")),(t=d(t)).length>0)&&(n=e.classList).add.apply(n,(0,r.Z)(t))}function m(e,t){var n;("string"===typeof t&&(t=t.split(" ")),(t=d(t)).length>0)&&(n=e.classList).remove.apply(n,(0,r.Z)(t))}function v(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var t=e.childNodes,n=t.length-1;n>=0;n--)v(t[n])}function p(e){for(var t;t=e.lastChild;)e.removeChild(t)}var y,w=/(<(.*)>|&(.*);)/;function C(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];w.test(t)?e.innerHTML=n?(0,i.Nw)(t):t:b(e,t)}function b(e,t){var n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?n.textContent=t:(p(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function S(e){for(var t=e.ownerDocument.documentElement,n=e;n!==t;){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n.host){if(n.host.impl)return S(n.host.impl);if(n.host)return S(n.host);throw new Error("Lost in Web Components world")}return!1}if(n.style&&"none"===n.style.display)return!1;n=n.parentNode}return!0}function T(e){var t,n,r,i=e.ownerDocument,o=i.defaultView,s=i.documentElement,a=e;for(t=a.offsetLeft,n=a.offsetTop,r=a;(a=a.offsetParent)&&a!==i.body;)t+=a.offsetLeft,n+=a.offsetTop,r=a;return r&&"fixed"===r.style.position&&(t+=o.pageXOffset||s.scrollLeft,n+=o.pageYOffset||s.scrollTop),{left:t,top:n}}function E(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollY}function R(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollX}function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?E(t):e.scrollTop}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?R(t):e.scrollLeft}function O(e){var t=e.ownerDocument,n=t?t.defaultView:void 0;t||(n=(t=e.document?e.document:e).defaultView);for(var r=["auto","scroll"],i=e.parentNode;i&&i.style&&t.body!==i;){var o=i.style,s=o.overflow,a=o.overflowX,l=o.overflowY;if([s,a,l].includes("scroll"))return i;var u=n.getComputedStyle(i);if(s=u.overflow,a=u.overflowX,l=u.overflowY,r.includes(s)||r.includes(a)||r.includes(l))return i;if(i.clientHeight<=i.scrollHeight+1&&(r.includes(l)||r.includes(s)))return i;if(i.clientWidth<=i.scrollWidth+1&&(r.includes(a)||r.includes(s)))return i;i=i.parentNode}return n}function M(e){for(var t=e.ownerDocument,n=t.defaultView,r=e.parentNode;r&&r.style&&t.body!==r;){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;var i=N(r,n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function x(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(e){if(e===n)return"width"===t?"".concat(n.innerWidth,"px"):"height"===t?"".concat(n.innerHeight,"px"):void 0;var r=e.style[t];if(""!==r&&void 0!==r)return r;var i=N(e,n);return""!==i[t]&&void 0!==i[t]?i[t]:void 0}}function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function I(e){return e.offsetWidth}function D(e){return e.offsetHeight}function H(e){return e.clientHeight||e.innerHeight}function A(e){return e.clientWidth||e.innerWidth}function L(e){return e.selectionStart?e.selectionStart:0}function P(e){return e.selectionEnd?e.selectionEnd:0}function V(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document,n="";return e.getSelection?n=e.getSelection().toString():t.selection&&"Control"!==t.selection.type&&(n=t.selection.createRange().text),n}function W(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;e.getSelection&&(e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges())}function F(e,t,n){if(void 0===n&&(n=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,n)}catch(o){var r=e.parentNode,i=r.style.display;r.style.display="block",e.setSelectionRange(t,n),r.style.display=i}}}function B(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===y&&(y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";var n=e.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(t),(e.body||e.documentElement).appendChild(n);var r=t.offsetWidth;n.style.overflow="scroll";var i=t.offsetWidth;return r===i&&(i=n.clientWidth),(e.body||e.documentElement).removeChild(n),r-i}(e)),y}function Z(e){return e.offsetWidth!==e.clientWidth}function j(e){return e.offsetHeight!==e.clientHeight}function U(e,t,n){e.style.transform="translate3d(".concat(t,",").concat(n,",0)")}function Y(e){e.style.transform&&""!==e.style.transform&&(e.style.transform="")}function z(e){return e&&(["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function G(e){return z(e)&&!1===e.hasAttribute("data-hot-input")}function X(e){G(e.ownerDocument.activeElement)||e.select()}function K(e,t){new IntersectionObserver((function(n,r){n.forEach((function(n){n.isIntersecting&&null!==e.offsetParent&&(t(),r.unobserve(e))}))}),{root:e.ownerDocument.body}).observe(e)}},1528:function(e,t,n){"use strict";function r(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function i(e){return!1===e.isImmediatePropagationEnabled}function o(e){return 2===e.button}function s(e){return 0===e.button}n.d(t,{Ty:function(){return i},dO:function(){return o},mM:function(){return r},pW:function(){return s}})},7993:function(e,t,n){"use strict";n.d(t,{$Z:function(){return s},mf:function(){return i},r$:function(){return o}});var r=n(7117);function i(e){return"function"===typeof e}function o(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.apply(this,n.concat(r))}}function s(e,t,n,i,o,s,a,l){return(0,r.$K)(l)?e.call(t,n,i,o,s,a,l):(0,r.$K)(a)?e.call(t,n,i,o,s,a):(0,r.$K)(s)?e.call(t,n,i,o,s):(0,r.$K)(o)?e.call(t,n,i,o):(0,r.$K)(i)?e.call(t,n,i):(0,r.$K)(n)?e.call(t,n):e.call(t)}},7117:function(e,t,n){"use strict";n.d(t,{$K:function(){return f},Kj:function(){return v},Pz:function(){return d},ge:function(){return O},o8:function(){return g},xb:function(){return m}});var r,i,o,s,a,l,u=n(168),c=n(2426),h=n(2933);function d(e){var t;switch(typeof e){case"string":case"number":t="".concat(e);break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t}function f(e){return"undefined"!==typeof e}function g(e){return"undefined"===typeof e}function m(e){return null===e||""===e||g(e)}function v(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var p="length",y=function(e){return parseInt(e,16)},w=function(e){return parseInt(e,10)},C=function(e,t,n){return e.substr(t,n)},b=function(e){return e.codePointAt(0)-65},S=function(e){return"".concat(e).replace(/\-/g,"")},T=function(e){return y(C(S(e),y("12"),b("F")))/(y(C(S(e),b("B"),~~![][p]))||9)},E=function(){return"undefined"!==typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host)},R=!1,k={invalid:function(){return(0,h.e)(r||(r=(0,u.Z)(["\n    The license key for Handsontable is invalid. \n    If you need any help, contact us at support@handsontable.com."],["\n    The license key for Handsontable is invalid.\\x20\n    If you need any help, contact us at support@handsontable.com."])))},expired:function(e){var t=e.keyValidityDate,n=e.hotVersion;return(0,h.e)(i||(i=(0,u.Z)(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior \n    to ",". If you need any help, contact us at sales@handsontable.com."],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",". Renew your license key at handsontable.com or downgrade to a version released prior\\x20\n    to ",". If you need any help, contact us at sales@handsontable.com."])),t,n,t)},missing:function(){return(0,h.e)(o||(o=(0,u.Z)(["\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact \n    us at support@handsontable.com."],["\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\\x20\n    us at support@handsontable.com."])))},non_commercial:function(){return""}},_={invalid:function(){return(0,h.e)(s||(s=(0,u.Z)(['\n    The license key for Handsontable is invalid. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to \n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is invalid.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\\x20\n    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},expired:function(e){var t=e.keyValidityDate,n=e.hotVersion;return(0,h.e)(a||(a=(0,u.Z)(["\n    The license key for Handsontable expired on ",", and is not valid for the installed \n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your \n    license key or downgrade to a version released prior to ','. If you need any \n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'],["\n    The license key for Handsontable expired on ",", and is not valid for the installed\\x20\n    version ",'. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\\x20\n    license key or downgrade to a version released prior to ','. If you need any\\x20\n    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.'])),t,n,t)},missing:function(){return(0,h.e)(l||(l=(0,u.Z)(['\n    The license key for Handsontable is missing. Use your purchased key to activate the product. \n    Alternatively, you can activate Handsontable to use for non-commercial purposes by \n    passing the key: \'non-commercial-and-evaluation\'. \n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in \n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'],['\n    The license key for Handsontable is missing. Use your purchased key to activate the product.\\x20\n    Alternatively, you can activate Handsontable to use for non-commercial purposes by\\x20\n    passing the key: \'non-commercial-and-evaluation\'.\\x20\n    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\\x20\n    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.'])))},non_commercial:function(){return""}};function O(e,t){var n,r=!m(e),i="string"===typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),o="13.1.0",s="invalid",a="invalid",l=function(e){var t=[][p],n=t;if(e[p]!==b("Z"))return!1;for(var r="",i="B<H4P+".split(""),o=b(i.shift());o;o=b(i.shift()||"A"))--o<""[p]?n|=(w("".concat(w(y(r)+(y(C(e,Math.abs(o),2))+[]).padStart(2,"0"))))%97||2)>>1:r=C(e,o,o?1===i[p]?9:8:6);return n===t}(e=S(e||""));if(r||i||l)if(l){var u=c("31/08/2023","DD/MM/YYYY"),h=Math.floor(u.toDate().getTime()/864e5),d=T(e);n=c(864e5*(d+1),"x").format("MMMM DD, YYYY"),h>d?(s="expired",a="expired"):(s="valid",a="valid")}else i?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";(E()&&(s="valid",a="valid"),R||"valid"===s)||(k[s]({keyValidityDate:n,hotVersion:o})&&console["non_commercial"===s?"info":"warn"](k[s]({keyValidityDate:n,hotVersion:o})),R=!0);if("valid"!==a&&t.parentNode&&_[a]({keyValidityDate:n,hotVersion:o})){var f=document.createElement("div");f.className="hot-display-license-info",f.innerHTML=_[a]({keyValidityDate:n,hotVersion:o}),t.parentNode.insertBefore(f,t.nextSibling)}}},9373:function(e,t,n){"use strict";n.d(t,{TR:function(){return o},kE:function(){return i},q4:function(){return s},yh:function(){return a}});var r=n(3433);function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=typeof e;if("number"===n)return!isNaN(e)&&isFinite(e);if("string"===n){if(0===e.length)return!1;if(1===e.length)return/\d/.test(e);var i=Array.from(new Set(["."].concat((0,r.Z)(t)))).map((function(e){return"\\".concat(e)})).join("|");return new RegExp("^[+-]?\\s*(((".concat(i,")?\\d+((").concat(i,")\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$"),"i").test(e.trim())}return"object"===n&&(!!e&&"number"===typeof e.valueOf()&&!(e instanceof Date))}function o(e){return i(e,[","])}function s(e,t,n){var r=-1;for("function"===typeof t?(n=t,t=e):r=e-1;++r<=t&&!1!==n(r););}function a(e,t,n){var r=e+1;for("function"===typeof t&&(n=t,t=0);--r>=t&&!1!==n(r););}},4170:function(e,t,n){"use strict";n.d(t,{$s:function(){return v},ED:function(){return s},Hn:function(){return p},I8:function(){return u},Kn:function(){return f},Q8:function(){return y},Z1:function(){return d},ZB:function(){return l},_l:function(){return m},d9:function(){return c},ie:function(){return o},jB:function(){return h},jW:function(){return g},l7:function(){return a},nr:function(){return C},sm:function(){return w}});var r=n(4942),i=n(2063);function o(e){var t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},m(e,(function(e,n){"__children"!==n&&(e&&"object"===typeof e&&!Array.isArray(e)?t[n]=o(e):Array.isArray(e)?e.length&&"object"===typeof e[0]&&!Array.isArray(e[0])?t[n]=[o(e[0])]:t[n]=[]:t[n]=null)}))),t}function s(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function a(e,t,n){var r=Array.isArray(n);return m(t,(function(t,i){(!1===r||n.includes(i))&&(e[i]=t)})),e}function l(e,t){m(t,(function(n,r){t[r]&&"object"===typeof t[r]?(e[r]||(Array.isArray(t[r])?e[r]=[]:"[object Date]"===Object.prototype.toString.call(t[r])?e[r]=t[r]:e[r]={}),l(e[r],t[r])):e[r]=t[r]}))}function u(e){return"object"===typeof e?JSON.parse(JSON.stringify(e)):e}function c(e){var t={};return m(e,(function(e,n){t[n]=e})),t}function h(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return(0,i.Bk)(n,(function(t){e.MIXINS.push(t.MIXIN_NAME),m(t,(function(t,n){if(void 0!==e.prototype[n])throw new Error("Mixin conflict. Property '".concat(n,"' already exist and cannot be overwritten."));if("function"===typeof t)e.prototype[n]=t;else{Object.defineProperty(e.prototype,n,{get:function(e,t){var n="_".concat(e);return function(){return void 0===this[n]&&(this[n]=function(e){var t=e;return(Array.isArray(t)||f(t))&&(t=u(t)),t}(t)),this[n]}}(n,t),set:function(e){var t="_".concat(e);return function(e){this[t]=e}}(n),configurable:!0})}}))})),e}function d(e,t){return JSON.stringify(e)===JSON.stringify(t)}function f(e){return"[object Object]"===Object.prototype.toString.call(e)}function g(e,t,n,r){r.value=n,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(e,t,r)}function m(e,t){for(var n in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,n))&&!1===t(e[n],n,e))break;return e}function v(e,t){var n=t.split("."),r=e;return m(n,(function(e){if(void 0===(r=r[e]))return r=void 0,!1})),r}function p(e,t,n){var r=t.split("."),i=e;r.forEach((function(e,t){t!==r.length-1?(C(i,e)||(i[e]={}),i=i[e]):i[e]=n}))}function y(e){if(!f(e))return 0;return function e(t){var n=0;return f(t)?m(t,(function(t,r){"__children"!==r&&(n+=e(t))})):n+=1,n}(e)}function w(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",i="_".concat(n),o=(t={_touched:!1},(0,r.Z)(t,i,e),(0,r.Z)(t,"isTouched",(function(){return this._touched})),t);return Object.defineProperty(o,n,{get:function(){return this[i]},set:function(e){this._touched=!0,this[i]=e},enumerable:!0,configurable:!0}),o}function C(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},4638:function(e,t,n){"use strict";n.d(t,{Nw:function(){return l},O1:function(){return o},ct:function(){return i},ng:function(){return s},oN:function(){return a}});var r=n(8703);function i(e){return e[0].toUpperCase()+e.substr(1)}function o(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"".concat(e).replace(/(?:\\)?\[([^[\]]+)]/g,(function(e,n){return"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[n]?"":t[n]}))}function a(e){return l("".concat(e),{ALLOWED_TAGS:[]})}function l(e,t){return r.sanitize(e,t)}},2933:function(e,t,n){"use strict";n.d(t,{e:function(){return i}});var r=n(2063);function i(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return(0,r.k$)(e,(function(e,t,r){return e+t.replace(/\r?\n\s*/g,"")+(n[r]?n[r]:"")}),"").trim()}},5941:function(e,t,n){"use strict";n.d(t,{DC:function(){return l},EA:function(){return a},T2:function(){return u},nx:function(){return o},ot:function(){return c}});var r=n(2063),i=n(2486),o={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:(0,i.vU)()?182:174,AUDIO_MUTE:(0,i.vU)()?181:173,AUDIO_UP:(0,i.vU)()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},s=[o.ALT,o.ARROW_DOWN,o.ARROW_LEFT,o.ARROW_RIGHT,o.ARROW_UP,o.AUDIO_DOWN,o.AUDIO_MUTE,o.AUDIO_UP,o.BACKSPACE,o.CAPS_LOCK,o.DELETE,o.END,o.ENTER,o.ESCAPE,o.F1,o.F2,o.F3,o.F4,o.F5,o.F6,o.F7,o.F8,o.F9,o.F10,o.F11,o.F12,o.F13,o.F14,o.F15,o.F16,o.F17,o.F18,o.F19,o.HOME,o.INSERT,o.MEDIA_NEXT,o.MEDIA_PLAY_PAUSE,o.MEDIA_PREV,o.MEDIA_STOP,o.NULL,o.NUM_LOCK,o.PAGE_DOWN,o.PAGE_UP,o.PAUSE,o.SCROLL_LOCK,o.SHIFT,o.TAB];function a(e){return 32===e||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function l(e){return s.includes(e)}function u(e){return[o.CONTROL,o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX].includes(e)}function c(e,t){var n=t.split("|"),i=!1;return(0,r.Bk)(n,(function(t){if(e===o[t])return i=!0,!1})),i}},4782:function(e,t,n){"use strict";n.r(t),n.d(t,{CONTEXTMENU_ITEMS_ADD_COMMENT:function(){return R},CONTEXTMENU_ITEMS_ALIGNMENT:function(){return M},CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:function(){return L},CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:function(){return N},CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:function(){return D},CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:function(){return x},CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:function(){return A},CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:function(){return I},CONTEXTMENU_ITEMS_ALIGNMENT_TOP:function(){return H},CONTEXTMENU_ITEMS_BORDERS:function(){return P},CONTEXTMENU_ITEMS_BORDERS_BOTTOM:function(){return F},CONTEXTMENU_ITEMS_BORDERS_LEFT:function(){return B},CONTEXTMENU_ITEMS_BORDERS_RIGHT:function(){return W},CONTEXTMENU_ITEMS_BORDERS_TOP:function(){return V},CONTEXTMENU_ITEMS_CLEAR_COLUMN:function(){return m},CONTEXTMENU_ITEMS_COPY:function(){return v},CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:function(){return w},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:function(){return y},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:function(){return p},CONTEXTMENU_ITEMS_CUT:function(){return C},CONTEXTMENU_ITEMS_EDIT_COMMENT:function(){return k},CONTEXTMENU_ITEMS_FREEZE_COLUMN:function(){return b},CONTEXTMENU_ITEMS_HIDE_COLUMN:function(){return Y},CONTEXTMENU_ITEMS_HIDE_ROW:function(){return G},CONTEXTMENU_ITEMS_INSERT_LEFT:function(){return l},CONTEXTMENU_ITEMS_INSERT_RIGHT:function(){return u},CONTEXTMENU_ITEMS_MERGE_CELLS:function(){return T},CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:function(){return U},CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:function(){return j},CONTEXTMENU_ITEMS_NO_ITEMS:function(){return o},CONTEXTMENU_ITEMS_READ_ONLY:function(){return g},CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:function(){return O},CONTEXTMENU_ITEMS_REDO:function(){return f},CONTEXTMENU_ITEMS_REMOVE_BORDERS:function(){return Z},CONTEXTMENU_ITEMS_REMOVE_COLUMN:function(){return h},CONTEXTMENU_ITEMS_REMOVE_COMMENT:function(){return _},CONTEXTMENU_ITEMS_REMOVE_ROW:function(){return c},CONTEXTMENU_ITEMS_ROW_ABOVE:function(){return s},CONTEXTMENU_ITEMS_ROW_BELOW:function(){return a},CONTEXTMENU_ITEMS_SHOW_COLUMN:function(){return z},CONTEXTMENU_ITEMS_SHOW_ROW:function(){return X},CONTEXTMENU_ITEMS_UNDO:function(){return d},CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:function(){return S},CONTEXTMENU_ITEMS_UNMERGE_CELLS:function(){return E},CONTEXT_MENU_ITEMS_NAMESPACE:function(){return r},FILTERS_BUTTONS_CANCEL:function(){return ke},FILTERS_BUTTONS_CLEAR:function(){return Ee},FILTERS_BUTTONS_OK:function(){return Re},FILTERS_BUTTONS_PLACEHOLDER_SEARCH:function(){return _e},FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:function(){return Me},FILTERS_BUTTONS_PLACEHOLDER_VALUE:function(){return Oe},FILTERS_BUTTONS_SELECT_ALL:function(){return Te},FILTERS_CONDITIONS_AFTER:function(){return fe},FILTERS_CONDITIONS_BEFORE:function(){return ge},FILTERS_CONDITIONS_BEGINS_WITH:function(){return ne},FILTERS_CONDITIONS_BETWEEN:function(){return he},FILTERS_CONDITIONS_BY_VALUE:function(){return se},FILTERS_CONDITIONS_CONTAINS:function(){return ie},FILTERS_CONDITIONS_EMPTY:function(){return Q},FILTERS_CONDITIONS_ENDS_WITH:function(){return re},FILTERS_CONDITIONS_EQUAL:function(){return ee},FILTERS_CONDITIONS_GREATER_THAN:function(){return ae},FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:function(){return le},FILTERS_CONDITIONS_LESS_THAN:function(){return ue},FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:function(){return ce},FILTERS_CONDITIONS_NAMESPACE:function(){return q},FILTERS_CONDITIONS_NONE:function(){return $},FILTERS_CONDITIONS_NOT_BETWEEN:function(){return de},FILTERS_CONDITIONS_NOT_CONTAIN:function(){return oe},FILTERS_CONDITIONS_NOT_EMPTY:function(){return J},FILTERS_CONDITIONS_NOT_EQUAL:function(){return te},FILTERS_CONDITIONS_TODAY:function(){return me},FILTERS_CONDITIONS_TOMORROW:function(){return ve},FILTERS_CONDITIONS_YESTERDAY:function(){return pe},FILTERS_DIVS_FILTER_BY_CONDITION:function(){return ye},FILTERS_DIVS_FILTER_BY_VALUE:function(){return we},FILTERS_LABELS_CONJUNCTION:function(){return Ce},FILTERS_LABELS_DISJUNCTION:function(){return be},FILTERS_NAMESPACE:function(){return K},FILTERS_VALUES_BLANK_CELLS:function(){return Se}});var r="ContextMenu:items",i=r,o="".concat(i,".noItems"),s="".concat(i,".insertRowAbove"),a="".concat(i,".insertRowBelow"),l="".concat(i,".insertColumnOnTheLeft"),u="".concat(i,".insertColumnOnTheRight"),c="".concat(i,".removeRow"),h="".concat(i,".removeColumn"),d="".concat(i,".undo"),f="".concat(i,".redo"),g="".concat(i,".readOnly"),m="".concat(i,".clearColumn"),v="".concat(i,".copy"),p="".concat(i,".copyWithHeaders"),y="".concat(i,".copyWithGroupHeaders"),w="".concat(i,".copyHeadersOnly"),C="".concat(i,".cut"),b="".concat(i,".freezeColumn"),S="".concat(i,".unfreezeColumn"),T="".concat(i,".mergeCells"),E="".concat(i,".unmergeCells"),R="".concat(i,".addComment"),k="".concat(i,".editComment"),_="".concat(i,".removeComment"),O="".concat(i,".readOnlyComment"),M="".concat(i,".align"),x="".concat(i,".align.left"),N="".concat(i,".align.center"),I="".concat(i,".align.right"),D="".concat(i,".align.justify"),H="".concat(i,".align.top"),A="".concat(i,".align.middle"),L="".concat(i,".align.bottom"),P="".concat(i,".borders"),V="".concat(i,".borders.top"),W="".concat(i,".borders.right"),F="".concat(i,".borders.bottom"),B="".concat(i,".borders.left"),Z="".concat(i,".borders.remove"),j="".concat(i,".nestedHeaders.insertChildRow"),U="".concat(i,".nestedHeaders.detachFromParent"),Y="".concat(i,".hideColumn"),z="".concat(i,".showColumn"),G="".concat(i,".hideRow"),X="".concat(i,".showRow"),K="Filters:",q="".concat(K,"conditions"),$="".concat(q,".none"),Q="".concat(q,".isEmpty"),J="".concat(q,".isNotEmpty"),ee="".concat(q,".isEqualTo"),te="".concat(q,".isNotEqualTo"),ne="".concat(q,".beginsWith"),re="".concat(q,".endsWith"),ie="".concat(q,".contains"),oe="".concat(q,".doesNotContain"),se="".concat(q,".byValue"),ae="".concat(q,".greaterThan"),le="".concat(q,".greaterThanOrEqualTo"),ue="".concat(q,".lessThan"),ce="".concat(q,".lessThanOrEqualTo"),he="".concat(q,".isBetween"),de="".concat(q,".isNotBetween"),fe="".concat(q,".after"),ge="".concat(q,".before"),me="".concat(q,".today"),ve="".concat(q,".tomorrow"),pe="".concat(q,".yesterday"),ye="".concat(K,"labels.filterByCondition"),we="".concat(K,"labels.filterByValue"),Ce="".concat(K,"labels.conjunction"),be="".concat(K,"labels.disjunction"),Se="".concat(K,"values.blankCells"),Te="".concat(K,"buttons.selectAll"),Ee="".concat(K,"buttons.clear"),Re="".concat(K,"buttons.ok"),ke="".concat(K,"buttons.cancel"),_e="".concat(K,"buttons.placeholder.search"),Oe="".concat(K,"buttons.placeholder.value"),Me="".concat(K,"buttons.placeholder.secondValue")},908:function(e,t,n){"use strict";var r=n(4170),i=n(7993),o={_localHooks:Object.create(null),addLocalHook:function(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks:function(e,t,n,r,o,s,a){if(this._localHooks[e])for(var l=this._localHooks[e].length,u=0;u<l;u++)(0,i.$Z)(this._localHooks[e][u],this,t,n,r,o,s,a)},clearLocalHooks:function(){return this._localHooks={},this}};(0,r.jW)(o,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),t.Z=o},1131:function(e,t,n){"use strict";var r,i=n(5671),o=n(3144),s=n(168),a=n(2063),l=n(4170),u=n(4638),c=n(1734),h=n(2933),d=n(7993),f=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],g=(0,h.e)(r||(r=(0,s.Z)(['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion]. \n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to \n  learn about the migration path.'],['The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\\x20\n  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\\x20\n  learn about the migration path.']))),m=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),v=new Map([]),p=function(){function e(){(0,i.Z)(this,e),this.globalBucket=this.createEmptyBucket()}return(0,o.Z)(e,[{key:"createEmptyBucket",value:function(){var e=Object.create(null);return(0,a.Bk)(f,(function(t){return e[t]=[]})),e}},{key:"getBucket",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}},{key:"add",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))(0,a.Bk)(t,(function(t){return n.add(e,t,r)}));else{m.has(e)&&(0,c.ZK)((0,u.ng)(g,{hookName:e,removedInVersion:m.get(e)})),v.has(e)&&(0,c.ZK)(v.get(e));var i=this.getBucket(r);if("undefined"===typeof i[e]&&(this.register(e),i[e]=[]),t.skip=!1,-1===i[e].indexOf(t)){var o=!1;t.initialHook&&(0,a.Bk)(i[e],(function(n,r){if(n.initialHook)return i[e][r]=t,o=!0,!1})),o||i[e].push(t)}}return this}},{key:"once",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(t)?(0,a.Bk)(t,(function(t){return n.once(e,t,r)})):(t.runOnce=!0,this.add(e,t,r))}},{key:"remove",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(n);return"undefined"!==typeof r[e]&&r[e].indexOf(t)>=0&&(t.skip=!0,!0)}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(t);return!(void 0===n[e]||!n[e].length)}},{key:"run",value:function(e,t,n,r,i,o,s,a){var l=this.globalBucket[t],u=l?l.length:0,c=0;if(u)for(;c<u;)if(l[c]&&!l[c].skip){var h=(0,d.$Z)(l[c],e,n,r,i,o,s,a);void 0!==h&&(n=h),l[c]&&l[c].runOnce&&this.remove(t,l[c]),c+=1}else c+=1;var f=this.getBucket(e)[t],g=f?f.length:0,m=0;if(g)for(;m<g;)if(f[m]&&!f[m].skip){var v=(0,d.$Z)(f[m],e,n,r,i,o,s,a);void 0!==v&&(n=v),f[m]&&f[m].runOnce&&this.remove(t,f[m],e),m+=1}else m+=1;return n}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,l._l)(this.getBucket(e),(function(e,t,n){return n[t].length=0}))}},{key:"register",value:function(e){this.isRegistered(e)||f.push(e)}},{key:"deregister",value:function(e){this.isRegistered(e)&&f.splice(f.indexOf(e),1)}},{key:"isDeprecated",value:function(e){return v.has(e)||m.has(e)}},{key:"isRegistered",value:function(e){return f.indexOf(e)>=0}},{key:"getRegistered",value:function(){return f}}],[{key:"getSingleton",value:function(){return y}}]),e}(),y=new p;t.Z=p},3944:function(e,t,n){"use strict";n.d(t,{v:function(){return w}});var r=n(9439),i=n(5671),o=n(3144),s=n(4170),a=n(2063),l=n(3914),u=n(9679),c=n(4699),h=n(7872),d=n(9115);function f(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}var g=new Map([["plugin",l._j],["cell-type",u.V1],["editor",c.Wu],["renderer",h.Y3],["validator",d.oh]]),m=new WeakMap,v=[],p=null,y=new WeakSet,w=function(){function e(t){var n=this;(0,i.Z)(this,e),f(this,y),(0,s.jW)(this,"hot",t,{writable:!1}),m.set(this,{hooks:{}}),p=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",(function(){return n.onAfterPluginsInitialized()})),this.hot.addHook("afterUpdateSettings",(function(e){return n.onUpdateSettings(e)})),this.hot.addHook("beforeInit",(function(){return n.init()}))}return(0,o.Z)(e,[{key:"init",value:function(){var e=this;this.pluginName=this.hot.getPluginName(this);var t=this.constructor.PLUGIN_DEPS,n=Array.isArray(t)?t:[];if(n.length>0){var i=[];if(n.forEach((function(e){var t=e.split(":"),n=(0,r.Z)(t,2),o=n[0],s=n[1];if(!g.has(o))throw new Error('Unknown plugin dependency type "'.concat(o,'" was found.'));g.get(o)(s)||i.push(" - ".concat(s," (").concat(o,")"))})),i.length>0){var o=["The ".concat(this.pluginName," plugin requires the following modules:\n"),"".concat(i.join("\n"),"\n")].join("");v.push(o)}}if(p||(p=(0,l.a9)()),p.indexOf("UndoRedo")>=0&&p.splice(p.indexOf("UndoRedo"),1),p.indexOf(this.pluginName)>=0&&p.splice(p.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(function(){e.isEnabled&&e.isEnabled()&&e.enablePlugin()})),0===p.length){if(v.length>0){var s=["".concat(v.join("\n"),"\n"),"You have to import and register them manually."].join("");throw new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(e,t){m.get(this).hooks[e]=m.get(this).hooks[e]||[];var n=m.get(this).hooks[e];this.hot.addHook(e,t),n.push(t),m.get(this).hooks[e]=n}},{key:"removeHooks",value:function(e){var t=this;(0,a.Bk)(m.get(this).hooks[e]||[],(function(n){t.hot.removeHook(e,n)}))}},{key:"clearHooks",value:function(){var e=this,t=m.get(this).hooks;(0,s._l)(t,(function(t,n){return e.removeHooks(n)})),t.length=0}},{key:"callOnPluginsReady",value:function(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}},{key:"onAfterPluginsInitialized",value:function(){(0,a.Bk)(this.pluginsInitializedCallbacks,(function(e){return e()})),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(e){var t=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}(this,y,C).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var e=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),(0,s._l)(this,(function(t,n){"hot"!==n&&(e[n]=null)})),delete this.t,delete this.hot}}],[{key:"PLUGIN_KEY",get:function(){return"base"}},{key:"SETTING_KEYS",get:function(){return[this.PLUGIN_KEY]}}]),e}();function C(e){if(!e)return!1;var t=this.constructor.SETTING_KEYS;if("boolean"===typeof t)return t;for(var n=0;n<t.length;n++)if(void 0!==e[t[n]])return!0;return!1}},774:function(e,t,n){"use strict";n.d(t,{_x:function(){return ge}});var r=n(9439),i=n(5671),o=n(3144),s=n(7326),a=n(1752),l=n(1120),u=n(136),c=n(7277),h=n(3944),d=n(1131),f=n(4128),g=n(2063),m=n(4638),v=n(8492),p=n(4782);var y=function(){function e(){(0,i.Z)(this,e),this.data={}}return(0,o.Z)(e,[{key:"setData",value:function(e,t){this.data[e]=t}},{key:"getData",value:function(e){return this.data[e]||void 0}}]),e}(),w=(0,o.Z)((function e(){(0,i.Z)(this,e),this.clipboardData=new y})),C=n(3713),b=n(908),S=n(4170),T=n(2486),E=function(){function e(t){(0,i.Z)(this,e),this.rootDocument=t.defaultView?t:t.ownerDocument,this.mainElement=null,this.eventManager=new C.Z(this),this.listenersCount=new WeakSet,this.container=t}return(0,o.Z)(e,[{key:"useSecondaryElement",value:function(){var e=function(e){var t=O.get(e);if(t)return t.parentElement||e.appendChild(t),t;var n=(e.defaultView?e:e.ownerDocument).createElement("textarea");return O.set(e,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",e.appendChild(n),n}(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),_(this.eventManager,e,this)),this.mainElement=e}},{key:"setFocusableElement",value:function(e){this.listenersCount.has(e)||(this.listenersCount.add(e),_(this.eventManager,e,this)),this.mainElement=e}},{key:"getFocusableElement",value:function(){return this.mainElement}},{key:"focus",value:function(){this.mainElement.value=" ",(0,T.K1)()||(0,v.hd)(this.mainElement)}}]),e}();(0,S.jB)(E,b.Z);var R=new WeakMap;var k=function(e,t){return function(n){return t.runLocalHooks(e,n)}};function _(e,t,n){e.addEventListener(t,"copy",k("copy",n)),e.addEventListener(t,"cut",k("cut",n)),e.addEventListener(t,"paste",k("paste",n))}var O=new WeakMap;function M(e){if(e instanceof E){var t=R.get(e.container);if((t=isNaN(t)?0:t)>0&&(t-=1),function(e){e.eventManager.clear()}(e),t<=0){t=0;var n=O.get(e.container);n&&n.parentNode&&(n.parentNode.removeChild(n),O.delete(e.container)),e.mainElement=null}R.set(e.container,t)}}var x=n(9373);function N(e,t){D(e,t),t.add(e)}function I(e,t,n){D(e,t),t.set(e,n)}function D(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function H(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}function A(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,P(e,t,"get"))}function L(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,P(e,t,"set"),n),n}function P(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var V=new WeakMap,W=new WeakMap,F=new WeakMap,B=new WeakMap,Z=new WeakMap,j=new WeakMap,U=new WeakSet,Y=new WeakSet,z=function(){function e(t){(0,i.Z)(this,e);var n=t.countRows,r=t.countColumns,o=t.rowsLimit,s=t.columnsLimit,a=t.countColumnHeaders;N(this,Y),N(this,U),I(this,V,{writable:!0,value:void 0}),I(this,W,{writable:!0,value:void 0}),I(this,F,{writable:!0,value:void 0}),I(this,B,{writable:!0,value:void 0}),I(this,Z,{writable:!0,value:void 0}),I(this,j,{writable:!0,value:void 0}),L(this,W,n),L(this,F,r),L(this,B,o),L(this,Z,s),L(this,j,a)}return(0,o.Z)(e,[{key:"setSelectedRange",value:function(e){L(this,V,e)}},{key:"getCellsRange",value:function(){if(0===A(this,W).call(this)||0===A(this,F).call(this))return null;var e=A(this,V).getTopStartCorner(),t=e.row,n=e.col,r=A(this,V).getBottomEndCorner(),i=r.row,o=r.col,s=H(this,Y,X).call(this,t,i),a=H(this,U,G).call(this,n,o);return{isRangeTrimmed:i!==s||o!==a,startRow:t,startCol:n,endRow:s,endCol:a}}},{key:"getMostBottomColumnHeadersRange",value:function(){if(0===A(this,F).call(this)||0===A(this,j).call(this))return null;var e=A(this,V).getTopStartCorner().col,t=A(this,V).getBottomEndCorner().col,n=H(this,U,G).call(this,e,t);return{isRangeTrimmed:t!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}},{key:"getAllColumnHeadersRange",value:function(){if(0===A(this,F).call(this)||0===A(this,j).call(this))return null;var e=A(this,V).getTopStartCorner().col,t=A(this,V).getBottomEndCorner().col,n=H(this,U,G).call(this,e,t);return{isRangeTrimmed:t!==n,startRow:-A(this,j).call(this),startCol:e,endRow:-1,endCol:n}}}]),e}();function G(e,t){return Math.min(t,Math.max(e+A(this,Z).call(this)-1,e))}function X(e,t){return Math.min(t,Math.max(e+A(this,B).call(this)-1,e))}function K(e){var t=[],n=[];return(0,g.Bk)(e,(function(e){var r=Math.min(e.startRow,e.endRow),i=Math.max(e.startRow,e.endRow);(0,x.q4)(r,i,(function(e){-1===t.indexOf(e)&&t.push(e)}));var o=Math.min(e.startCol,e.endCol),s=Math.max(e.startCol,e.endCol);(0,x.q4)(o,s,(function(e){-1===n.indexOf(e)&&n.push(e)}))})),{rows:t,columns:n}}var q=n(6660);function $(e,t,n){Q(e,t),t.set(e,n)}function Q(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function J(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ee(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,ne(e,t,"get"))}function te(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,ne(e,t,"set"),n),n}function ne(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}d.Z.getSingleton().register("afterCopyLimit"),d.Z.getSingleton().register("modifyCopyableRange"),d.Z.getSingleton().register("beforeCut"),d.Z.getSingleton().register("afterCut"),d.Z.getSingleton().register("beforePaste"),d.Z.getSingleton().register("afterPaste"),d.Z.getSingleton().register("beforeCopy"),d.Z.getSingleton().register("afterCopy");var re="copyPaste",ie=["fragmentSelection"],oe=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),se=new WeakMap,ae=new WeakMap,le=new WeakMap,ue=new WeakMap,ce=new WeakMap,he=new WeakMap,de=new WeakMap,fe=new WeakSet,ge=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(){var e,r,o;return(0,i.Z)(this,n),e=t.apply(this,arguments),Q(r=(0,s.Z)(e),o=fe),o.add(r),J((0,s.Z)(e),"columnsLimit",1/0),J((0,s.Z)(e),"rowsLimit",1/0),J((0,s.Z)(e),"pasteMode","overwrite"),J((0,s.Z)(e),"uiContainer",e.hot.rootDocument.body),$((0,s.Z)(e),se,{writable:!0,value:!1}),$((0,s.Z)(e),ae,{writable:!0,value:!1}),$((0,s.Z)(e),le,{writable:!0,value:!1}),$((0,s.Z)(e),ue,{writable:!0,value:"cells-only"}),$((0,s.Z)(e),ce,{writable:!0,value:!1}),$((0,s.Z)(e),he,{writable:!0,value:!1}),$((0,s.Z)(e),de,{writable:!0,value:new z({countRows:function(){return e.hot.countRows()},countColumns:function(){return e.hot.countCols()},rowsLimit:function(){return e.rowsLimit},columnsLimit:function(){return e.columnsLimit},countColumnHeaders:function(){return e.hot.view.getColumnHeadersCount()}})}),J((0,s.Z)(e),"copyableRanges",[]),J((0,s.Z)(e),"focusableElement",void 0),e}return(0,o.Z)(n,[{key:"isEnabled",value:function(){return!!this.hot.getSettings()[re]}},{key:"enablePlugin",value:function(){var e=this;if(!this.enabled){var t,r,i=this.hot.getSettings()[re];if("object"===typeof i)this.pasteMode=null!==(t=i.pasteMode)&&void 0!==t?t:this.pasteMode,this.rowsLimit=isNaN(i.rowsLimit)?this.rowsLimit:i.rowsLimit,this.columnsLimit=isNaN(i.columnsLimit)?this.columnsLimit:i.columnsLimit,te(this,se,!!i.copyColumnHeaders),te(this,ae,!!i.copyColumnGroupHeaders),te(this,le,!!i.copyColumnHeadersOnly),this.uiContainer=null!==(r=i.uiContainer)&&void 0!==r?r:this.uiContainer;this.addHook("afterContextMenuDefaultOptions",(function(t){return e.onAfterContextMenuDefaultOptions(t)})),this.addHook("afterOnCellMouseUp",(function(){return e.onAfterOnCellMouseUp()})),this.addHook("afterSelectionEnd",(function(){return e.onAfterSelectionEnd()})),this.addHook("beforeKeyDown",(function(){return e.onBeforeKeyDown()})),this.focusableElement=function(e){var t=new E(e),n=R.get(e);return n=isNaN(n)?0:n,R.set(e,n+1),t}(this.uiContainer),this.focusableElement.addLocalHook("copy",(function(t){return e.onCopy(t)})).addLocalHook("cut",(function(t){return e.onCut(t)})).addLocalHook("paste",(function(t){return e.onPaste(t)})),(0,a.Z)((0,l.Z)(n.prototype),"enablePlugin",this).call(this)}}},{key:"updatePlugin",value:function(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),(0,a.Z)((0,l.Z)(n.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){this.focusableElement&&M(this.focusableElement),(0,a.Z)((0,l.Z)(n.prototype),"disablePlugin",this).call(this)}},{key:"copy",value:function(){te(this,ue,arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only"),te(this,ce,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}},{key:"copyCellsOnly",value:function(){this.copy("cells-only")}},{key:"copyColumnHeadersOnly",value:function(){this.copy("column-headers-only")}},{key:"copyWithAllColumnHeaders",value:function(){this.copy("with-column-group-headers")}},{key:"copyWithColumnHeaders",value:function(){this.copy("with-column-headers")}},{key:"cut",value:function(){te(this,he,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}},{key:"getRangedCopyableData",value:function(e){return(0,f.P)(this.getRangedData(e))}},{key:"getRangedData",value:function(e){var t=this,n=[],r=K(e),i=r.rows,o=r.columns;return(0,g.Bk)(i,(function(e){var r=[];(0,g.Bk)(o,(function(n){e<0?r.push(t.hot.getColHeader(n,e)):r.push(t.hot.getCopyableData(e,n))})),n.push(r)})),n}},{key:"paste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(e||t){var n=new w;e&&n.clipboardData.setData("text/plain",e),t&&n.clipboardData.setData("text/html",t),this.getOrCreateFocusableElement(),this.onPaste(n)}}},{key:"setCopyableText",value:function(){var e=this.hot.getSelectedRangeLast();if(e){ee(this,de).setSelectedRange(e);var t=new Map([["headers",null],["cells",null]]);"column-headers-only"===ee(this,ue)?t.set("headers",ee(this,de).getMostBottomColumnHeadersRange()):("with-column-headers"===ee(this,ue)?t.set("headers",ee(this,de).getMostBottomColumnHeadersRange()):"with-column-group-headers"===ee(this,ue)&&t.set("headers",ee(this,de).getAllColumnHeadersRange()),t.set("cells",ee(this,de).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter((function(e){return null!==e})).map((function(e){return{startRow:e.startRow,startCol:e.startCol,endRow:e.endRow,endCol:e.endCol}})),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);var n=t.get("cells");if(null!==n&&n.isRangeTrimmed){var r=n.startRow,i=n.startCol,o=n.endRow,s=n.endCol;this.hot.runHooks("afterCopyLimit",o-r+1,s-i+1,this.rowsLimit,this.columnsLimit)}}}},{key:"getOrCreateFocusableElement",value:function(){var e,t=null===(e=this.hot.getActiveEditor())||void 0===e?void 0:e.TEXTAREA;t?this.focusableElement.setFocusableElement(t):this.focusableElement.useSecondaryElement()}},{key:"isEditorOpened",value:function(){var e;return null===(e=this.hot.getActiveEditor())||void 0===e?void 0:e.isOpened()}},{key:"populateValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(e.length){for(var n=e.length,r=e[0].length,i=[],o=t.getTopStartCorner(),s=o.row,a=o.col,l=t.getBottomEndCorner(),u=l.row,c=l.col,h=s,d=a,f=s,g=a;i.length<n||h<=u;){var m=this.hot.getCellMeta(h,a),v=m.skipRowOnPaste,p=m.visualRow;if(h=p+1,!0!==v){f=p,d=a;for(var y=[],w=i.length%n;y.length<r||d<=c;){var C=this.hot.getCellMeta(s,d),b=C.skipColumnOnPaste,S=C.visualCol;if(d=S+1,!0!==b){g=S;var T=y.length%r;y.push(e[w][T])}}i.push(y)}}return this.hot.populateFromArray(s,a,i,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,f,g]}}},{key:"onCopy",value:function(e){if((this.hot.isListening()||ee(this,ce))&&!this.isEditorOpened()){this.setCopyableText(),te(this,ce,!1);var t=this.getRangedData(this.copyableRanges),n=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}(this,fe,me).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",t,this.copyableRanges,n)){var r=(0,f.P)(t);if(e&&e.clipboardData){var i=(0,q.bt)(t,this.hot.rootDocument);e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",[oe,i].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.runHooks("afterCopy",t,this.copyableRanges,n)}te(this,ue,"cells-only"),e.preventDefault()}}},{key:"onCut",value:function(e){if((this.hot.isListening()||ee(this,he))&&!this.isEditorOpened()){this.setCopyableText(),te(this,he,!1);var t=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",t,this.copyableRanges)){var n=(0,f.P)(t);if(e&&e.clipboardData){var r=(0,q.bt)(t,this.hot.rootDocument);e.clipboardData.setData("text/plain",n),e.clipboardData.setData("text/html",[oe,r].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",n);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",t,this.copyableRanges)}e.preventDefault()}}},{key:"onPaste",value:function(e){if(this.hot.isListening()&&!this.isEditorOpened()){var t;if(e&&e.preventDefault&&e.preventDefault(),e&&"undefined"!==typeof e.clipboardData){var n=(0,m.Nw)(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(n&&/(<table)|(<TABLE)/g.test(n))t=(0,q.BU)(n,this.hot.rootDocument).data;else t=e.clipboardData.getData("text/plain")}else"undefined"===typeof ClipboardEvent&&"undefined"!==typeof this.hot.rootWindow.clipboardData&&(t=this.hot.rootWindow.clipboardData.getData("Text"));if("string"===typeof t&&(t=(0,f.Q)(t)),(!t||0!==t.length)&&!1!==this.hot.runHooks("beforePaste",t,this.copyableRanges)){var i=this.populateValues(t),o=(0,r.Z)(i,4),s=o[0],a=o[1],l=o[2],u=o[3];this.hot.selectCell(s,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",t,this.copyableRanges)}}}},{key:"onAfterContextMenuDefaultOptions",value:function(e){var t;e.items.push({name:"---------"},(t=this,{key:"copy",name:function(){return this.getTranslatedPhrase(p.CONTEXTMENU_ITEMS_COPY)},callback:function(){t.copyCellsOnly()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1})),ee(this,se)&&e.items.push(function(e){return{key:"copy_with_column_headers",name:function(){var e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(p.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,t)},callback:function(){e.copyWithColumnHeaders()},disabled:function(){if(!this.hasColHeaders())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}(this)),ee(this,ae)&&e.items.push(function(e){return{key:"copy_with_column_group_headers",name:function(){var e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(p.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,t)},callback:function(){e.copyWithAllColumnHeaders()},disabled:function(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}(this)),ee(this,le)&&e.items.push(function(e){return{key:"copy_column_headers_only",name:function(){var e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(p.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,t)},callback:function(){e.copyColumnHeadersOnly()},disabled:function(){if(!this.hasColHeaders())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}(this)),e.items.push(function(e){return{key:"cut",name:function(){return this.getTranslatedPhrase(p.CONTEXTMENU_ITEMS_CUT)},callback:function(){e.cut()},disabled:function(){if(0===this.countRows()||0===this.countCols())return!0;var e=this.getSelected();return!e||e.length>1},hidden:!1}}(this))}},{key:"onAfterOnCellMouseUp",value:function(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}},{key:"onAfterSelectionEnd",value:function(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&(0,v.mR)()||(this.setCopyableText(),this.focusableElement.focus()))}},{key:"onBeforeKeyDown",value:function(){if(this.hot.isListening()&&!this.isEditorOpened()){var e=this.hot.rootDocument.activeElement,t=this.hot.getActiveEditor();!t||e!==this.focusableElement.getFocusableElement()&&e!==t.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}}},{key:"destroy",value:function(){this.focusableElement&&(M(this.focusableElement),this.focusableElement=null),(0,a.Z)((0,l.Z)(n.prototype),"destroy",this).call(this)}}],[{key:"PLUGIN_KEY",get:function(){return re}},{key:"SETTING_KEYS",get:function(){return[re].concat(ie)}},{key:"PLUGIN_PRIORITY",get:function(){return 80}}]),n}(h.v);function me(e){for(var t=K(e).rows,n=0,r=0;r<t.length&&!(t[r]>=0);r++)n+=1;return{columnHeadersCount:n}}},5982:function(e,t,n){"use strict";n.d(t,{aX:function(){return E}});var r=n(5671),i=n(3144),o=n(136),s=n(7277),a=n(3944),l=n(9439),u=n(9373),c=function(){function e(t){(0,r.Z)(this,e),this.hot=t,this.options={}}return(0,i.Z)(e,[{key:"setOptions",value:function(e){this.options=e}},{key:"getData",value:function(){var e=this,t=this._getDataRange(),n=t.startRow,r=t.startCol,i=t.endRow,o=t.endCol,s=this.options,a=[];return(0,u.q4)(n,i,(function(t){var n=[];!s.exportHiddenRows&&e._isHiddenRow(t)||((0,u.q4)(r,o,(function(r){!s.exportHiddenColumns&&e._isHiddenColumn(r)||n.push(e.hot.getDataAtCell(t,r))})),a.push(n))})),a}},{key:"getRowHeaders",value:function(){var e=this,t=[];if(this.options.rowHeaders){var n=this._getDataRange(),r=n.startRow,i=n.endRow,o=this.hot.getRowHeader();(0,u.q4)(r,i,(function(n){!e.options.exportHiddenRows&&e._isHiddenRow(n)||t.push(o[n])}))}return t}},{key:"getColumnHeaders",value:function(){var e=this,t=[];if(this.options.columnHeaders){var n=this._getDataRange(),r=n.startCol,i=n.endCol,o=this.hot.getColHeader();(0,u.q4)(r,i,(function(n){!e.options.exportHiddenColumns&&e._isHiddenColumn(n)||t.push(o[n])}))}return t}},{key:"_getDataRange",value:function(){var e=this.hot.countCols()-1,t=this.hot.countRows()-1,n=(0,l.Z)(this.options.range,4),r=n[0],i=void 0===r?0:r,o=n[1],s=void 0===o?0:o,a=n[2],u=void 0===a?t:a,c=n[3],h=void 0===c?e:c;return{startRow:i=Math.max(i,0),startCol:s=Math.max(s,0),endRow:u=Math.min(u,t),endCol:h=Math.min(h,e)}}},{key:"_isHiddenRow",value:function(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}},{key:"_isHiddenColumn",value:function(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}]),e}(),h=n(4942),d=n(2063),f=n(7117),g=n(4170),m=n(4638),v=function(){function e(t,n){(0,r.Z)(this,e),this.dataProvider=t,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}return(0,i.Z)(e,[{key:"_mergeOptions",value:function(t){var n=(0,g.d9)(this.constructor.DEFAULT_OPTIONS),r=new Date;return n=(0,g.l7)((0,g.d9)(e.DEFAULT_OPTIONS),n),(n=(0,g.l7)(n,t)).filename=(0,m.ng)(n.filename,{YYYY:r.getFullYear(),MM:"".concat(r.getMonth()+1).padStart(2,"0"),DD:"".concat(r.getDate()).padStart(2,"0")}),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}}]),e}(),p=v,y=String.fromCharCode(13),w=String.fromCharCode(34),C=String.fromCharCode(10),b=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"export",value:function(){var e=this,t=this.options,n=this.dataProvider.getData(),r=this.dataProvider.getColumnHeaders(),i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0,a=t.bom?String.fromCharCode(65279):"";return i&&(r=(0,d.Sc)(r,(function(t){return e._escapeCell(t,!0)})),s&&(a+=t.columnDelimiter),a+=r.join(t.columnDelimiter),a+=t.rowDelimiter),(0,d.Bk)(n,(function(n,r){r>0&&(a+=t.rowDelimiter),s&&(a+=e._escapeCell(o[r])+t.columnDelimiter),a+=n.map((function(t){return e._escapeCell(t)})).join(t.columnDelimiter)})),a}},{key:"_escapeCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,f.Pz)(e);return""!==n&&(t||n.indexOf(y)>=0||n.indexOf(w)>=0||n.indexOf(C)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n='"'.concat(n,'"')),n}}],[{key:"DEFAULT_OPTIONS",get:function(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}}]),n}(p),S=b,T=(0,h.Z)({},"csv",S);var E=function(e){(0,o.Z)(n,e);var t=(0,s.Z)(n);function n(){return(0,r.Z)(this,n),t.apply(this,arguments)}return(0,i.Z)(n,[{key:"isEnabled",value:function(){return!0}},{key:"exportAsString",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(e,t).export()}},{key:"exportAsBlob",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}},{key:"downloadFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.hot,r=n.rootDocument,i=n.rootWindow,o=this._createTypeFormatter(e,t),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u="".concat(o.options.filename,".").concat(o.options.fileExtension);if(void 0!==l.download){var c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout((function(){a.revokeObjectURL(c)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}},{key:"_createTypeFormatter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!T[e])throw new Error('Export format type "'.concat(e,'" is not supported.'));return function(e,t,n){return"function"===typeof T[e]?new T[e](t,n):null}(e,new c(this.hot),t)}},{key:"_createBlob",value:function(e){var t=null;return"undefined"!==typeof Blob&&(t=new Blob([e.export()],{type:"".concat(e.options.mimeType,";charset=").concat(e.options.encoding)})),t}}],[{key:"PLUGIN_KEY",get:function(){return"exportFile"}},{key:"PLUGIN_PRIORITY",get:function(){return 240}}]),n}(a.v)},3914:function(e,t,n){"use strict";n.d(t,{s3:function(){return w},a9:function(){return y},_j:function(){return C},fo:function(){return b}});var r=n(9439),i=n(3433),o=n(4638),s=n(9373),a=n(7993),l="asc",u=new Map([[l,[-1,1]],["desc",[1,-1]]]),c=function(e){return"The priority '".concat(e,"' is already declared in a map.")},h=function(e){return"The priority '".concat(e,"' is not a number.")};var d=n(3209),f=function(e){return"'".concat(e,"' value is already declared in a unique set.")};var g=function(e){return'There is already registered "'.concat(e,'" plugin.')},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.errorPriorityExists,n=e.errorPriorityNaN,o=new Map;return t=(0,a.mf)(t)?t:c,n=(0,a.mf)(n)?n:h,{addItem:function(e,r){if(!(0,s.kE)(e))throw new Error(n(e));if(o.has(e))throw new Error(t(e));o.set(e,r)},getItems:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=u.get(e)||u.get(l),n=(0,r.Z)(t,2),s=n[0],a=n[1];return(0,i.Z)(o).sort((function(e,t){return e[0]<t[0]?s:a})).map((function(e){return e[1]}))}}}({errorPriorityExists:function(e){return'There is already registered plugin on priority "'.concat(e,'".')},errorPriorityNaN:function(e){return'The priority "'.concat(e,'" is not a number.')}}),v=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).errorItemExists,t=new Set;return e=(0,a.mf)(e)?e:f,{addItem:function(n){if(t.has(n))throw new Error(e(n));t.add(n)},clear:function(){t.clear()},getItems:function(){return(0,i.Z)(t)}}}({errorItemExists:g}),p=(0,d.I)({errorIdExists:g});function y(){return[].concat((0,i.Z)(m.getItems()),(0,i.Z)(v.getItems()))}function w(e){var t=(0,o.ct)(e);return p.getItem(t)}function C(e){return!!w(e)}function b(e,t,n){var i=function(e,t,n){"function"===typeof e&&(e=(t=e).PLUGIN_KEY,n=t.PLUGIN_PRIORITY);return[e,t,n]}(e,t,n),s=(0,r.Z)(i,3);e=s[0],t=s[1],n=s[2],void 0===w(e)&&function(e,t,n){var r=(0,o.ct)(e);if(p.hasItem(r))throw new Error(g(r));void 0===n?v.addItem(r):m.addItem(n,r);p.addItem(r,t)}(e,t,n)}},6067:function(e,t,n){"use strict";n.d(t,{A:function(){return l}});var r=n(1859),i=n(8492);function o(e,t,n,o,s,a,l){r.Z.apply(this,[e,t,n,o,s,a,l]),(0,i.uS)(t,null===a||void 0===a?"":a,!1)}o.RENDERER_TYPE="html";var s=n(174),a=n(3713);function l(e,t,n,r,l,u,c){var h=e.rootDocument,d=c.allowHtml?o:s.V,f=h.createElement("DIV");if(f.className="htAutocompleteArrow",f.appendChild(h.createTextNode(String.fromCharCode(9660))),d.apply(this,[e,t,n,r,l,u,c]),t.firstChild||t.appendChild(h.createTextNode(String.fromCharCode(160))),t.insertBefore(f,t.firstChild),(0,i.cn)(t,"htAutocomplete"),!e.acArrowListener){var g=new a.Z(e);e.acArrowListener=function(o){(0,i.pv)(o.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(n,r),t)},g.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",(function(){g.destroy()}))}}l.RENDERER_TYPE="autocomplete"},1859:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(8492);function i(e,t,n,i,o,s,a){var l=[],u=[];a.className&&(0,r.cn)(t,a.className),a.readOnly&&l.push(a.readOnlyCellClassName),!1===a.valid&&a.invalidCellClassName?l.push(a.invalidCellClassName):u.push(a.invalidCellClassName),!1===a.wordWrap&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!s&&a.placeholder&&l.push(a.placeholderCellClassName),(0,r.IV)(t,u),(0,r.cn)(t,l)}i.RENDERER_TYPE="base"},7872:function(e,t,n){"use strict";n.d(t,{Bp:function(){return a},Y3:function(){return s},zn:function(){return l}});var r=(0,n(3107).Z)("renderers"),i=r.register,o=r.getItem,s=r.hasItem;r.getNames,r.getValues;function a(e){if("function"===typeof e)return e;if(!s(e))throw Error('No registered renderer found under "'.concat(e,'" name'));return o(e)}function l(e,t){"string"!==typeof e&&(e=(t=e).RENDERER_TYPE),i(e,t)}},174:function(e,t,n){"use strict";n.d(t,{V:function(){return s}});var r=n(1859),i=n(8492),o=n(7117);function s(e,t,n,s,a,l,u){r.Z.apply(this,[e,t,n,s,a,l,u]);var c=l;if(!c&&u.placeholder&&(c=u.placeholder),c=(0,o.Pz)(c),u.trimWhitespace&&(c=c.trim()),u.rendererTemplate){(0,i.cS)(t);var h=e.rootDocument.createElement("TEMPLATE");h.setAttribute("bind","{{}}"),h.innerHTML=u.rendererTemplate,HTMLTemplateElement.decorate(h),h.model=e.getSourceDataAtRow(n),t.appendChild(h)}else(0,i.tT)(t,c)}s.RENDERER_TYPE="text"},3209:function(e,t,n){"use strict";n.d(t,{I:function(){return a}});var r=n(3433),i=n(9439),o=n(7993),s=function(e){return"The id '".concat(e,"' is already declared in a map.")};function a(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).errorIdExists,t=new Map;function n(){return(0,r.Z)(t)}function a(e){return t.has(e)}return e=(0,o.mf)(e)?e:s,{addItem:function(n,r){if(a(n))throw new Error(e(n));t.set(n,r)},clear:function(){t.clear()},getId:function(e){var t=n().find((function(t){var n=(0,i.Z)(t,2),r=n[0],o=n[1];return e===o&&r}))||[null];return(0,i.Z)(t,1)[0]},getItem:function(e){return t.get(e)},getItems:n,hasItem:a,removeItem:function(e){return t.delete(e)}}}},6660:function(e,t,n){"use strict";n.d(t,{BU:function(){return u},bt:function(){return l},vo:function(){return a}});var r=n(3433),i=n(7117),o={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},s=new RegExp(Object.keys(o).map((function(e){return"(".concat(e,")")})).join("|"),"gi");function a(e){for(var t=e.hasColHeaders(),n=e.hasRowHeaders(),r=[t?-1:0,n?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData.apply(e,r),s=o.length,a=s>0?o[0].length:0,l=["<table>","</table>"],u=t?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],h=n?1:0,d=t?1:0,f=0;f<s;f+=1){for(var g=t&&0===f,m=[],v=0;v<a;v+=1){var p=!g&&n&&0===v,y="";if(g)y="<th>".concat(e.getColHeader(v-h),"</th>");else if(p)y="<th>".concat(e.getRowHeader(f-d),"</th>");else{var w=o[f][v],C=e.getCellMeta(f-d,v-h),b=C.hidden,S=C.rowspan,T=C.colspan;if(!b){var E=[];if(S&&E.push('rowspan="'.concat(S,'"')),T&&E.push('colspan="'.concat(T,'"')),(0,i.xb)(w))y="<td ".concat(E.join(" "),"></td>");else{var R=w.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");y="<td ".concat(E.join(" "),">").concat(R,"</td>")}}}m.push(y)}var k=["<tr>"].concat(m,["</tr>"]).join("");g?u.splice(1,0,k):c.splice(-1,0,k)}return l.splice(1,0,u.join(""),c.join("")),l.join("")}function l(e){for(var t=e.length,n=["<table>"],r=0;r<t;r+=1){var o=e[r],s=o.length,a=[];0===r&&n.push("<tbody>");for(var l=0;l<s;l+=1){var u=o[l],c=(0,i.xb)(u)?"":u.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,(function(e){return'<span style="mso-spacerun: yes">'.concat("&nbsp;".repeat(e.length-1)," </span>")})).replace(/\t/gi,"&#9;");a.push("<td>".concat(c,"</td>"))}n.push.apply(n,["<tr>"].concat(a,["</tr>"])),r+1===t&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n={},i=t.createDocumentFragment(),a=t.createElement("div");i.appendChild(a);var l=e;if("string"===typeof l){var u=l.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(function(e){var t=e.match(/<td\b[^>]*?>/g)[0],n=e.substring(t.length,e.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return"".concat(t).concat(n).concat("</td>")}));a.insertAdjacentHTML("afterbegin","".concat(u)),l=a.querySelector("table")}if(l&&function(e){return"TABLE"===(e&&e.nodeName||"")}(l)){var c,h=a.querySelector('meta[name$="enerator"]'),d=null!==l.querySelector("tbody th"),f=l.querySelector("tr"),g=f?Array.from(f.cells).reduce((function(e,t){return e+t.colSpan}),0)-(d?1:0):0,m=l.tFoot&&Array.from(l.tFoot.rows)||[],v=[],p=!1,y=0;if(l.tHead){var w=Array.from(l.tHead.rows).filter((function(e){var t=null!==e.querySelector("td");return t&&v.push(e),!t}));p=(y=w.length)>0,y>1?n.nestedHeaders=Array.from(w).reduce((function(e,t){var n=Array.from(t.cells).reduce((function(e,t,n){if(d&&0===n)return e;var r=t.colSpan,i=t.innerHTML,o=r>1?{label:i,colspan:r}:i;return e.push(o),e}),[]);return e.push(n),e}),[]):p&&(n.colHeaders=Array.from(w[0].children).reduce((function(e,t,n){return d&&0===n||e.push(t.innerHTML),e}),[]))}v.length&&(n.fixedRowsTop=v.length),m.length&&(n.fixedRowsBottom=m.length);var C=[].concat(v,(0,r.Z)(Array.from(l.tBodies).reduce((function(e,t){return e.push.apply(e,(0,r.Z)(Array.from(t.rows))),e}),[])),(0,r.Z)(m));c=C.length;for(var b=new Array(c),S=0;S<c;S++)b[S]=new Array(g);for(var T=[],E=[],R=0;R<c;R++)for(var k=C[R],_=Array.from(k.cells),O=_.length,M=0;M<O;M++){var x=_[M],N=x.nodeName,I=x.innerHTML,D=x.rowSpan,H=x.colSpan,A=b[R].findIndex((function(e){return void 0===e}));if("TD"===N){if(D>1||H>1){for(var L=R;L<R+D;L++)if(L<c)for(var P=A;P<A+H;P++)b[L][P]=null;var V=x.getAttribute("style");V&&V.includes("mso-ignore:colspan")||T.push({col:A,row:R,rowspan:D,colspan:H})}var W="";W=h&&/excel/gi.test(h.content)?I.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):I.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),b[R][A]=W.replace(s,(function(e){return o[e]}))}else E.push(I)}return T.length&&(n.mergeCells=T),E.length&&(n.rowHeaders=E),b.length&&(n.data=b),n}}},3107:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(3433),i=new Map;function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";i.has(e)||i.set(e,new Map);var t=i.get(e);return{register:function(e,n){t.set(e,n)},getItem:function(e){return t.get(e)},hasItem:function(e){return t.has(e)},getNames:function(){return(0,r.Z)(t.keys())},getValues:function(){return(0,r.Z)(t.values())}}}},9115:function(e,t,n){"use strict";n.d(t,{Ie:function(){return l},Te:function(){return a},oh:function(){return s}});var r=(0,n(3107).Z)("validators"),i=r.register,o=r.getItem,s=r.hasItem;r.getNames,r.getValues;function a(e){if("function"===typeof e)return e;if(!s(e))throw Error('No registered validator found under "'.concat(e,'" name'));return o(e)}function l(e,t){"string"!==typeof e&&(e=(t=e).VALIDATOR_TYPE),i(e,t)}}}]);
//# sourceMappingURL=945.b1cdf865.chunk.js.map